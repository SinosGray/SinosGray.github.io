<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>react | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta property="og:type" content="article">
<meta property="og:title" content="react">
<meta property="og:url" content="https://sinos_wei.gitee.io/2024/01/e6a15612f4ba.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/IMG_2403.JPG">
<meta property="article:published_time" content="2024-01-14T03:08:27.000Z">
<meta property="article:modified_time" content="2024-02-20T11:13:36.453Z">
<meta property="article:author" content="Sinos">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/IMG_2403.JPG"><link rel="shortcut icon" href="/img/avatar.jpeg"><link rel="canonical" href="https://sinos_wei.gitee.io/2024/01/e6a15612f4ba.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'react',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-20 19:13:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">199</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/IMG_2403.JPG')"><nav id="nav"><span id="blog-info"><a href="/" title="Sinos_wei's blog"><span class="site-name">Sinos_wei's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">react</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">Updated</span><time datetime="2024-02-20T11:13:36.453Z" title="Updated 2024-02-20 19:13:36">2024-02-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="react"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>

</blockquote>
<span id="more"></span>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7297024168604057636">八股</a></p>
<h1 id="jsx">jsx</h1>
<ol type="1">
<li><strong>作为文本</strong> 直接在 JSX 标签内： <code>&lt;h1&gt;&#123;name&#125;'s To Do List&lt;/h1&gt;</code> 有效，但 <code>&lt;&#123;tag&#125;&gt;Gregorio Y. Zara's To Do List&lt;/&#123;tag&#125;&gt;</code> 无效。</li>
<li><strong>作为属性</strong> 紧跟在 <code>=</code> 符号之后： <code>src=&#123;avatar&#125;</code> 将读取 <code>avatar</code> 变量，但 <code>src="&#123;avatar&#125;"</code> 将传递字符串 <code>"&#123;avatar&#125;"</code>。</li>
<li>要在 JSX 中传递一个 JS 对象，必须将对象封装在另一对大括号中： <code>person=&#123;&#123; name: "Hedy Lamarr", inventions: 5 &#125;&#125;</code></li>
</ol>
<p>任何 JavaScript 表达式都可以在大括号之间工作，包括像 <code>formatDate()</code> 这样的函数调用：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatDate</span>(<span class="params">date</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Intl</span>.<span class="title class_">DateTimeFormat</span>(</span><br><span class="line">    <span class="string">&#x27;en-US&#x27;</span>,</span><br><span class="line">    &#123; <span class="attr">weekday</span>: <span class="string">&#x27;long&#x27;</span> &#125;</span><br><span class="line">  ).<span class="title function_">format</span>(date);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">TodoList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>To Do List for &#123;formatDate(today)&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用 &amp;&amp;，只有当 isPacked 为 true 时，你才能有条件地渲染复选标记：</span></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;name&#125; &#123;isPacked &amp;&amp; &#x27;✔&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h1 id="传递属性">传递属性</h1>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Avatar</span>(<span class="params">&#123; person, size &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Avatar</span></span><br><span class="line">  size=&#123;<span class="number">80</span>&#125;</span><br><span class="line">  person=&#123;&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Aklilu Lemma&#x27;</span>, </span><br><span class="line">    <span class="attr">imageId</span>: <span class="string">&#x27;OKS67lh&#x27;</span></span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Avatar</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这会将 Profile 的所有属性转发给 Avatar，但不会列出每个属性的名称。</span></span><br></pre></td></tr></table></figure>
<p>children</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Card</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Avatar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">size</span>=<span class="string">&#123;100&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">person</span>=<span class="string">&#123;&#123;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">name:</span> &#x27;<span class="attr">Katsuko</span> <span class="attr">Saruhashi</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">imageId:</span> &#x27;<span class="attr">YfeOqp2</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="子组件向父子间传递数据">子组件向父子间传递数据</h2>
<ol type="1">
<li><p>父组件将回调函数作为属性传给子组件, 子组件通过回调函数传递数据 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">const ChildComponent = (&#123;onDataFromChild&#125;) =&gt; &#123;</span><br><span class="line">    const [inputValue,setInputValue] = useState(&#x27;&#x27;);</span><br><span class="line">    const sendDataToParent=()=&gt;&#123;</span><br><span class="line">        onDataFromChild(inputValue)</span><br><span class="line">    &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;ChildComponent&lt;/h2&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; onChange=&#123;(e)=&gt;setInputValue(e.target.value)&#125;/&gt;</span><br><span class="line">        &lt;button onClick=&#123;sendDataToParent&#125;&gt;Send Data to Parent&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default ChildComponent</span><br></pre></td></tr></table></figure></p></li>
<li><p>context <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// app</span><br><span class="line">import &#123; createContext, useState &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#x27;./App.css&#x27;;</span><br><span class="line">import ParentComponent from &#x27;./ParentComponent&#x27;;</span><br><span class="line">const appContext = createContext();</span><br><span class="line">function App() &#123;</span><br><span class="line">  const [value,setValue] = useState(&#x27;&#x27;);</span><br><span class="line">  const updateValue = (data) =&gt;&#123;</span><br><span class="line">    setValue(data)</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;appContext.Provider value=&#123;&#123;value,updateValue&#125;&#125;&gt;</span><br><span class="line">      &lt;ParentComponent/&gt;</span><br><span class="line">    &lt;/appContext.Provider&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">export default App;</span><br><span class="line">export &#123;appContext&#125;</span><br><span class="line"></span><br><span class="line">// parent</span><br><span class="line">import React, &#123; useContext &#125; from &#x27;react&#x27;</span><br><span class="line">import ChildComponent from &#x27;./ChildComponent&#x27;</span><br><span class="line">import &#123;appContext&#125; from &#x27;./App&#x27;</span><br><span class="line">const ParentComponent = () =&gt; &#123;</span><br><span class="line">    const context = useContext(appContext)</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h3&gt;ParentComponent&lt;/h3&gt;</span><br><span class="line">        &lt;ChildComponent/&gt;</span><br><span class="line">        &lt;p&gt;Data From Child: &#123;context.value&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">export default ParentComponent</span><br><span class="line"></span><br><span class="line">// child</span><br><span class="line">import React, &#123; useContext, useState &#125; from &#x27;react&#x27;</span><br><span class="line">import &#123;appContext&#125; from &#x27;./App&#x27;</span><br><span class="line"></span><br><span class="line">const ChildComponent = () =&gt; &#123;</span><br><span class="line">    const context = useContext(appContext);</span><br><span class="line">    const [inputValue,setInputValue] = useState(&#x27;&#x27;);</span><br><span class="line">    </span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;ChildComponent&lt;/h2&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; onChange=&#123;(e)=&gt;setInputValue(e.target.value)&#125;/&gt;</span><br><span class="line">        &lt;button onClick=&#123;()=&gt;context.updateValue(inputValue)&#125;&gt;Send Data to Parent&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">export default ChildComponent</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h1 id="事件">事件</h1>
<p><strong>React 假定你编写的每个组件都是纯函数。</strong></p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params">&#123; onClick, children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;e</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">      // e 是事件</span></span><br><span class="line"><span class="language-xml">      // 停止传播, 否则会继续向父组件传递</span></span><br><span class="line"><span class="language-xml">      e.stopPropagation();</span></span><br><span class="line"><span class="language-xml">      onClick();</span></span><br><span class="line"><span class="language-xml">    &#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Toolbar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;Toolbar&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">      alert(&#x27;You clicked on the toolbar!&#x27;);</span></span><br><span class="line"><span class="language-xml">    &#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> alert(&#x27;Playing!&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Play Movie</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> alert(&#x27;Uploading!&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Upload Image</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="hooks"><a target="_blank" rel="noopener" href="https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e">hooks</a></h1>
<p>There are two main usage rules the React core team stipulates you need to follow to use hooks which they outline in the <a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-rules.html">hooks proposal documentation</a>.</p>
<ul>
<li><strong>Don’t call Hooks inside loops, conditions, or nested functions</strong></li>
<li><strong>Only Call Hooks from React Functions</strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/SinosGray/picgo/master/test/202401142102450.png" alt="img" style="zoom:70%;" /></p>
<p>example but not real internal implementation</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> state = [];</span><br><span class="line"><span class="keyword">let</span> setters = [];</span><br><span class="line"><span class="keyword">let</span> firstRun = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> cursor = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createSetter</span>(<span class="params">cursor</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">setterWithCursor</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">    state[cursor] = newVal;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is the pseudocode for the useState helper</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useState</span>(<span class="params">initVal</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (firstRun) &#123;</span><br><span class="line">    state.<span class="title function_">push</span>(initVal);</span><br><span class="line">    setters.<span class="title function_">push</span>(<span class="title function_">createSetter</span>(cursor));</span><br><span class="line">    firstRun = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> setter = setters[cursor];</span><br><span class="line">  <span class="keyword">const</span> value = state[cursor];</span><br><span class="line">  cursor++;</span><br><span class="line">  <span class="keyword">return</span> [value, setter];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Our component code that uses hooks</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RenderFunctionComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [firstName, setFirstName] = <span class="title function_">useState</span>(<span class="string">&quot;Rudi&quot;</span>); <span class="comment">// cursor: 0</span></span><br><span class="line">  <span class="keyword">const</span> [lastName, setLastName] = <span class="title function_">useState</span>(<span class="string">&quot;Yardley&quot;</span>); <span class="comment">// cursor: 1</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setFirstName(&quot;Richard&quot;)&#125;&gt;Richard<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setFirstName(&quot;Fred&quot;)&#125;&gt;Fred<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is sort of simulating Reacts rendering cycle</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  cursor = <span class="number">0</span>; <span class="comment">// resetting the cursor</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">RenderFunctionComponent</span> /&gt;</span></span>; <span class="comment">// render</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state); <span class="comment">// Pre-render: []</span></span><br><span class="line"><span class="title class_">MyComponent</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state); <span class="comment">// First-render: [&#x27;Rudi&#x27;, &#x27;Yardley&#x27;]</span></span><br><span class="line"><span class="title class_">MyComponent</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state); <span class="comment">// Subsequent-render: [&#x27;Rudi&#x27;, &#x27;Yardley&#x27;]</span></span><br><span class="line"><span class="comment">// click the &#x27;Fred&#x27; button</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state); <span class="comment">// After-click: [&#x27;Fred&#x27;, &#x27;Yardley&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>So now it should be clear as to why you cannot call <code>use</code> hooks within conditionals or loops. Because we are dealing with <strong>a cursor pointing to a set of arrays</strong>, <strong>if you change the order of the calls within render, the cursor will not match up to the data and your use calls will not point to the correct data or handlers.</strong></p>
<h1 id="状态">状态</h1>
<ol type="1">
<li><strong>识别</strong> 你的组件的不同视觉状态</li>
<li><strong>确定</strong> 是什么触发了这些状态变化 状态转移</li>
<li>使用 <code>useState</code> <strong>表示</strong> 内存中的状态</li>
<li><strong>移除</strong> 任何非必要的状态变量</li>
<li><strong>连接</strong> 事件处理程序设置状态</li>
</ol>
<figure>
<img src="https://raw.githubusercontent.com/SinosGray/picgo/master/test/202401221231078.png" alt="image-20240122123122161" /><figcaption aria-hidden="true">image-20240122123122161</figcaption>
</figure>
<ul>
<li>useState 定义自变量</li>
<li>useMemo 和 useCallback 定义因变量, 但是当自变量不变时, 即使重新渲染也只会读取自变量的 cache 而不重新计算, useMemo 和 useCallback 一个定义变量一个定义函数</li>
<li>useEffect 定义副作用的因变量, 一个函数如果给定输入, 输出是确定的而且不影响其他部分,就是纯函数, 除此之外为副作用, 如修改 dom, 请求数据等</li>
<li>useReducer 是自变量的集合</li>
<li>useContext 解决了因变量作为自变量需要一级级往下传递的问题, 即跨组件</li>
<li>useRef 是在自变量影响因变量的过程中定义标记变量</li>
</ul>
<h2 id="usestate">useState</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useState &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">export default function Form() &#123;</span><br><span class="line">  const [answer, setAnswer] = useState(&#x27;&#x27;);</span><br><span class="line">  const [error, setError] = useState(null);</span><br><span class="line">  const [status, setStatus] = useState(&#x27;typing&#x27;);</span><br><span class="line"></span><br><span class="line">  if (status === &#x27;success&#x27;) &#123;</span><br><span class="line">    return &lt;h1&gt;That&#x27;s right!&lt;/h1&gt;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function handleSubmit(e) &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    setStatus(&#x27;submitting&#x27;);</span><br><span class="line">    try &#123;</span><br><span class="line">      await submitForm(answer);</span><br><span class="line">      setStatus(&#x27;success&#x27;);</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">      setStatus(&#x27;typing&#x27;);</span><br><span class="line">      setError(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function handleTextareaChange(e) &#123;</span><br><span class="line">    setAnswer(e.target.value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;h2&gt;City quiz&lt;/h2&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        In which city is there a billboard that turns air into drinkable water?</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">      &lt;form onSubmit=&#123;handleSubmit&#125;&gt;</span><br><span class="line">        &lt;textarea</span><br><span class="line">          value=&#123;answer&#125;</span><br><span class="line">          onChange=&#123;handleTextareaChange&#125;</span><br><span class="line">          disabled=&#123;status === &#x27;submitting&#x27;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;button disabled=&#123;</span><br><span class="line">          answer.length === 0 ||</span><br><span class="line">          status === &#x27;submitting&#x27;</span><br><span class="line">        &#125;&gt;</span><br><span class="line">          Submit</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">        &#123;error !== null &amp;&amp;</span><br><span class="line">          &lt;p className=&quot;Error&quot;&gt;</span><br><span class="line">            &#123;error.message&#125;</span><br><span class="line">          &lt;/p&gt;</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function submitForm(answer) &#123;</span><br><span class="line">  // Pretend it&#x27;s hitting the network.</span><br><span class="line">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      let shouldError = answer.toLowerCase() !== &#x27;lima&#x27;</span><br><span class="line">      if (shouldError) &#123;</span><br><span class="line">        reject(new Error(&#x27;Good guess but a wrong answer. Try again!&#x27;));</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        resolve();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 1500);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>状态传递</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useState &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">export default function Accordion() &#123;</span><br><span class="line">  const [activeIndex, setActiveIndex] = useState(0);</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;h2&gt;Almaty, Kazakhstan&lt;/h2&gt;</span><br><span class="line">      &lt;Panel</span><br><span class="line">        title=&quot;About&quot;</span><br><span class="line">        isActive=&#123;activeIndex === 0&#125;</span><br><span class="line">        onShow=&#123;() =&gt; setActiveIndex(0)&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        With a population of about 2 million</span><br><span class="line">      &lt;/Panel&gt;</span><br><span class="line">      &lt;Panel</span><br><span class="line">        title=&quot;Etymology&quot;</span><br><span class="line">        isActive=&#123;activeIndex === 1&#125;</span><br><span class="line">        onShow=&#123;() =&gt; setActiveIndex(1)&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        The name</span><br><span class="line">      &lt;/Panel&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Panel(&#123;</span><br><span class="line">  title,</span><br><span class="line">  children,</span><br><span class="line">  isActive,</span><br><span class="line">  onShow</span><br><span class="line">&#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;section className=&quot;panel&quot;&gt;</span><br><span class="line">      &lt;h3&gt;&#123;title&#125;&lt;/h3&gt;</span><br><span class="line">      &#123;isActive ? (</span><br><span class="line">        &lt;p&gt;&#123;children&#125;&lt;/p&gt;</span><br><span class="line">      ) : (</span><br><span class="line">        &lt;button onClick=&#123;onShow&#125;&gt;</span><br><span class="line">          Show</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重新渲染与 ui 树 请记住，键不是全局唯一的。 它们只指定父级中的位置。 key</p>
<h2 id="usereducer">useReducer</h2>
<p>使用 reducer 管理状态与直接设置状态略有不同。 不是通过设置状态来告诉 React “做什么”，而是通过从事件处理程序中分派 “操作” 来指定 “用户刚刚做了什么”。 （状态更新逻辑将存在于其他地方！）因此，你不是通过事件处理程序执行 “设置 <code>tasks</code>“，而是调度 “添加/更改/删除任务” 操作。 这更能描述用户的意图。</p>
<p>会触发重新渲染</p>
<p>reducer 函数是放置状态逻辑的地方。 它有两个参数，当前状态和操作对象，并返回下一个状态：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; useReducer &#125; from &#x27;react&#x27;;</span><br><span class="line">import AddTask from &#x27;./AddTask.js&#x27;;</span><br><span class="line">import TaskList from &#x27;./TaskList.js&#x27;;</span><br><span class="line">export default function TaskApp() &#123;</span><br><span class="line">  const [tasks, dispatch] = useReducer(tasksReducer, initialTasks);</span><br><span class="line">  function handleAddTask(text) &#123;</span><br><span class="line">    dispatch(&#123;</span><br><span class="line">      type: &#x27;added&#x27;,</span><br><span class="line">      id: nextId++,</span><br><span class="line">      text: text,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  function handleChangeTask(task) &#123;</span><br><span class="line">    dispatch(&#123;</span><br><span class="line">      type: &#x27;changed&#x27;,</span><br><span class="line">      task: task,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  function handleDeleteTask(taskId) &#123;</span><br><span class="line">    dispatch(&#123;</span><br><span class="line">      type: &#x27;deleted&#x27;,</span><br><span class="line">      id: taskId,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;AddTask onAddTask=&#123;handleAddTask&#125; /&gt;</span><br><span class="line">      &lt;TaskList</span><br><span class="line">        tasks=&#123;tasks&#125;</span><br><span class="line">        onChangeTask=&#123;handleChangeTask&#125;</span><br><span class="line">        onDeleteTask=&#123;handleDeleteTask&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function tasksReducer(tasks, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &#x27;added&#x27;: &#123;</span><br><span class="line">      return [</span><br><span class="line">        ...tasks,</span><br><span class="line">        &#123;</span><br><span class="line">          id: action.id,</span><br><span class="line">          text: action.text,</span><br><span class="line">          done: false,</span><br><span class="line">        &#125;,</span><br><span class="line">      ];</span><br><span class="line">    &#125;</span><br><span class="line">    case &#x27;changed&#x27;: &#123;</span><br><span class="line">      return tasks.map((t) =&gt; &#123;</span><br><span class="line">        if (t.id === action.task.id) &#123;</span><br><span class="line">          return action.task;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          return t;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    case &#x27;deleted&#x27;: &#123;</span><br><span class="line">      return tasks.filter((t) =&gt; t.id !== action.id);</span><br><span class="line">    &#125;</span><br><span class="line">    default: &#123;</span><br><span class="line">      throw Error(&#x27;Unknown action: &#x27; + action.type);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let nextId = 3;</span><br><span class="line">const initialTasks = [</span><br><span class="line">  &#123;id: 0, text: &#x27;Visit Kafka Museum&#x27;, done: true&#125;,</span><br><span class="line">  &#123;id: 1, text: &#x27;Watch a puppet show&#x27;, done: false&#125;,</span><br><span class="line">  &#123;id: 2, text: &#x27;Lennon Wall pic&#x27;, done: false&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h2 id="usecontext">useContext</h2>
<blockquote>
<p>不使用 prop 从父传递数据到子</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export default function Section(&#123; level, children &#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;section className=&quot;section&quot;&gt;</span><br><span class="line">       //提供 context</span><br><span class="line">      &lt;LevelContext.Provider value=&#123;level&#125;&gt;</span><br><span class="line">        &#123;children&#125;</span><br><span class="line">      &lt;/LevelContext.Provider&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default function Heading(&#123; children &#125;) &#123;</span><br><span class="line">  // 使用 context</span><br><span class="line">  const level = useContext(LevelContext);</span><br><span class="line">  switch (level) &#123;</span><br><span class="line">    case 1:</span><br><span class="line">      return &lt;h1&gt;&#123;children&#125;&lt;/h1&gt;;</span><br><span class="line">    case 2:</span><br><span class="line">      return &lt;h2&gt;&#123;children&#125;&lt;/h2&gt;;</span><br><span class="line">    case 3:</span><br><span class="line">      return &lt;h3&gt;&#123;children&#125;&lt;/h3&gt;;</span><br><span class="line">    case 4:</span><br><span class="line">      return &lt;h4&gt;&#123;children&#125;&lt;/h4&gt;;</span><br><span class="line">    case 5:</span><br><span class="line">      return &lt;h5&gt;&#123;children&#125;&lt;/h5&gt;;</span><br><span class="line">    case 6:</span><br><span class="line">      return &lt;h6&gt;&#123;children&#125;&lt;/h6&gt;;</span><br><span class="line">    default:</span><br><span class="line">      throw Error(&#x27;Unknown level: &#x27; + level);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export const LevelContext = createContext(1);</span><br><span class="line"></span><br><span class="line">export default function Page() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Section level=&#123;1&#125;&gt;</span><br><span class="line">      &lt;Heading&gt;Title&lt;/Heading&gt;</span><br><span class="line">      &lt;Section level=&#123;2&#125;&gt;</span><br><span class="line">        &lt;Heading&gt;Heading&lt;/Heading&gt;</span><br><span class="line">        &lt;Heading&gt;Heading&lt;/Heading&gt;</span><br><span class="line">        &lt;Heading&gt;Heading&lt;/Heading&gt;</span><br><span class="line">        &lt;Section level=&#123;3&#125;&gt;</span><br><span class="line">          &lt;Heading&gt;Sub-heading&lt;/Heading&gt;</span><br><span class="line">          &lt;Heading&gt;Sub-heading&lt;/Heading&gt;</span><br><span class="line">          &lt;Heading&gt;Sub-heading&lt;/Heading&gt;</span><br><span class="line">          &lt;Section level=&#123;4&#125;&gt;</span><br><span class="line">            &lt;Heading&gt;Sub-sub-heading&lt;/Heading&gt;</span><br><span class="line">            &lt;Heading&gt;Sub-sub-heading&lt;/Heading&gt;</span><br><span class="line">            &lt;Heading&gt;Sub-sub-heading&lt;/Heading&gt;</span><br><span class="line">          &lt;/Section&gt;</span><br><span class="line">        &lt;/Section&gt;</span><br><span class="line">      &lt;/Section&gt;</span><br><span class="line">    &lt;/Section&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="useref">useRef</h2>
<p><strong>该组件不会随着ref每次增量而重新渲染</strong></p>
<p><code>useRef(initialValue)</code> is a built-in React hook that accepts one argument as the initial value and returns a <em>reference</em> (aka <em>ref</em>). A reference is an object having a special property <code>current</code>. <code>reference.current</code> accesses the reference value, and <code>reference.current = newValue</code> updates the reference value. Pretty simple.</p>
<ol type="1">
<li>The value of the reference is <em>persisted</em> (remains unchanged) between component re-renderings;</li>
<li>Updating a reference <em>doesn't trigger a component re-rendering</em>.</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const myref = useRef(null)</span><br><span class="line">export myref</span><br><span class="line"></span><br><span class="line">//use</span><br><span class="line">&lt;xxx ref=myref&gt;&lt;/xxx&gt;</span><br></pre></td></tr></table></figure>
<h2 id="useeffect">useEffect</h2>
<blockquote>
<p>Effects 会在渲染后运行一些代码，以便可以将组件与 React 之外的某些系统同步。</p>
<p>函数组件中 side effect 是不允许的</p>
<p>这些 side effect 写入 useEffect 中, 当 dependency 改变时执行函数体, <strong>Effect 允许你指定由渲染本身，而不是特定事件引起的副作用</strong> Effect 通常用于暂时“跳出” React 代码并与一些 <strong>外部</strong> 系统进行同步。</p>
<p>返回清理函数</p>
</blockquote>
<p><code>useEffect</code> 在组件渲染完成后（即“挂载”时）会执行一次，然后在每次组件重新渲染后都会执行。但是，通过依赖数组，你可以控制 <code>useEffect</code> 的触发时机。</p>
<p>过程</p>
<ol type="1">
<li><strong>Initial render/mounting</strong>: When a functional component that contains a <code>useEffect</code> Hook is initially rendered, the code inside the <code>useEffect</code> block runs <strong>after</strong> the initial render of the component. This is similar to <code>componentDidMount</code> class components</li>
<li><strong>Subsequent renders:</strong> You can pass a dependency array as the second argument to the <code>useEffect</code> Hook. This array contains variables or values that the effect depends on. <strong>Any change in these variables will re-render the component.</strong> <strong>If no dependency array is given, the effect will run on every render</strong></li>
<li><strong>Cleanup function</strong>: You can also run an optional cleanup function inside the effect. It is used to clean up any resources or subscriptions created by the effect when the component is unmounted or when the dependencies change</li>
<li><strong>Unmounting</strong>: If a cleanup function is present, it is run and then the component is unmounted from the DOM</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useEffect(</span><br><span class="line">    () =&gt; &#123; // execute side effect</span><br><span class="line">      return ()=&gt;&#123;&#125; // 下 useeffect 前执行, 进行清理</span><br><span class="line">    &#125;,</span><br><span class="line">    // optional dependency array</span><br><span class="line">    [       // 0 or more entries</span><br><span class="line">    ] </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>https://blog.logrocket.com/useeffect-react-hook-complete-guide/</p>
<h2 id="usememo">useMemo</h2>
<blockquote>
<p>执行大量计算时使用</p>
<p>只要 dependency 不变就会返回原本数据的 cache 只有 dependency 改变才会执行计算</p>
</blockquote>
<p>This hook caches (memoizes) a computed value and recomputes it only when required. The expensive function which comptues the value will only run when its dependencies have changed.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">expensiveCalculation</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Calculating...&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000000000</span>; i++) &#123;</span><br><span class="line">    num += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> calculation = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> <span class="title function_">expensiveCalculation</span>(count), [count]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Runs only when count changes, where count is a stae variable whose value changes using increment/decrement button</span></span><br></pre></td></tr></table></figure>
<h2 id="usecallback">useCallback</h2>
<p>This hook caches (memoizes) the function and recreates it only when required. The array of dependencies is important, it helps React understand when to return the memoized function and when to re-create it (refer 5)</p>
<p>因为函数在重新渲染时也会重建, useCallback 会记住指定的函数</p>
<h1 id="渲染">渲染</h1>
<figure>
<img src="https://raw.githubusercontent.com/SinosGray/picgo/master/test/202401211837308.png" alt="A Diagram Of React&#39;s Most Common Lifecycle Methods" /><figcaption aria-hidden="true">A Diagram Of React's Most Common Lifecycle Methods</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/SinosGray/picgo/master/test/202401211837983.png" alt="A Diagram Of The React Hooks Lifecycle" /><figcaption aria-hidden="true">A Diagram Of The React Hooks Lifecycle</figcaption>
</figure>
<p>渲染必须始终为 <a target="_blank" rel="noopener" href="https://react.nodejs.cn/learn/keeping-components-pure">纯计算</a>, 在 “严格模式” 开发时，React 会调用每个组件的函数两次，这可以帮助表面因函数不纯而导致的错误。</p>
<ol type="1">
<li><strong>触发</strong> 渲染（将客人的订单送到厨房）
<ol type="1">
<li>这是组件的 <strong>初始渲染。</strong></li>
<li>组件（或其祖级之一）的 <strong>状态已更新。</strong></li>
</ol></li>
<li><strong>渲染</strong> 组件（在厨房准备订单）
<ol type="1">
<li><strong>在初始渲染时，</strong> React 将调用根组件。</li>
<li><strong>对于后续渲染，</strong> React 将调用其状态更新触发渲染的函数组件。</li>
</ol></li>
<li><strong>提交</strong> 到 DOM（将订单放到桌上）
<ol type="1">
<li><strong>对于初始渲染，</strong> React 将使用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/docs/Web/API/Node/appendChild"><code>appendChild()</code></a> DOM API 将它创建的所有 DOM 节点放在屏幕上。</li>
<li><strong>对于重新渲染，</strong> React 将应用最少的必要操作（在渲染时计算！）以使 DOM 匹配最新的渲染输出。</li>
</ol></li>
<li>渲染完成并且 React 更新 DOM 后，浏览器将重新绘制屏幕。 尽管此过程称为 “浏览器渲染”，但我们将其称为 “绘制” 以避免在整个文档中造成混淆。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://react.nodejs.cn/learn/render-and-commit#step-2-react-renders-your-components">“渲染”</a> 表示 React 正在调用你的组件，这是一个函数。 从该函数返回的 JSX 就像 UI 的及时快照。 它的属性、事件处理程序和局部变量都经过计算， <strong>在渲染时使用它的状态。</strong> 当 React 重新渲染一个组件时：</p>
<ol type="1">
<li>React 再次调用你的函数。</li>
<li>你的函数返回一个新的 JSX 快照。</li>
<li>然后 React 更新屏幕以匹配函数返回的快照。</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setNumber</span>(<span class="number">0</span> + <span class="number">1</span>);</span><br><span class="line">  <span class="title function_">setNumber</span>(<span class="number">0</span> + <span class="number">1</span>);</span><br><span class="line">  <span class="title function_">setNumber</span>(<span class="number">0</span> + <span class="number">1</span>);</span><br><span class="line">&#125;&#125;&gt;+<span class="number">3</span>&lt;/button&gt;</span><br><span class="line"><span class="comment">// 下一次渲染的 number 是 1 而不是 3</span></span><br></pre></td></tr></table></figure>
<p>状态变量的值在渲染中永远不会改变， 即使其事件处理程序的代码是异步的。 在处理状态更新之前，React 会等到事件处理程序中的所有代码都已运行 多个 setNumber()形成队列, 下一次渲染前依次调用</p>
<p>你应该 <strong>将你放入状态的任何 JavaScript 对象视为只读。</strong>可以做的是替换而不是改变</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">setPerson(&#123;</span><br><span class="line">  ...person, // 浅 Copy the old fields</span><br><span class="line">  firstName: e.target.value // But override this one</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="redux">redux</h1>
<h2 id="概念">概念</h2>
<ul>
<li><p>action: 事件, action 是一个具有 <code>type</code> 字段的普通 JavaScript 对象, 按照惯例，我们将该信息放在名为 <code>payload</code> 的字段中。</p></li>
<li><p>action creator 是一个创建并返回一个 action 对象的函数</p></li>
<li><p>state</p></li>
<li><p>reducer: 接收 state 和 action作为其参数，并返回新 state 给应用的函数 reducer 函数内部的逻辑通常遵循以下步骤：</p>
<ul>
<li>检查 reducer 是否关心这个 action
<ul>
<li>如果是，则复制 state，使用新值更新 state 副本，然后返回新 state</li>
</ul></li>
<li>否则，返回原来的 state 不变</li>
</ul></li>
<li><p>Store: store 是通过传入一个 reducer 来创建的，并且有一个名为 <code>getState</code> 的方法，它返回当前状态值 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const store = configureStore(&#123; reducer: counterReducer &#125;)</span><br><span class="line">console.log(store.getState())</span><br><span class="line">// &#123;value: 0&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>dispatch: 更新 state 的唯一方法是调用 <code>store.dispatch()</code> 并传入一个 action 对象。 store 将执行所有 reducer 函数并计算出更新后的 state <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">store.dispatch(&#123; type: &#x27;counter/increment&#x27; &#125;)</span><br><span class="line">store.dispatch(increment())</span><br><span class="line">console.log(store.getState())</span><br><span class="line">// &#123;value: 1&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>Selector 函数可以从 store 状态树中提取指定的片段。随着应用变得越来越大，会遇到应用程序的不同部分需要读取相同的数据，selector 可以避免重复这样的读取逻辑</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const selectCounterValue = state =&gt; state.value</span><br><span class="line">const currentValue = selectCounterValue(store.getState())</span><br><span class="line">console.log(currentValue)</span><br><span class="line">// 2</span><br></pre></td></tr></table></figure></li>
<li><p>“slice” 是应用中单个功能的 Redux reducer 逻辑和 action 的集合, 通常一起定义在一个文件中。该名称来自于将根 Redux 状态对象拆分为多个状态 “slice”。 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; createSlice &#125; from &#x27;@reduxjs/toolkit&#x27;</span><br><span class="line">export const counterSlice = createSlice(&#123;</span><br><span class="line">  name: &#x27;counter&#x27;,</span><br><span class="line">  initialState: &#123;</span><br><span class="line">    value: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: state =&gt; &#123;</span><br><span class="line">      state.value += 1</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement: state =&gt; &#123;</span><br><span class="line">      state.value -= 1</span><br><span class="line">    &#125;,</span><br><span class="line">    incrementByAmount: (state, action) =&gt; &#123;</span><br><span class="line">      state.value += action.payload</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">export const &#123; increment, decrement, incrementByAmount &#125; = counterSlice.actions</span><br><span class="line">export default counterSlice.reducer</span><br><span class="line"></span><br><span class="line">console.log(counterSlice.actions.increment())</span><br><span class="line">// &#123;type: &quot;counter/increment&quot;&#125;</span><br><span class="line">const newState = counterSlice.reducer(</span><br><span class="line">  &#123; value: 10 &#125;,</span><br><span class="line">  counterSlice.actions.increment()</span><br><span class="line">)</span><br><span class="line">console.log(newState)</span><br><span class="line">// &#123;value: 11&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>thunk: 它允许你将 <em>thunk 函数</em> 直接传递给 <code>store.dispatch</code>。调用 thunk 函数时总是将 <code>(dispatch, getState)</code> 作为它的参数，你可以根据需要在 thunk 中使用它们。 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const logAndAdd = amount =&gt; &#123;</span><br><span class="line">  return (dispatch, getState) =&gt; &#123;</span><br><span class="line">    const stateBefore = getState()</span><br><span class="line">    console.log(`Counter before: $&#123;stateBefore.counter&#125;`)</span><br><span class="line">    dispatch(incrementByAmount(amount))</span><br><span class="line">    const stateAfter = getState()</span><br><span class="line">    console.log(`Counter after: $&#123;stateAfter.counter&#125;`)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">store.dispatch(logAndAdd(5))</span><br></pre></td></tr></table></figure></p></li>
</ul>
<h2 id="数据流">数据流</h2>
<ul>
<li>初始启动：
<ul>
<li>使用最顶层的 root reducer 函数创建 Redux store</li>
<li>store 调用一次 root reducer，并将返回值保存为它的初始 <code>state</code></li>
<li>当视图 首次渲染时，视图组件访问 Redux store 的当前 state，并使用该数据来决定要呈现的内容。同时监听 store 的更新，以便他们可以知道 state 是否已更改。</li>
</ul></li>
<li>更新环节：
<ul>
<li>应用程序中发生了某些事情，例如用户单击按钮</li>
<li>dispatch 一个 action 到 Redux store，例如 <code>dispatch(&#123;type: 'counter/increment'&#125;)</code></li>
<li>store 用之前的 <code>state</code> 和当前的 <code>action</code> 再次运行 reducer 函数，并将返回值保存为新的 <code>state</code></li>
<li>store 通知所有订阅过的视图，通知它们 store 发生更新</li>
<li>每个订阅过 store 数据的视图 组件都会检查它们需要的 state 部分是否被更新。</li>
<li>发现数据被更新的每个组件都强制使用新数据重新渲染，紧接着更新网页</li>
</ul></li>
</ul>
<h2 id="应用">应用</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; createSlice &#125; from &#x27;@reduxjs/toolkit&#x27;</span><br><span class="line">export const counterSlice = createSlice(&#123;</span><br><span class="line">  name: &#x27;counter&#x27;,</span><br><span class="line">  initialState: &#123;</span><br><span class="line">    value: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: state =&gt; &#123;</span><br><span class="line">      state.value += 1</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement: state =&gt; &#123;</span><br><span class="line">      state.value -= 1</span><br><span class="line">    &#125;,</span><br><span class="line">    incrementByAmount: (state, action) =&gt; &#123;</span><br><span class="line">      state.value += action.payload</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export const &#123; increment, decrement, incrementByAmount &#125; = counterSlice.actions</span><br><span class="line">export const incrementAsync = amount =&gt; dispatch =&gt; &#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    dispatch(incrementByAmount(amount))</span><br><span class="line">  &#125;, 1000)</span><br><span class="line">&#125;</span><br><span class="line">export default counterSlice.reducer</span><br><span class="line"></span><br><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;</span><br><span class="line">import &#123; useSelector, useDispatch &#125; from &#x27;react-redux&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  decrement,</span><br><span class="line">  increment,</span><br><span class="line">  incrementByAmount,</span><br><span class="line">  incrementAsync,</span><br><span class="line">  selectCount</span><br><span class="line">&#125; from &#x27;./counterSlice&#x27;</span><br><span class="line"></span><br><span class="line">export function Counter() &#123;</span><br><span class="line">  const count = useSelector(selectCount)</span><br><span class="line">  const dispatch = useDispatch()</span><br><span class="line">  const [incrementAmount, setIncrementAmount] = useState(&#x27;2&#x27;)</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; dispatch(increment())&#125;&gt;+&lt;/button&gt;</span><br><span class="line">          </span><br><span class="line">        &lt;span className=&#123;styles.value&#125;&gt;&#123;count&#125;&lt;/span&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          className=&#123;styles.button&#125;</span><br><span class="line">          aria-label=&quot;Decrement value&quot;</span><br><span class="line">          onClick=&#123;() =&gt; dispatch(decrement())&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          -</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &#123;/* 这里省略了额外的 render 代码 */&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// store.js</span><br><span class="line">import &#123; configureStore &#125; from &quot;@reduxjs/toolkit&quot;;</span><br><span class="line">import logReducer from &quot;../feature/log/logSlice&quot;;</span><br><span class="line">import articleReducer from &quot;../feature/article/articleSlice&quot;;</span><br><span class="line">export default configureStore(&#123;</span><br><span class="line">  reducer: &#123; log_store: logReducer, articles_store: articleReducer &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// slice.js</span><br><span class="line">import &#123; createSlice &#125; from &quot;@reduxjs/toolkit&quot;;</span><br><span class="line">export const logSlicer = createSlice(&#123;</span><br><span class="line">  name: &quot;log&quot;,</span><br><span class="line">  initialState: &#123;</span><br><span class="line">    logs: [&quot;init log&quot;],</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    // 在 createSlicer 中修改 state 是可以的, 因为会调用 immer 库, 其他地方则不可以</span><br><span class="line">    addlog: (state, new_log) =&gt; &#123;</span><br><span class="line">      state.logs.push(new_log.payload); //?.logs</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">export default logSlicer.reducer;</span><br><span class="line">export const &#123; addlog &#125; = logSlicer.actions;</span><br><span class="line">// first log_store is in store.js reducer.logs</span><br><span class="line">// seconde logs is initialstate.logs</span><br><span class="line">export const selectLogs = (state) =&gt; state.log_store.logs;</span><br><span class="line">export const &#123; increment, decrement, incrementByAmount &#125; = counterSlice.actions</span><br><span class="line">export const incrementAsync = amount =&gt; dispatch =&gt; &#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    dispatch(incrementByAmount(amount))</span><br><span class="line">  &#125;, 1000)</span><br><span class="line">&#125;</span><br><span class="line">export default counterSlice.reducer</span><br><span class="line"></span><br><span class="line">// view.js</span><br><span class="line">import &#123; useDispatch, useSelector &#125; from &quot;react-redux&quot;;</span><br><span class="line">import &#123; addlog, selectLogs &#125; from &quot;./logSlice&quot;;</span><br><span class="line">export function LogView() &#123;</span><br><span class="line">  const logs = useSelector(selectLogs);</span><br><span class="line">  const dispatch = useDispatch();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;li&gt;</span><br><span class="line">        &#123;logs.map((log, index) =&gt; (</span><br><span class="line">          &lt;ul key=&#123;index&#125;&gt;&#123;log&#125;&lt;/ul&gt;</span><br><span class="line">        ))&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(addlog(&quot;add log&quot;))&#125;&gt;&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">// how to log</span><br><span class="line">// const dispatch = useDispatch();</span><br><span class="line">// dispatch(addlog(&quot;dasdasd&quot;));</span><br></pre></td></tr></table></figure>
<h2 id="redux-toolkit">redux-toolkit</h2>
<ul>
<li>store 管理着所有的 state, 通过其中的的 reducer 将发生的 action 处理生成新的 action</li>
<li>slice 是 store 的一部分, 可以在其中定义 state 和 reducer createSlice is a higher order function that accepts <strong>an initial state, an object full of reducer functions and a slice name.</strong> 将 slice 注册到 store 是用 slice.reducer 注册的</li>
<li>useSelector(store =&gt; store.slice.state)</li>
<li>const dispathc = useDispatch()</li>
</ul>
<h1 id="props">props</h1>
<p><a target="_blank" rel="noopener" href="https://tekolio.com/what-are-props-in-react-and-how-to-use-them/">Props</a> are the read-only properties that are shared between components to give the unidirectional flow of React a dynamic touch. They're mainly shared from the parent component to the child component</p>
<p><strong>PropTypes</strong> are simply a mechanism that ensures that the passed value is of the correct datatype. This makes sure that we don’t receive an error at the very end of our app by the console which might not be easy to deal with</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AuthGuard.propTypes = &#123;</span><br><span class="line">  children: PropTypes.node</span><br><span class="line">&#125;;</span><br><span class="line">// PropTypes.node We can pass anything that can be rendered</span><br></pre></td></tr></table></figure>
<h1 id="cors">cors</h1>
<p>在标准互联网通信中，您的浏览器向应用程序服务器发送 HTTP 请求，以 HTTP 响应的形式接收数据，然后显示数据。在浏览器术语中，当前浏览器 URL 被称为<em>当前来源</em>，而第三方 URL 则是<em>跨源</em>的。</p>
<p>当您发出跨源请求时，请求-响应过程如下：</p>
<ol type="1">
<li>浏览器在请求中添加来源标头，其中包含有关当前来源的协议、主机和端口的信息</li>
<li>服务器检查当前来源标头，然后使用请求的数据和 Access-Control-Allow-Origin 标头进行响应</li>
<li>浏览器查看访问控制请求标头并与客户端应用程序共享返回的数据</li>
</ol>
<p>或者，如果服务器不想允许跨源访问，则会回复一则错误消息。</p>
<p>https://www.ruanyifeng.com/blog/2016/04/cors.html</p>
<p>CORS是一个W3C标准，全称是"跨域资源共享"（Cross-origin resource sharing）。</p>
<p>对于简单请求，浏览器直接发出CORS请求。具体来说，就是在头信息之中，增加一个<code>Origin</code>字段。<code>Origin</code>字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。 如果<code>Origin</code>指定的源，不在许可范围内，服务器会返回一个正常的HTTP回应。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 请求</span></span><br><span class="line">GET /cors HTTP/<span class="number">1.1</span></span><br><span class="line">Origin<span class="punctuation">:</span> http<span class="punctuation">:</span><span class="comment">//api.bob.com</span></span><br><span class="line">Host<span class="punctuation">:</span> api.alice.com</span><br><span class="line">Accept-Language<span class="punctuation">:</span> en-US</span><br><span class="line">Connection<span class="punctuation">:</span> keep-alive</span><br><span class="line">User-Agent<span class="punctuation">:</span> Mozilla/<span class="number">5.0</span>...</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应</span></span><br><span class="line">Access-Control-Allow-Origin<span class="punctuation">:</span> http<span class="punctuation">:</span><span class="comment">//api.bob.com //来自请求</span></span><br><span class="line">Access-Control-Allow-Credentials<span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="comment">//它的值是一个布尔值，表示是否允许发送Cookie</span></span><br><span class="line">Access-Control-Expose-Headers<span class="punctuation">:</span> FooBar</span><br><span class="line">Content-Type<span class="punctuation">:</span> text/html; charset=utf<span class="number">-8</span></span><br></pre></td></tr></table></figure>
<p>非简单请求的CORS请求，会在正式通信之前，增加一次HTTP查询请求，称为"预检"请求（preflight）。浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的<code>XMLHttpRequest</code>请求，否则就报错。</p>
<h1 id="mui">mui</h1>
<h2 id="component-prop">component prop</h2>
<blockquote>
<p>The component used for the root node. Either a string to use a HTML element or a component.</p>
</blockquote>
<p>In the button <em>component</em> from the MUI library, it is possible to pass in one of these components to render in for that button and provide some useful logic or styling in that area. In the case of a string, you can provide the name of default HTML elements (think <code>input</code>, <code>div</code>, <code>a</code> etc) and MUI will render one of these elements instead. In this case you are selecting a <code>label</code> element which is commonly used alongside an <code>input</code> element.</p>
<h2 id="typography-排版">Typography 排版</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Typography variant=&quot;h4&quot;&gt;Register&lt;/Typography&gt;</span><br></pre></td></tr></table></figure>
<h1 id="next">next</h1>
<h2 id="app-_document">_app, _document</h2>
<h1 id="auth-js">auth js</h1>
<p>https://authjs.dev/reference/express</p>
<p>https://medium.com/<span class="citation" data-cites="jibla/auth-js-exploration-1b6c27cf076f">@jibla/auth-js-exploration-1b6c27cf076f</span></p>
<p>Sessions refer to the practice of <strong>maintaining authentication artifacts on the server side, while the client only holds the session id</strong> (in a cookie or local storage). The server holds the actual authentication data, including user data and roles.</p>
<p>Tokens, on the other hand, are client-side mechanisms for maintaining authentication. With tokens, there is no need to hold the authenticated user’s data on the server. Instead, <strong>all necessary information is contained within the tokens, which are saved on the client-side</strong>. Tokens come in various types, with one of the most popular being JSON Web Tokens (JWT). Other types include API keys, OAuth artifacts, SSL/TLS certificates, and others. All of these are different forms of tokens with different properties.</p>
<ol type="1">
<li><p>First, you need to verify the user’s identity using one of several methods (username and password, magic links, API tokens, or OAuth).</p></li>
<li><p>Second, you need to save the authentication artifact and use it for subsequent HTTP requests.</p></li>
<li><p>Finally, you need to establish a way to refresh the authentication artifact. This overall schema remains consistent, regardless of the specific authentication method used.</p></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2024/01/e6a15612f4ba.html">https://sinos_wei.gitee.io/2024/01/e6a15612f4ba.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/cover/IMG_2403.JPG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/528ebafedd20.html" title="rfc笔记"><img class="cover" src="/img/cover/32222.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">rfc笔记</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/7f63baa7f30d.html" title="mysql面经"><img class="cover" src="/img/cover/IMG_2433.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">mysql面经</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">199</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SinosGray"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/SinosGray" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://8.130.42.149:5230" target="_blank" title="memo"><i class="fab fa-heart"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#jsx"><span class="toc-number">1.</span> <span class="toc-text">jsx</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E5%B1%9E%E6%80%A7"><span class="toc-number">2.</span> <span class="toc-text">传递属性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E7%BB%84%E4%BB%B6%E5%90%91%E7%88%B6%E5%AD%90%E9%97%B4%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.</span> <span class="toc-text">子组件向父子间传递数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hooks"><span class="toc-number">4.</span> <span class="toc-text">hooks</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8A%B6%E6%80%81"><span class="toc-number">5.</span> <span class="toc-text">状态</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#usestate"><span class="toc-number">5.1.</span> <span class="toc-text">useState</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usereducer"><span class="toc-number">5.2.</span> <span class="toc-text">useReducer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usecontext"><span class="toc-number">5.3.</span> <span class="toc-text">useContext</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useref"><span class="toc-number">5.4.</span> <span class="toc-text">useRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useeffect"><span class="toc-number">5.5.</span> <span class="toc-text">useEffect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usememo"><span class="toc-number">5.6.</span> <span class="toc-text">useMemo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usecallback"><span class="toc-number">5.7.</span> <span class="toc-text">useCallback</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93"><span class="toc-number">6.</span> <span class="toc-text">渲染</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#redux"><span class="toc-number">7.</span> <span class="toc-text">redux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">7.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">7.2.</span> <span class="toc-text">数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">7.3.</span> <span class="toc-text">应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redux-toolkit"><span class="toc-number">7.4.</span> <span class="toc-text">redux-toolkit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#props"><span class="toc-number">8.</span> <span class="toc-text">props</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cors"><span class="toc-number">9.</span> <span class="toc-text">cors</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mui"><span class="toc-number">10.</span> <span class="toc-text">mui</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#component-prop"><span class="toc-number">10.1.</span> <span class="toc-text">component prop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#typography-%E6%8E%92%E7%89%88"><span class="toc-number">10.2.</span> <span class="toc-text">Typography 排版</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#next"><span class="toc-number">11.</span> <span class="toc-text">next</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#app-_document"><span class="toc-number">11.1.</span> <span class="toc-text">_app, _document</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#auth-js"><span class="toc-number">12.</span> <span class="toc-text">auth js</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/59cb1b4312ed.html" title="cppdoc"><img src="/img/cover/00000075.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cppdoc"/></a><div class="content"><a class="title" href="/2024/03/59cb1b4312ed.html" title="cppdoc">cppdoc</a><time datetime="2024-03-14T13:13:29.240Z" title="Updated 2024-03-14 21:13:29">2024-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/f05961026253.html" title="数据结构"><img src="/img/cover/00000074.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构"/></a><div class="content"><a class="title" href="/2023/05/f05961026253.html" title="数据结构">数据结构</a><time datetime="2024-03-05T06:20:26.634Z" title="Updated 2024-03-05 14:20:26">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/528ebafedd20.html" title="rfc笔记"><img src="/img/cover/32222.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="rfc笔记"/></a><div class="content"><a class="title" href="/2024/01/528ebafedd20.html" title="rfc笔记">rfc笔记</a><time datetime="2024-03-05T04:21:10.802Z" title="Updated 2024-03-05 12:21:10">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/724d57ab8c34.html" title="操作系统"><img src="/img/cover/00000129.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2023/05/724d57ab8c34.html" title="操作系统">操作系统</a><time datetime="2024-03-05T03:24:13.030Z" title="Updated 2024-03-05 11:24:13">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/625740ff980e.html" title="git-tips"><img src="/img/cover/00000179.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git-tips"/></a><div class="content"><a class="title" href="/2023/08/625740ff980e.html" title="git-tips">git-tips</a><time datetime="2024-03-04T10:02:47.316Z" title="Updated 2024-03-04 18:02:47">2024-03-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>