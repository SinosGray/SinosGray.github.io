<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>深入理解并行编程读书笔记 | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="深入理解并行编程读书笔记">
<meta property="og:url" content="https://sinos_wei.gitee.io/2023/03/195fa7ee015e.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/78.jpeg">
<meta property="article:published_time" content="2023-03-26T07:13:40.000Z">
<meta property="article:modified_time" content="2023-08-01T08:07:38.257Z">
<meta property="article:author" content="Sinos">
<meta property="article:tag" content="locking">
<meta property="article:tag" content="parallel">
<meta property="article:tag" content="counting">
<meta property="article:tag" content="discussion">
<meta property="article:tag" content="limit">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/78.jpeg"><link rel="shortcut icon" href="/img/avatar.jpeg"><link rel="canonical" href="https://sinos_wei.gitee.io/2023/03/195fa7ee015e.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '深入理解并行编程读书笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-01 16:07:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">191</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/78.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="Sinos_wei's blog"><span class="site-name">Sinos_wei's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">深入理解并行编程读书笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-03-26T07:13:40.000Z" title="Created 2023-03-26 15:13:40">2023-03-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-08-01T08:07:38.257Z" title="Updated 2023-08-01 16:07:38">2023-08-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="深入理解并行编程读书笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>

</blockquote>
<span id="more"></span>
<h1 id="how-to-use-this-book">1 How To Use This Book</h1>
<h2 id="roadmap">1.1 Roadmap</h2>
<h2 id="quick-quizzes">1.2 Quick Quizzes</h2>
<h2 id="alternatives-to-this-book">1.3 Alternatives to This Book</h2>
<h2 id="sample-source-code">1.4 Sample Source Code</h2>
<h2 id="whose-book-is-this">1.5 Whose Book Is This?</h2>
<h1 id="introduction">2 Introduction</h1>
<h2 id="historic-parallel-programming-difficulties">2.1 Historic Parallel Programming Difficulties</h2>
<h2 id="parallel-programming-goals">2.2 Parallel Programming Goals</h2>
<h3 id="performance">2.2.1 Performance</h3>
<h3 id="productivity">2.2.2 Productivity</h3>
<h3 id="generality">2.2.3 Generality</h3>
<h2 id="alternatives-to-parallel-programming">2.3 Alternatives to Parallel Programming</h2>
<h3 id="multiple-instances-of-a-sequential-application">2.3.1 Multiple Instances of a Sequential Application</h3>
<h3 id="use-existing-parallel-software">2.3.2 Use Existing Parallel Software</h3>
<h3 id="performance-optimization">2.3.3 Performance Optimization</h3>
<h2 id="what-makes-parallel-programming-hard">2.4 What Makes Parallel Programming Hard?</h2>
<h3 id="work-partitioning">2.4.1 Work Partitioning</h3>
<h3 id="parallel-access-control">2.4.2 Parallel Access Control</h3>
<h3 id="resource-partitioning-and-replication">2.4.3 Resource Partitioning and Replication</h3>
<h3 id="interacting-with-hardware">2.4.4 Interacting With Hardware</h3>
<h3 id="composite-capabilities">2.4.5 Composite Capabilities</h3>
<h3 id="how-do-languages-and-environments-assist-with-these-tasks">2.4.6 How Do Languages and Environments Assist With These Tasks?</h3>
<h2 id="discussion">2.5 Discussion</h2>
<h1 id="hardware-and-its-habits">3 Hardware and its Habits</h1>
<h2 id="overview">3.1 Overview</h2>
<h3 id="pipelined-cpus">3.1.1 Pipelined CPUs</h3>
<h3 id="memory-references">3.1.2 Memory References</h3>
<h3 id="atomic-operations">3.1.3 Atomic Operations</h3>
<h3 id="memory-barriers">3.1.4 Memory Barriers</h3>
<h3 id="cache-misses">3.1.5 Cache Misses</h3>
<h3 id="io-operations">3.1.6 I/O Operations</h3>
<h2 id="overheads">3.2 Overheads</h2>
<h3 id="hardware-system-architecture">3.2.1 Hardware System Architecture</h3>
<h3 id="costs-of-operations">3.2.2 Costs of Operations</h3>
<h3 id="hardware-optimizations">3.2.3 Hardware Optimizations</h3>
<h2 id="hardware-free-lunch">3.3 Hardware Free Lunch?</h2>
<h3 id="d-integration">3.3.1 3D Integration</h3>
<h3 id="novel-materials-and-processes">3.3.2 Novel Materials and Processes</h3>
<h3 id="light-not-electrons">3.3.3 Light, Not Electrons</h3>
<h3 id="special-purpose-accelerators">3.3.4 Special-Purpose Accelerators</h3>
<h3 id="existing-parallel-software">3.3.5 Existing Parallel Software</h3>
<h2 id="software-design-implications">3.4 Software Design Implications</h2>
<h1 id="tools-of-the-trade">4 Tools of the Trade</h1>
<h2 id="scripting-languages">4.1 Scripting Languages</h2>
<h2 id="posix-multiprocessing">4.2 POSIX Multiprocessing</h2>
<h3 id="posix-process-creation-and-destruction">4.2.1 POSIX Process Creation and Destruction</h3>
<h3 id="posix-thread-creation-and-destruction">4.2.2 POSIX Thread Creation and Destruction</h3>
<h3 id="posix-locking">4.2.3 POSIX Locking</h3>
<h3 id="posix-reader-writer-locking">4.2.4 POSIX Reader-Writer Locking</h3>
<h3 id="atomic-operations-gcc-classic">4.2.5 Atomic Operations (GCC Classic)</h3>
<h3 id="atomic-operations-c11">4.2.6 Atomic Operations (C11)</h3>
<h3 id="atomic-operations-modern-gcc">4.2.7 Atomic Operations (Modern GCC)</h3>
<h3 id="per-thread-variables">4.2.8 Per-Thread Variables</h3>
<h2 id="alternatives-to-posix-operations">4.3 Alternatives to POSIX Operations</h2>
<h3 id="organization-and-initialization">4.3.1 Organization and Initialization</h3>
<h3 id="thread-creation-destruction-and-control">4.3.2 Thread Creation, Destruction, and Control</h3>
<h3 id="locking">4.3.3 Locking</h3>
<h3 id="accessing-shared-variables">4.3.4 Accessing Shared Variables</h3>
<h3 id="atomic-operations-1">4.3.5 Atomic Operations</h3>
<h3 id="per-cpu-variables">4.3.6 Per-CPU Variables</h3>
<h2 id="the-right-tool-for-the-job-how-to-choose">4.4 The Right Tool for the Job: How to Choose?</h2>
<h1 id="counting">5 Counting</h1>
<h2 id="why-isnt-concurrent-counting-trivial">5.1 Why Isn't Concurrent Counting Trivial?</h2>
<h2 id="statistical-counters">5.2 Statistical Counters</h2>
<h3 id="design">5.2.1 Design</h3>
<h3 id="array-based-implementation">5.2.2 Array-Based Implementation</h3>
<h3 id="per-thread-variable-based-implementation">5.2.3 Per-Thread-Variable-Based Implementation</h3>
<h3 id="eventually-consistent-implementation">5.2.4 Eventually Consistent Implementation</h3>
<h3 id="discussion-1">5.2.5 Discussion</h3>
<h2 id="approximate-limit-counters">5.3 Approximate Limit Counters</h2>
<h3 id="design-1">5.3.1 Design</h3>
<h3 id="simple-limit-counter-implementation">5.3.2 Simple Limit Counter Implementation</h3>
<h3 id="simple-limit-counter-discussion">5.3.3 Simple Limit Counter Discussion</h3>
<h3 id="approximate-limit-counter-implementation">5.3.4 Approximate Limit Counter Implementation</h3>
<h3 id="approximate-limit-counter-discussion">5.3.5 Approximate Limit Counter Discussion</h3>
<h2 id="exact-limit-counters">5.4 Exact Limit Counters</h2>
<h3 id="atomic-limit-counter-implementation">5.4.1 Atomic Limit Counter Implementation</h3>
<h3 id="atomic-limit-counter-discussion">5.4.2 Atomic Limit Counter Discussion</h3>
<h3 id="signal-theft-limit-counter-design">5.4.3 Signal-Theft Limit Counter Design</h3>
<h3 id="signal-theft-limit-counter-implementation">5.4.4 Signal-Theft Limit Counter Implementation</h3>
<h3 id="signal-theft-limit-counter-discussion">5.4.5 Signal-Theft Limit Counter Discussion</h3>
<h3 id="applying-exact-limit-counters">5.4.6 Applying Exact Limit Counters</h3>
<h2 id="parallel-counting-discussion">5.5 Parallel Counting Discussion</h2>
<h3 id="parallel-counting-validation">5.5.1 Parallel Counting Validation</h3>
<h3 id="parallel-counting-performance">5.5.2 Parallel Counting Performance</h3>
<h3 id="parallel-counting-specializations">5.5.3 Parallel Counting Specializations</h3>
<h3 id="parallel-counting-lessons">5.5.4 Parallel Counting Lessons</h3>
<h1 id="partitioning-and-synchronization-design">6 Partitioning and Synchronization Design</h1>
<h2 id="partitioning-exercises">6.1 Partitioning Exercises</h2>
<h3 id="dining-philosophers-problem">6.1.1 Dining Philosophers Problem</h3>
<h3 id="double-ended-queue">6.1.2 Double-Ended Queue</h3>
<h3 id="partitioning-example-discussion">6.1.3 Partitioning Example Discussion</h3>
<h2 id="design-criteria">6.2 Design Criteria</h2>
<h2 id="synchronization-granularity">6.3 Synchronization Granularity</h2>
<h3 id="sequential-program">6.3.1 Sequential Program</h3>
<h3 id="code-locking">6.3.2 Code Locking</h3>
<h3 id="data-locking">6.3.3 Data Locking</h3>
<h3 id="data-ownership">6.3.4 Data Ownership</h3>
<h3 id="locking-granularity-and-performance">6.3.5 Locking Granularity and Performance</h3>
<h2 id="parallel-fastpath">6.4 Parallel Fastpath</h2>
<h3 id="readerwriter-locking">6.4.1 Reader/Writer Locking</h3>
<h3 id="hierarchical-locking">6.4.2 Hierarchical Locking</h3>
<h3 id="resource-allocator-caches">6.4.3 Resource Allocator Caches</h3>
<h2 id="beyond-partitioning">6.5 Beyond Partitioning</h2>
<h3 id="work-queue-parallel-maze-solver">6.5.1 Work-Queue Parallel Maze Solver</h3>
<h3 id="alternative-parallel-maze-solver">6.5.2 Alternative Parallel Maze Solver</h3>
<h3 id="maze-validation">6.5.3 Maze Validation</h3>
<h3 id="performance-comparison-i">6.5.4 Performance Comparison I</h3>
<h3 id="alternative-sequential-maze-solver">6.5.5 Alternative Sequential Maze Solver</h3>
<h3 id="performance-comparison-ii">6.5.6 Performance Comparison II</h3>
<h3 id="future-directions-and-conclusions">6.5.7 Future Directions and Conclusions</h3>
<h2 id="partitioning-parallelism-and-optimization">6.6 Partitioning, Parallelism, and Optimization</h2>
<h1 id="locking-1">7 Locking</h1>
<h2 id="staying-alive">7.1 Staying Alive</h2>
<h3 id="deadlock">7.1.1 Deadlock</h3>
<h3 id="livelock-and-starvation">7.1.2 Livelock and Starvation</h3>
<h3 id="unfairness">7.1.3 Unfairness</h3>
<h3 id="inefficiency">7.1.4 Inefficiency</h3>
<h2 id="types-of-locks">7.2 Types of Locks</h2>
<h3 id="exclusive-locks">7.2.1 Exclusive Locks</h3>
<h3 id="reader-writer-locks">7.2.2 Reader-Writer Locks</h3>
<h3 id="beyond-reader-writer-locks">7.2.3 Beyond Reader-Writer Locks</h3>
<h3 id="scoped-locking">7.2.4 Scoped Locking</h3>
<h2 id="locking-implementation-issues">7.3 Locking Implementation Issues</h2>
<h3 id="sample-exclusive-locking-implementation-based-on-atomic-exchange">7.3.1 Sample Exclusive-Locking Implementation Based on Atomic Exchange</h3>
<h3 id="other-exclusive-locking-implementations">7.3.2 Other Exclusive-Locking Implementations</h3>
<h2 id="lock-based-existence-guarantees">7.4 Lock-Based Existence Guarantees</h2>
<h2 id="locking-hero-or-villain">7.5 Locking: Hero or Villain?</h2>
<h3 id="locking-for-applications-hero">7.5.1 Locking For Applications: Hero!</h3>
<h3 id="locking-for-parallel-libraries-just-another-tool">7.5.2 Locking For Parallel Libraries: Just Another Tool</h3>
<h3 id="locking-for-parallelizing-sequential-libraries-villain">7.5.3 Locking For Parallelizing Sequential Libraries: Villain!</h3>
<h2 id="summary">7.6 Summary</h2>
<h1 id="data-ownership-1">8 Data Ownership</h1>
<h2 id="multiple-processes">8.1 Multiple Processes</h2>
<h2 id="partial-data-ownership-and-pthreads">8.2 Partial Data Ownership and pthreads</h2>
<h2 id="function-shipping">8.3 Function Shipping</h2>
<h2 id="designated-thread">8.4 Designated Thread</h2>
<h2 id="privatization">8.5 Privatization</h2>
<h2 id="other-uses-of-data-ownership">8.6 Other Uses of Data Ownership</h2>
<h1 id="deferred-processing">9 Deferred Processing</h1>
<h2 id="running-example">9.1 Running Example</h2>
<h2 id="reference-counting">9.2 Reference Counting</h2>
<h2 id="hazard-pointers">9.3 Hazard Pointers</h2>
<h2 id="sequence-locks">9.4 Sequence Locks</h2>
<h2 id="read-copy-update-rcu">9.5 Read-Copy Update (RCU)</h2>
<h3 id="introduction-to-rcu">9.5.1 Introduction to RCU</h3>
<h3 id="rcu-fundamentals">9.5.2 RCU Fundamentals</h3>
<h3 id="rcu-linux-kernel-api">9.5.3 RCU Linux-Kernel API</h3>
<h3 id="rcu-usage">9.5.4 RCU Usage</h3>
<h3 id="rcu-related-work">9.5.5 RCU Related Work</h3>
<h2 id="which-to-choose">9.6 Which to Choose?</h2>
<h3 id="which-to-choose-overview">9.6.1 Which to Choose? (Overview)</h3>
<h3 id="which-to-choose-details">9.6.2 Which to Choose? (Details)</h3>
<h3 id="which-to-choose-production-use">9.6.3 Which to Choose? (Production Use)</h3>
<h2 id="what-about-updates">9.7 What About Updates?</h2>
<h1 id="data-structures">10 Data Structures</h1>
<h2 id="motivating-application">10.1 Motivating Application</h2>
<h2 id="partitionable-data-structures">10.2 Partitionable Data Structures</h2>
<h3 id="hash-table-design">10.2.1 Hash-Table Design</h3>
<h3 id="hash-table-implementation">10.2.2 Hash-Table Implementation</h3>
<h3 id="hash-table-performance">10.2.3 Hash-Table Performance</h3>
<h2 id="read-mostly-data-structures">10.3 Read-Mostly Data Structures</h2>
<h3 id="rcu-protected-hash-table-implementation">10.3.1 RCU-Protected Hash Table Implementation</h3>
<h3 id="rcu-protected-hash-table-validation">10.3.2 RCU-Protected Hash Table Validation</h3>
<h3 id="rcu-protected-hash-table-performance">10.3.3 RCU-Protected Hash Table Performance</h3>
<h3 id="rcu-protected-hash-table-discussion">10.3.4 RCU-Protected Hash Table Discussion</h3>
<h2 id="non-partitionable-data-structures">10.4 Non-Partitionable Data Structures</h2>
<h3 id="resizable-hash-table-design">10.4.1 Resizable Hash Table Design</h3>
<h3 id="resizable-hash-table-implementation">10.4.2 Resizable Hash Table Implementation</h3>
<h3 id="resizable-hash-table-discussion">10.4.3 Resizable Hash Table Discussion</h3>
<h3 id="other-resizable-hash-tables">10.4.4 Other Resizable Hash Tables</h3>
<h2 id="other-data-structures">10.5 Other Data Structures</h2>
<h2 id="micro-optimization">10.6 Micro-Optimization</h2>
<h3 id="specialization">10.6.1 Specialization</h3>
<h3 id="bits-and-bytes">10.6.2 Bits and Bytes</h3>
<h3 id="hardware-considerations">10.6.3 Hardware Considerations</h3>
<h2 id="summary-1">10.7 Summary</h2>
<h1 id="validation">11 Validation</h1>
<h2 id="introduction-1">11.1 Introduction</h2>
<h3 id="where-do-bugs-come-from">11.1.1 Where Do Bugs Come From?</h3>
<h3 id="required-mindset">11.1.2 Required Mindset</h3>
<h3 id="when-should-validation-start">11.1.3 When Should Validation Start?</h3>
<h3 id="the-open-source-way">11.1.4 The Open Source Way</h3>
<h2 id="tracing">11.2 Tracing</h2>
<h2 id="assertions">11.3 Assertions</h2>
<h2 id="static-analysis">11.4 Static Analysis</h2>
<h2 id="code-review">11.5 Code Review</h2>
<h3 id="inspection">11.5.1 Inspection</h3>
<h3 id="walkthroughs">11.5.2 Walkthroughs</h3>
<h3 id="self-inspection">11.5.3 Self-Inspection</h3>
<h2 id="probability-and-heisenbugs">11.6 Probability and Heisenbugs</h2>
<h3 id="statistics-for-discrete-testing">11.6.1 Statistics for Discrete Testing</h3>
<h3 id="statistics-abuse-for-discrete-testing">11.6.2 Statistics Abuse for Discrete Testing</h3>
<h3 id="statistics-for-continuous-testing">11.6.3 Statistics for Continuous Testing</h3>
<h3 id="hunting-heisenbugs">11.6.4 Hunting Heisenbugs</h3>
<h2 id="performance-estimation">11.7 Performance Estimation</h2>
<h3 id="benchmarking">11.7.1 Benchmarking</h3>
<h3 id="profiling">11.7.2 Profiling</h3>
<h3 id="differential-profiling">11.7.3 Differential Profiling</h3>
<h3 id="microbenchmarking">11.7.4 Microbenchmarking</h3>
<h3 id="isolation">11.7.5 Isolation</h3>
<h3 id="detecting-interference">11.7.6 Detecting Interference</h3>
<h2 id="summary-2">11.8 Summary</h2>
<h1 id="formal-verification">12 Formal Verification</h1>
<h2 id="state-space-search">12.1 State-Space Search</h2>
<h3 id="promela-and-spin">12.1.1 Promela and Spin</h3>
<h3 id="how-to-use-promela">12.1.2 How to Use Promela</h3>
<h3 id="promela-example-locking">12.1.3 Promela Example: Locking</h3>
<h3 id="promela-example-qrcu">12.1.4 Promela Example: QRCU</h3>
<h3 id="promela-parable-dynticks-and-preemptible-rcu">12.1.5 Promela Parable: dynticks and Preemptible RCU</h3>
<h3 id="validating-preemptible-rcu-and-dynticks">12.1.6 Validating Preemptible RCU and dynticks</h3>
<h2 id="special-purpose-state-space-search">12.2 Special-Purpose State-Space Search</h2>
<h3 id="anatomy-of-a-litmus-test">12.2.1 Anatomy of a Litmus Test</h3>
<h3 id="what-does-this-litmus-test-mean">12.2.2 What Does This Litmus Test Mean?</h3>
<h3 id="running-a-litmus-test">12.2.3 Running a Litmus Test</h3>
<h3 id="ppcmem-discussion">12.2.4 PPCMEM Discussion</h3>
<h2 id="axiomatic-approaches">12.3 Axiomatic Approaches</h2>
<h3 id="axiomatic-approaches-and-locking">12.3.1 Axiomatic Approaches and Locking</h3>
<h3 id="axiomatic-approaches-and-rcu">12.3.2 Axiomatic Approaches and RCU</h3>
<h2 id="sat-solvers">12.4 SAT Solvers</h2>
<h2 id="stateless-model-checkers">12.5 Stateless Model Checkers</h2>
<h2 id="summary-3">12.6 Summary</h2>
<h2 id="choosing-a-validation-plan">12.7 Choosing a Validation Plan</h2>
<h1 id="putting-it-all-together">13 Putting It All Together</h1>
<h2 id="counter-conundrums">13.1 Counter Conundrums</h2>
<h3 id="counting-updates">13.1.1 Counting Updates</h3>
<h3 id="counting-lookups">13.1.2 Counting Lookups</h3>
<h2 id="refurbish-reference-counting">13.2 Refurbish Reference Counting</h2>
<h3 id="implementation-of-reference-counting-categories">13.2.1 Implementation of Reference-Counting Categories</h3>
<h3 id="counter-optimizations">13.2.2 Counter Optimizations</h3>
<h2 id="hazard-pointer-helpers">13.3 Hazard-Pointer Helpers</h2>
<h3 id="scalable-reference-count">13.3.1 Scalable Reference Count</h3>
<h3 id="long-duration-accesses">13.3.2 Long-Duration Accesses</h3>
<h2 id="sequence-locking-specials">13.4 Sequence-Locking Specials</h2>
<h3 id="dueling-sequence-locks">13.4.1 Dueling Sequence Locks</h3>
<h3 id="correlated-data-elements">13.4.2 Correlated Data Elements</h3>
<h3 id="atomic-move">13.4.3 Atomic Move</h3>
<h3 id="upgrade-to-writer">13.4.4 Upgrade to Writer</h3>
<h2 id="rcu-rescues">13.5 RCU Rescues</h2>
<h3 id="rcu-and-per-thread-variable-based-statistical-counters">13.5.1 RCU and Per-Thread-Variable-Based Statistical Counters</h3>
<h3 id="rcu-and-counters-for-removable-io-devices">13.5.2 RCU and Counters for Removable I/O Devices</h3>
<h3 id="array-and-length">13.5.3 Array and Length</h3>
<h3 id="correlated-fields">13.5.4 Correlated Fields</h3>
<h3 id="update-friendly-traversal">13.5.5 Update-Friendly Traversal</h3>
<h3 id="scalable-reference-count-two">13.5.6 Scalable Reference Count Two</h3>
<h3 id="retriggered-grace-periods">13.5.7 Retriggered Grace Periods</h3>
<h3 id="long-duration-accesses-two">13.5.8 Long-Duration Accesses Two</h3>
<h1 id="advanced-synchronization">14 Advanced Synchronization</h1>
<h2 id="avoiding-locks">14.1 Avoiding Locks</h2>
<h2 id="non-blocking-synchronization">14.2 Non-Blocking Synchronization</h2>
<h3 id="simple-nbs">14.2.1 Simple NBS</h3>
<h3 id="applicability-of-nbs-benefits">14.2.2 Applicability of NBS Benefits</h3>
<h3 id="nbs-discussion">14.2.3 NBS Discussion</h3>
<h2 id="parallel-real-time-computing">14.3 Parallel Real-Time Computing</h2>
<h3 id="what-is-real-time-computing">14.3.1 What is Real-Time Computing?</h3>
<h3 id="who-needs-real-time">14.3.2 Who Needs Real-Time?</h3>
<h3 id="who-needs-parallel-real-time">14.3.3 Who Needs Parallel Real-Time?</h3>
<h3 id="implementing-parallel-real-time-systems">14.3.4 Implementing Parallel Real-Time Systems</h3>
<h3 id="implementing-parallel-real-time-operating-systems">14.3.5 Implementing Parallel Real-Time Operating Systems</h3>
<h3 id="implementing-parallel-real-time-applications">14.3.6 Implementing Parallel Real-Time Applications</h3>
<h4 id="real-time-vs.-real-fast-how-to-choose">14.3.7 Real Time vs. Real Fast: How to Choose?</h4>
<h1 id="advanced-synchronization-memory-ordering">15 Advanced Synchronization: Memory Ordering</h1>
<h2 id="ordering-why-and-how">15.1 Ordering: Why and How?</h2>
<h3 id="why-hardware-misordering">15.1.1 Why Hardware Misordering?</h3>
<h3 id="how-to-force-ordering">15.1.2 How to Force Ordering?</h3>
<h3 id="basic-rules-of-thumb">15.1.3 Basic Rules of Thumb</h3>
<h2 id="tricks-and-traps">15.2 Tricks and Traps</h2>
<h3 id="variables-with-multiple-values">15.2.1 Variables With Multiple Values</h3>
<h3 id="memory-reference-reordering">15.2.2 Memory-Reference Reordering</h3>
<h3 id="address-dependencies">15.2.3 Address Dependencies</h3>
<h3 id="data-dependencies">15.2.4 Data Dependencies</h3>
<h3 id="control-dependencies">15.2.5 Control Dependencies</h3>
<h3 id="cache-coherence">15.2.6 Cache Coherence</h3>
<h3 id="multicopy-atomicity">15.2.7 Multicopy Atomicity</h3>
<h2 id="compile-time-consternation">15.3 Compile-Time Consternation</h2>
<h3 id="memory-reference-restrictions">15.3.1 Memory-Reference Restrictions</h3>
<h3 id="address--and-data-dependency-difficulties">15.3.2 Address- and Data-Dependency Difficulties</h3>
<h3 id="control-dependency-calamities">15.3.3 Control-Dependency Calamities</h3>
<h2 id="higher-level-primitives">15.4 Higher-Level Primitives</h2>
<h3 id="memory-allocation">15.4.1 Memory Allocation</h3>
<h3 id="locking-2">15.4.2 Locking</h3>
<h3 id="rcu">15.4.3 RCU</h3>
<h2 id="hardware-specifics">15.5 Hardware Specifics</h2>
<h3 id="alpha">15.5.1 Alpha</h3>
<h3 id="armv7-ar">15.5.2 Armv7-A/R</h3>
<h3 id="armv8">15.5.3 Armv8</h3>
<h3 id="itanium">15.5.4 Itanium</h3>
<h3 id="mips">15.5.5 MIPS</h3>
<h3 id="power-powerpc">15.5.6 POWER / PowerPC</h3>
<h3 id="sparc-tso">15.5.7 SPARC TSO</h3>
<h3 id="x86">15.5.8 x86</h3>
<h3 id="z-systems">15.5.9 z Systems</h3>
<h2 id="where-is-memory-ordering-needed">15.6 Where is Memory Ordering Needed?</h2>
<h1 id="ease-of-use">16 Ease of Use</h1>
<h2 id="what-is-easy">16.1 What is Easy?</h2>
<h2 id="rusty-scale-for-api-design">16.2 Rusty Scale for API Design</h2>
<h2 id="shaving-the-mandelbrot-set">16.3 Shaving the Mandelbrot Set</h2>
<h1 id="conflicting-visions-of-the-future">17 Conflicting Visions of the Future</h1>
<h2 id="the-future-of-cpu-technology-aint-what-it-used-to-be">17.1 The Future of CPU Technology Ain't What it Used to Be</h2>
<h3 id="uniprocessor-über-alles">17.1.1 Uniprocessor Über Alles</h3>
<h3 id="multithreaded-mania">17.1.2 Multithreaded Mania</h3>
<h3 id="more-of-the-same">17.1.3 More of the Same</h3>
<h3 id="crash-dummies-slamming-into-the-memory-wall">17.1.4 Crash Dummies Slamming into the Memory Wall</h3>
<h3 id="astounding-accelerators">17.1.5 Astounding Accelerators</h3>
<h2 id="transactional-memory">17.2 Transactional Memory</h2>
<h3 id="outside-world">17.2.1 Outside World</h3>
<h3 id="process-modification">17.2.2 Process Modification</h3>
<h3 id="synchronization">17.2.3 Synchronization</h3>
<h3 id="discussion-2">17.2.4 Discussion</h3>
<h2 id="hardware-transactional-memory">17.3 Hardware Transactional Memory</h2>
<h3 id="htm-benefits-wrt-locking">17.3.1 HTM Benefits WRT Locking</h3>
<h3 id="htm-weaknesses-wrt-locking">17.3.2 HTM Weaknesses WRT Locking</h3>
<h3 id="htm-weaknesses-wrt-locking-when-augmented">17.3.3 HTM Weaknesses WRT Locking When Augmented</h3>
<h3 id="where-does-htm-best-fit-in">17.3.4 Where Does HTM Best Fit In?</h3>
<h3 id="potential-game-changers">17.3.5 Potential Game Changers</h3>
<h3 id="conclusions">17.3.6 Conclusions</h3>
<h2 id="formal-regression-testing">17.4 Formal Regression Testing?</h2>
<h3 id="automatic-translation">17.4.1 Automatic Translation</h3>
<h3 id="environment">17.4.2 Environment</h3>
<h3 id="overhead">17.4.3 Overhead</h3>
<h3 id="locate-bugs">17.4.4 Locate Bugs</h3>
<h3 id="minimal-scaffolding">17.4.5 Minimal Scaffolding</h3>
<h3 id="relevant-bugs">17.4.6 Relevant Bugs</h3>
<h3 id="formal-regression-scorecard">17.4.7 Formal Regression Scorecard</h3>
<h2 id="functional-programming-for-parallelism">17.5 Functional Programming for Parallelism</h2>
<h2 id="summary-4">17.6 Summary</h2>
<h1 id="looking-forward-and-back">18 Looking Forward and Back</h1>
<h1 id="a-important-questions">A Important Questions</h1>
<h2 id="a.1-why-arent-parallel-programs-always-faster">A.1 Why Aren't Parallel Programs Always Faster?</h2>
<h2 id="a.2-why-not-remove-locking">A.2 Why Not Remove Locking?</h2>
<h2 id="a.3-what-time-is-it">A.3 What Time Is It?</h2>
<h2 id="a.4-what-does-after-mean">A.4 What Does ``After'' Mean?</h2>
<h2 id="a.5-how-much-ordering-is-needed">A.5 How Much Ordering Is Needed?</h2>
<h3 id="a.5.1-where-is-the-defining-data">A.5.1 Where is the Defining Data?</h3>
<h3 id="a.5.2-consistent-data-used-consistently">A.5.2 Consistent Data Used Consistently?</h3>
<h3 id="a.5.3-is-the-problem-partitionable">A.5.3 Is the Problem Partitionable?</h3>
<h3 id="a.5.4-none-of-the-above">A.5.4 None of the Above?</h3>
<h2 id="a.6-what-is-the-difference-between-concurrent-and-parallel">A.6 What is the Difference Between ''Concurrent'' and ''Parallel''?</h2>
<h2 id="a.7-why-is-software-buggy">A.7 Why Is Software Buggy?</h2>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2023/03/195fa7ee015e.html">https://sinos_wei.gitee.io/2023/03/195fa7ee015e.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/locking/">locking</a><a class="post-meta__tags" href="/tags/parallel/">parallel</a><a class="post-meta__tags" href="/tags/counting/">counting</a><a class="post-meta__tags" href="/tags/discussion/">discussion</a><a class="post-meta__tags" href="/tags/limit/">limit</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/78.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/05/1d8ca121605c.html" title="计算机网络"><img class="cover" src="/img/cover/17.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">计算机网络</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/02c3819a68a7.html" title="go"><img class="cover" src="/img/cover/79.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">go</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">191</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SinosGray"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/SinosGray" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://8.130.42.149:5230" target="_blank" title="memo"><i class="fab fa-heart"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#how-to-use-this-book"><span class="toc-number">1.</span> <span class="toc-text">1 How To Use This Book</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#roadmap"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 Roadmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#quick-quizzes"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Quick Quizzes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#alternatives-to-this-book"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 Alternatives to This Book</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sample-source-code"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 Sample Source Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#whose-book-is-this"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 Whose Book Is This?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#introduction"><span class="toc-number">2.</span> <span class="toc-text">2 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#historic-parallel-programming-difficulties"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 Historic Parallel Programming Difficulties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parallel-programming-goals"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Parallel Programming Goals</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#performance"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#productivity"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 Productivity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generality"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 Generality</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#alternatives-to-parallel-programming"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Alternatives to Parallel Programming</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#multiple-instances-of-a-sequential-application"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 Multiple Instances of a Sequential Application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#use-existing-parallel-software"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 Use Existing Parallel Software</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#performance-optimization"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.3 Performance Optimization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#what-makes-parallel-programming-hard"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 What Makes Parallel Programming Hard?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#work-partitioning"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 Work Partitioning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-access-control"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 Parallel Access Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resource-partitioning-and-replication"><span class="toc-number">2.4.3.</span> <span class="toc-text">2.4.3 Resource Partitioning and Replication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#interacting-with-hardware"><span class="toc-number">2.4.4.</span> <span class="toc-text">2.4.4 Interacting With Hardware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#composite-capabilities"><span class="toc-number">2.4.5.</span> <span class="toc-text">2.4.5 Composite Capabilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#how-do-languages-and-environments-assist-with-these-tasks"><span class="toc-number">2.4.6.</span> <span class="toc-text">2.4.6 How Do Languages and Environments Assist With These Tasks?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#discussion"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 Discussion</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hardware-and-its-habits"><span class="toc-number">3.</span> <span class="toc-text">3 Hardware and its Habits</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#overview"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pipelined-cpus"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 Pipelined CPUs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#memory-references"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 Memory References</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-operations"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 Atomic Operations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#memory-barriers"><span class="toc-number">3.1.4.</span> <span class="toc-text">3.1.4 Memory Barriers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cache-misses"><span class="toc-number">3.1.5.</span> <span class="toc-text">3.1.5 Cache Misses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-operations"><span class="toc-number">3.1.6.</span> <span class="toc-text">3.1.6 I&#x2F;O Operations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#overheads"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 Overheads</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hardware-system-architecture"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 Hardware System Architecture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#costs-of-operations"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 Costs of Operations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hardware-optimizations"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3 Hardware Optimizations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hardware-free-lunch"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 Hardware Free Lunch?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#d-integration"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 3D Integration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#novel-materials-and-processes"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2 Novel Materials and Processes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#light-not-electrons"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3 Light, Not Electrons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#special-purpose-accelerators"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.3.4 Special-Purpose Accelerators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#existing-parallel-software"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.3.5 Existing Parallel Software</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#software-design-implications"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 Software Design Implications</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tools-of-the-trade"><span class="toc-number">4.</span> <span class="toc-text">4 Tools of the Trade</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#scripting-languages"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 Scripting Languages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#posix-multiprocessing"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 POSIX Multiprocessing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#posix-process-creation-and-destruction"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 POSIX Process Creation and Destruction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#posix-thread-creation-and-destruction"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 POSIX Thread Creation and Destruction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#posix-locking"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3 POSIX Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#posix-reader-writer-locking"><span class="toc-number">4.2.4.</span> <span class="toc-text">4.2.4 POSIX Reader-Writer Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-operations-gcc-classic"><span class="toc-number">4.2.5.</span> <span class="toc-text">4.2.5 Atomic Operations (GCC Classic)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-operations-c11"><span class="toc-number">4.2.6.</span> <span class="toc-text">4.2.6 Atomic Operations (C11)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-operations-modern-gcc"><span class="toc-number">4.2.7.</span> <span class="toc-text">4.2.7 Atomic Operations (Modern GCC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#per-thread-variables"><span class="toc-number">4.2.8.</span> <span class="toc-text">4.2.8 Per-Thread Variables</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#alternatives-to-posix-operations"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 Alternatives to POSIX Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#organization-and-initialization"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1 Organization and Initialization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#thread-creation-destruction-and-control"><span class="toc-number">4.3.2.</span> <span class="toc-text">4.3.2 Thread Creation, Destruction, and Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locking"><span class="toc-number">4.3.3.</span> <span class="toc-text">4.3.3 Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#accessing-shared-variables"><span class="toc-number">4.3.4.</span> <span class="toc-text">4.3.4 Accessing Shared Variables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-operations-1"><span class="toc-number">4.3.5.</span> <span class="toc-text">4.3.5 Atomic Operations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#per-cpu-variables"><span class="toc-number">4.3.6.</span> <span class="toc-text">4.3.6 Per-CPU Variables</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-right-tool-for-the-job-how-to-choose"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 The Right Tool for the Job: How to Choose?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#counting"><span class="toc-number">5.</span> <span class="toc-text">5 Counting</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#why-isnt-concurrent-counting-trivial"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Why Isn&#39;t Concurrent Counting Trivial?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#statistical-counters"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 Statistical Counters</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#design"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 Design</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#array-based-implementation"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 Array-Based Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#per-thread-variable-based-implementation"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.2.3 Per-Thread-Variable-Based Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eventually-consistent-implementation"><span class="toc-number">5.2.4.</span> <span class="toc-text">5.2.4 Eventually Consistent Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discussion-1"><span class="toc-number">5.2.5.</span> <span class="toc-text">5.2.5 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#approximate-limit-counters"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 Approximate Limit Counters</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#design-1"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1 Design</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-limit-counter-implementation"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2 Simple Limit Counter Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-limit-counter-discussion"><span class="toc-number">5.3.3.</span> <span class="toc-text">5.3.3 Simple Limit Counter Discussion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#approximate-limit-counter-implementation"><span class="toc-number">5.3.4.</span> <span class="toc-text">5.3.4 Approximate Limit Counter Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#approximate-limit-counter-discussion"><span class="toc-number">5.3.5.</span> <span class="toc-text">5.3.5 Approximate Limit Counter Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exact-limit-counters"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 Exact Limit Counters</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-limit-counter-implementation"><span class="toc-number">5.4.1.</span> <span class="toc-text">5.4.1 Atomic Limit Counter Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-limit-counter-discussion"><span class="toc-number">5.4.2.</span> <span class="toc-text">5.4.2 Atomic Limit Counter Discussion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signal-theft-limit-counter-design"><span class="toc-number">5.4.3.</span> <span class="toc-text">5.4.3 Signal-Theft Limit Counter Design</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signal-theft-limit-counter-implementation"><span class="toc-number">5.4.4.</span> <span class="toc-text">5.4.4 Signal-Theft Limit Counter Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signal-theft-limit-counter-discussion"><span class="toc-number">5.4.5.</span> <span class="toc-text">5.4.5 Signal-Theft Limit Counter Discussion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applying-exact-limit-counters"><span class="toc-number">5.4.6.</span> <span class="toc-text">5.4.6 Applying Exact Limit Counters</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parallel-counting-discussion"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 Parallel Counting Discussion</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-counting-validation"><span class="toc-number">5.5.1.</span> <span class="toc-text">5.5.1 Parallel Counting Validation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-counting-performance"><span class="toc-number">5.5.2.</span> <span class="toc-text">5.5.2 Parallel Counting Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-counting-specializations"><span class="toc-number">5.5.3.</span> <span class="toc-text">5.5.3 Parallel Counting Specializations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parallel-counting-lessons"><span class="toc-number">5.5.4.</span> <span class="toc-text">5.5.4 Parallel Counting Lessons</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#partitioning-and-synchronization-design"><span class="toc-number">6.</span> <span class="toc-text">6 Partitioning and Synchronization Design</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#partitioning-exercises"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 Partitioning Exercises</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dining-philosophers-problem"><span class="toc-number">6.1.1.</span> <span class="toc-text">6.1.1 Dining Philosophers Problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#double-ended-queue"><span class="toc-number">6.1.2.</span> <span class="toc-text">6.1.2 Double-Ended Queue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#partitioning-example-discussion"><span class="toc-number">6.1.3.</span> <span class="toc-text">6.1.3 Partitioning Example Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#design-criteria"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 Design Criteria</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#synchronization-granularity"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 Synchronization Granularity</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sequential-program"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1 Sequential Program</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-locking"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2 Code Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-locking"><span class="toc-number">6.3.3.</span> <span class="toc-text">6.3.3 Data Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-ownership"><span class="toc-number">6.3.4.</span> <span class="toc-text">6.3.4 Data Ownership</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locking-granularity-and-performance"><span class="toc-number">6.3.5.</span> <span class="toc-text">6.3.5 Locking Granularity and Performance</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parallel-fastpath"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 Parallel Fastpath</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#readerwriter-locking"><span class="toc-number">6.4.1.</span> <span class="toc-text">6.4.1 Reader&#x2F;Writer Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hierarchical-locking"><span class="toc-number">6.4.2.</span> <span class="toc-text">6.4.2 Hierarchical Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resource-allocator-caches"><span class="toc-number">6.4.3.</span> <span class="toc-text">6.4.3 Resource Allocator Caches</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#beyond-partitioning"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 Beyond Partitioning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#work-queue-parallel-maze-solver"><span class="toc-number">6.5.1.</span> <span class="toc-text">6.5.1 Work-Queue Parallel Maze Solver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#alternative-parallel-maze-solver"><span class="toc-number">6.5.2.</span> <span class="toc-text">6.5.2 Alternative Parallel Maze Solver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#maze-validation"><span class="toc-number">6.5.3.</span> <span class="toc-text">6.5.3 Maze Validation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#performance-comparison-i"><span class="toc-number">6.5.4.</span> <span class="toc-text">6.5.4 Performance Comparison I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#alternative-sequential-maze-solver"><span class="toc-number">6.5.5.</span> <span class="toc-text">6.5.5 Alternative Sequential Maze Solver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#performance-comparison-ii"><span class="toc-number">6.5.6.</span> <span class="toc-text">6.5.6 Performance Comparison II</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#future-directions-and-conclusions"><span class="toc-number">6.5.7.</span> <span class="toc-text">6.5.7 Future Directions and Conclusions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#partitioning-parallelism-and-optimization"><span class="toc-number">6.6.</span> <span class="toc-text">6.6 Partitioning, Parallelism, and Optimization</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#locking-1"><span class="toc-number">7.</span> <span class="toc-text">7 Locking</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#staying-alive"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 Staying Alive</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#deadlock"><span class="toc-number">7.1.1.</span> <span class="toc-text">7.1.1 Deadlock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#livelock-and-starvation"><span class="toc-number">7.1.2.</span> <span class="toc-text">7.1.2 Livelock and Starvation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unfairness"><span class="toc-number">7.1.3.</span> <span class="toc-text">7.1.3 Unfairness</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inefficiency"><span class="toc-number">7.1.4.</span> <span class="toc-text">7.1.4 Inefficiency</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#types-of-locks"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 Types of Locks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exclusive-locks"><span class="toc-number">7.2.1.</span> <span class="toc-text">7.2.1 Exclusive Locks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reader-writer-locks"><span class="toc-number">7.2.2.</span> <span class="toc-text">7.2.2 Reader-Writer Locks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beyond-reader-writer-locks"><span class="toc-number">7.2.3.</span> <span class="toc-text">7.2.3 Beyond Reader-Writer Locks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scoped-locking"><span class="toc-number">7.2.4.</span> <span class="toc-text">7.2.4 Scoped Locking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#locking-implementation-issues"><span class="toc-number">7.3.</span> <span class="toc-text">7.3 Locking Implementation Issues</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sample-exclusive-locking-implementation-based-on-atomic-exchange"><span class="toc-number">7.3.1.</span> <span class="toc-text">7.3.1 Sample Exclusive-Locking Implementation Based on Atomic Exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#other-exclusive-locking-implementations"><span class="toc-number">7.3.2.</span> <span class="toc-text">7.3.2 Other Exclusive-Locking Implementations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lock-based-existence-guarantees"><span class="toc-number">7.4.</span> <span class="toc-text">7.4 Lock-Based Existence Guarantees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#locking-hero-or-villain"><span class="toc-number">7.5.</span> <span class="toc-text">7.5 Locking: Hero or Villain?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#locking-for-applications-hero"><span class="toc-number">7.5.1.</span> <span class="toc-text">7.5.1 Locking For Applications: Hero!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locking-for-parallel-libraries-just-another-tool"><span class="toc-number">7.5.2.</span> <span class="toc-text">7.5.2 Locking For Parallel Libraries: Just Another Tool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locking-for-parallelizing-sequential-libraries-villain"><span class="toc-number">7.5.3.</span> <span class="toc-text">7.5.3 Locking For Parallelizing Sequential Libraries: Villain!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">7.6.</span> <span class="toc-text">7.6 Summary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#data-ownership-1"><span class="toc-number">8.</span> <span class="toc-text">8 Data Ownership</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#multiple-processes"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 Multiple Processes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#partial-data-ownership-and-pthreads"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 Partial Data Ownership and pthreads</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#function-shipping"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 Function Shipping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#designated-thread"><span class="toc-number">8.4.</span> <span class="toc-text">8.4 Designated Thread</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#privatization"><span class="toc-number">8.5.</span> <span class="toc-text">8.5 Privatization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#other-uses-of-data-ownership"><span class="toc-number">8.6.</span> <span class="toc-text">8.6 Other Uses of Data Ownership</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#deferred-processing"><span class="toc-number">9.</span> <span class="toc-text">9 Deferred Processing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#running-example"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 Running Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-counting"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 Reference Counting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hazard-pointers"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 Hazard Pointers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sequence-locks"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 Sequence Locks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#read-copy-update-rcu"><span class="toc-number">9.5.</span> <span class="toc-text">9.5 Read-Copy Update (RCU)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#introduction-to-rcu"><span class="toc-number">9.5.1.</span> <span class="toc-text">9.5.1 Introduction to RCU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-fundamentals"><span class="toc-number">9.5.2.</span> <span class="toc-text">9.5.2 RCU Fundamentals</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-linux-kernel-api"><span class="toc-number">9.5.3.</span> <span class="toc-text">9.5.3 RCU Linux-Kernel API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-usage"><span class="toc-number">9.5.4.</span> <span class="toc-text">9.5.4 RCU Usage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-related-work"><span class="toc-number">9.5.5.</span> <span class="toc-text">9.5.5 RCU Related Work</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#which-to-choose"><span class="toc-number">9.6.</span> <span class="toc-text">9.6 Which to Choose?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#which-to-choose-overview"><span class="toc-number">9.6.1.</span> <span class="toc-text">9.6.1 Which to Choose? (Overview)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#which-to-choose-details"><span class="toc-number">9.6.2.</span> <span class="toc-text">9.6.2 Which to Choose? (Details)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#which-to-choose-production-use"><span class="toc-number">9.6.3.</span> <span class="toc-text">9.6.3 Which to Choose? (Production Use)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#what-about-updates"><span class="toc-number">9.7.</span> <span class="toc-text">9.7 What About Updates?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#data-structures"><span class="toc-number">10.</span> <span class="toc-text">10 Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#motivating-application"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 Motivating Application</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#partitionable-data-structures"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 Partitionable Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-table-design"><span class="toc-number">10.2.1.</span> <span class="toc-text">10.2.1 Hash-Table Design</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-table-implementation"><span class="toc-number">10.2.2.</span> <span class="toc-text">10.2.2 Hash-Table Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-table-performance"><span class="toc-number">10.2.3.</span> <span class="toc-text">10.2.3 Hash-Table Performance</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#read-mostly-data-structures"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 Read-Mostly Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-protected-hash-table-implementation"><span class="toc-number">10.3.1.</span> <span class="toc-text">10.3.1 RCU-Protected Hash Table Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-protected-hash-table-validation"><span class="toc-number">10.3.2.</span> <span class="toc-text">10.3.2 RCU-Protected Hash Table Validation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-protected-hash-table-performance"><span class="toc-number">10.3.3.</span> <span class="toc-text">10.3.3 RCU-Protected Hash Table Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-protected-hash-table-discussion"><span class="toc-number">10.3.4.</span> <span class="toc-text">10.3.4 RCU-Protected Hash Table Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#non-partitionable-data-structures"><span class="toc-number">10.4.</span> <span class="toc-text">10.4 Non-Partitionable Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#resizable-hash-table-design"><span class="toc-number">10.4.1.</span> <span class="toc-text">10.4.1 Resizable Hash Table Design</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resizable-hash-table-implementation"><span class="toc-number">10.4.2.</span> <span class="toc-text">10.4.2 Resizable Hash Table Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resizable-hash-table-discussion"><span class="toc-number">10.4.3.</span> <span class="toc-text">10.4.3 Resizable Hash Table Discussion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#other-resizable-hash-tables"><span class="toc-number">10.4.4.</span> <span class="toc-text">10.4.4 Other Resizable Hash Tables</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#other-data-structures"><span class="toc-number">10.5.</span> <span class="toc-text">10.5 Other Data Structures</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#micro-optimization"><span class="toc-number">10.6.</span> <span class="toc-text">10.6 Micro-Optimization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#specialization"><span class="toc-number">10.6.1.</span> <span class="toc-text">10.6.1 Specialization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bits-and-bytes"><span class="toc-number">10.6.2.</span> <span class="toc-text">10.6.2 Bits and Bytes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hardware-considerations"><span class="toc-number">10.6.3.</span> <span class="toc-text">10.6.3 Hardware Considerations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-1"><span class="toc-number">10.7.</span> <span class="toc-text">10.7 Summary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#validation"><span class="toc-number">11.</span> <span class="toc-text">11 Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-1"><span class="toc-number">11.1.</span> <span class="toc-text">11.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#where-do-bugs-come-from"><span class="toc-number">11.1.1.</span> <span class="toc-text">11.1.1 Where Do Bugs Come From?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#required-mindset"><span class="toc-number">11.1.2.</span> <span class="toc-text">11.1.2 Required Mindset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#when-should-validation-start"><span class="toc-number">11.1.3.</span> <span class="toc-text">11.1.3 When Should Validation Start?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-open-source-way"><span class="toc-number">11.1.4.</span> <span class="toc-text">11.1.4 The Open Source Way</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tracing"><span class="toc-number">11.2.</span> <span class="toc-text">11.2 Tracing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#assertions"><span class="toc-number">11.3.</span> <span class="toc-text">11.3 Assertions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#static-analysis"><span class="toc-number">11.4.</span> <span class="toc-text">11.4 Static Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#code-review"><span class="toc-number">11.5.</span> <span class="toc-text">11.5 Code Review</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inspection"><span class="toc-number">11.5.1.</span> <span class="toc-text">11.5.1 Inspection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#walkthroughs"><span class="toc-number">11.5.2.</span> <span class="toc-text">11.5.2 Walkthroughs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#self-inspection"><span class="toc-number">11.5.3.</span> <span class="toc-text">11.5.3 Self-Inspection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#probability-and-heisenbugs"><span class="toc-number">11.6.</span> <span class="toc-text">11.6 Probability and Heisenbugs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#statistics-for-discrete-testing"><span class="toc-number">11.6.1.</span> <span class="toc-text">11.6.1 Statistics for Discrete Testing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#statistics-abuse-for-discrete-testing"><span class="toc-number">11.6.2.</span> <span class="toc-text">11.6.2 Statistics Abuse for Discrete Testing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#statistics-for-continuous-testing"><span class="toc-number">11.6.3.</span> <span class="toc-text">11.6.3 Statistics for Continuous Testing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hunting-heisenbugs"><span class="toc-number">11.6.4.</span> <span class="toc-text">11.6.4 Hunting Heisenbugs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#performance-estimation"><span class="toc-number">11.7.</span> <span class="toc-text">11.7 Performance Estimation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#benchmarking"><span class="toc-number">11.7.1.</span> <span class="toc-text">11.7.1 Benchmarking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#profiling"><span class="toc-number">11.7.2.</span> <span class="toc-text">11.7.2 Profiling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#differential-profiling"><span class="toc-number">11.7.3.</span> <span class="toc-text">11.7.3 Differential Profiling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#microbenchmarking"><span class="toc-number">11.7.4.</span> <span class="toc-text">11.7.4 Microbenchmarking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isolation"><span class="toc-number">11.7.5.</span> <span class="toc-text">11.7.5 Isolation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#detecting-interference"><span class="toc-number">11.7.6.</span> <span class="toc-text">11.7.6 Detecting Interference</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-2"><span class="toc-number">11.8.</span> <span class="toc-text">11.8 Summary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#formal-verification"><span class="toc-number">12.</span> <span class="toc-text">12 Formal Verification</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#state-space-search"><span class="toc-number">12.1.</span> <span class="toc-text">12.1 State-Space Search</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#promela-and-spin"><span class="toc-number">12.1.1.</span> <span class="toc-text">12.1.1 Promela and Spin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#how-to-use-promela"><span class="toc-number">12.1.2.</span> <span class="toc-text">12.1.2 How to Use Promela</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#promela-example-locking"><span class="toc-number">12.1.3.</span> <span class="toc-text">12.1.3 Promela Example: Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#promela-example-qrcu"><span class="toc-number">12.1.4.</span> <span class="toc-text">12.1.4 Promela Example: QRCU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#promela-parable-dynticks-and-preemptible-rcu"><span class="toc-number">12.1.5.</span> <span class="toc-text">12.1.5 Promela Parable: dynticks and Preemptible RCU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#validating-preemptible-rcu-and-dynticks"><span class="toc-number">12.1.6.</span> <span class="toc-text">12.1.6 Validating Preemptible RCU and dynticks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#special-purpose-state-space-search"><span class="toc-number">12.2.</span> <span class="toc-text">12.2 Special-Purpose State-Space Search</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#anatomy-of-a-litmus-test"><span class="toc-number">12.2.1.</span> <span class="toc-text">12.2.1 Anatomy of a Litmus Test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#what-does-this-litmus-test-mean"><span class="toc-number">12.2.2.</span> <span class="toc-text">12.2.2 What Does This Litmus Test Mean?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#running-a-litmus-test"><span class="toc-number">12.2.3.</span> <span class="toc-text">12.2.3 Running a Litmus Test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ppcmem-discussion"><span class="toc-number">12.2.4.</span> <span class="toc-text">12.2.4 PPCMEM Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axiomatic-approaches"><span class="toc-number">12.3.</span> <span class="toc-text">12.3 Axiomatic Approaches</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#axiomatic-approaches-and-locking"><span class="toc-number">12.3.1.</span> <span class="toc-text">12.3.1 Axiomatic Approaches and Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#axiomatic-approaches-and-rcu"><span class="toc-number">12.3.2.</span> <span class="toc-text">12.3.2 Axiomatic Approaches and RCU</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sat-solvers"><span class="toc-number">12.4.</span> <span class="toc-text">12.4 SAT Solvers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stateless-model-checkers"><span class="toc-number">12.5.</span> <span class="toc-text">12.5 Stateless Model Checkers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-3"><span class="toc-number">12.6.</span> <span class="toc-text">12.6 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#choosing-a-validation-plan"><span class="toc-number">12.7.</span> <span class="toc-text">12.7 Choosing a Validation Plan</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#putting-it-all-together"><span class="toc-number">13.</span> <span class="toc-text">13 Putting It All Together</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#counter-conundrums"><span class="toc-number">13.1.</span> <span class="toc-text">13.1 Counter Conundrums</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#counting-updates"><span class="toc-number">13.1.1.</span> <span class="toc-text">13.1.1 Counting Updates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#counting-lookups"><span class="toc-number">13.1.2.</span> <span class="toc-text">13.1.2 Counting Lookups</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#refurbish-reference-counting"><span class="toc-number">13.2.</span> <span class="toc-text">13.2 Refurbish Reference Counting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#implementation-of-reference-counting-categories"><span class="toc-number">13.2.1.</span> <span class="toc-text">13.2.1 Implementation of Reference-Counting Categories</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#counter-optimizations"><span class="toc-number">13.2.2.</span> <span class="toc-text">13.2.2 Counter Optimizations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hazard-pointer-helpers"><span class="toc-number">13.3.</span> <span class="toc-text">13.3 Hazard-Pointer Helpers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#scalable-reference-count"><span class="toc-number">13.3.1.</span> <span class="toc-text">13.3.1 Scalable Reference Count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#long-duration-accesses"><span class="toc-number">13.3.2.</span> <span class="toc-text">13.3.2 Long-Duration Accesses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sequence-locking-specials"><span class="toc-number">13.4.</span> <span class="toc-text">13.4 Sequence-Locking Specials</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dueling-sequence-locks"><span class="toc-number">13.4.1.</span> <span class="toc-text">13.4.1 Dueling Sequence Locks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#correlated-data-elements"><span class="toc-number">13.4.2.</span> <span class="toc-text">13.4.2 Correlated Data Elements</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atomic-move"><span class="toc-number">13.4.3.</span> <span class="toc-text">13.4.3 Atomic Move</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#upgrade-to-writer"><span class="toc-number">13.4.4.</span> <span class="toc-text">13.4.4 Upgrade to Writer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rcu-rescues"><span class="toc-number">13.5.</span> <span class="toc-text">13.5 RCU Rescues</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-and-per-thread-variable-based-statistical-counters"><span class="toc-number">13.5.1.</span> <span class="toc-text">13.5.1 RCU and Per-Thread-Variable-Based Statistical Counters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu-and-counters-for-removable-io-devices"><span class="toc-number">13.5.2.</span> <span class="toc-text">13.5.2 RCU and Counters for Removable I&#x2F;O Devices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#array-and-length"><span class="toc-number">13.5.3.</span> <span class="toc-text">13.5.3 Array and Length</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#correlated-fields"><span class="toc-number">13.5.4.</span> <span class="toc-text">13.5.4 Correlated Fields</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#update-friendly-traversal"><span class="toc-number">13.5.5.</span> <span class="toc-text">13.5.5 Update-Friendly Traversal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scalable-reference-count-two"><span class="toc-number">13.5.6.</span> <span class="toc-text">13.5.6 Scalable Reference Count Two</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#retriggered-grace-periods"><span class="toc-number">13.5.7.</span> <span class="toc-text">13.5.7 Retriggered Grace Periods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#long-duration-accesses-two"><span class="toc-number">13.5.8.</span> <span class="toc-text">13.5.8 Long-Duration Accesses Two</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#advanced-synchronization"><span class="toc-number">14.</span> <span class="toc-text">14 Advanced Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#avoiding-locks"><span class="toc-number">14.1.</span> <span class="toc-text">14.1 Avoiding Locks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#non-blocking-synchronization"><span class="toc-number">14.2.</span> <span class="toc-text">14.2 Non-Blocking Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-nbs"><span class="toc-number">14.2.1.</span> <span class="toc-text">14.2.1 Simple NBS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applicability-of-nbs-benefits"><span class="toc-number">14.2.2.</span> <span class="toc-text">14.2.2 Applicability of NBS Benefits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nbs-discussion"><span class="toc-number">14.2.3.</span> <span class="toc-text">14.2.3 NBS Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parallel-real-time-computing"><span class="toc-number">14.3.</span> <span class="toc-text">14.3 Parallel Real-Time Computing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#what-is-real-time-computing"><span class="toc-number">14.3.1.</span> <span class="toc-text">14.3.1 What is Real-Time Computing?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#who-needs-real-time"><span class="toc-number">14.3.2.</span> <span class="toc-text">14.3.2 Who Needs Real-Time?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#who-needs-parallel-real-time"><span class="toc-number">14.3.3.</span> <span class="toc-text">14.3.3 Who Needs Parallel Real-Time?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#implementing-parallel-real-time-systems"><span class="toc-number">14.3.4.</span> <span class="toc-text">14.3.4 Implementing Parallel Real-Time Systems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#implementing-parallel-real-time-operating-systems"><span class="toc-number">14.3.5.</span> <span class="toc-text">14.3.5 Implementing Parallel Real-Time Operating Systems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#implementing-parallel-real-time-applications"><span class="toc-number">14.3.6.</span> <span class="toc-text">14.3.6 Implementing Parallel Real-Time Applications</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#real-time-vs.-real-fast-how-to-choose"><span class="toc-number">14.3.6.1.</span> <span class="toc-text">14.3.7 Real Time vs. Real Fast: How to Choose?</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#advanced-synchronization-memory-ordering"><span class="toc-number">15.</span> <span class="toc-text">15 Advanced Synchronization: Memory Ordering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ordering-why-and-how"><span class="toc-number">15.1.</span> <span class="toc-text">15.1 Ordering: Why and How?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#why-hardware-misordering"><span class="toc-number">15.1.1.</span> <span class="toc-text">15.1.1 Why Hardware Misordering?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#how-to-force-ordering"><span class="toc-number">15.1.2.</span> <span class="toc-text">15.1.2 How to Force Ordering?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic-rules-of-thumb"><span class="toc-number">15.1.3.</span> <span class="toc-text">15.1.3 Basic Rules of Thumb</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tricks-and-traps"><span class="toc-number">15.2.</span> <span class="toc-text">15.2 Tricks and Traps</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#variables-with-multiple-values"><span class="toc-number">15.2.1.</span> <span class="toc-text">15.2.1 Variables With Multiple Values</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#memory-reference-reordering"><span class="toc-number">15.2.2.</span> <span class="toc-text">15.2.2 Memory-Reference Reordering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#address-dependencies"><span class="toc-number">15.2.3.</span> <span class="toc-text">15.2.3 Address Dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-dependencies"><span class="toc-number">15.2.4.</span> <span class="toc-text">15.2.4 Data Dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#control-dependencies"><span class="toc-number">15.2.5.</span> <span class="toc-text">15.2.5 Control Dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cache-coherence"><span class="toc-number">15.2.6.</span> <span class="toc-text">15.2.6 Cache Coherence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicopy-atomicity"><span class="toc-number">15.2.7.</span> <span class="toc-text">15.2.7 Multicopy Atomicity</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compile-time-consternation"><span class="toc-number">15.3.</span> <span class="toc-text">15.3 Compile-Time Consternation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#memory-reference-restrictions"><span class="toc-number">15.3.1.</span> <span class="toc-text">15.3.1 Memory-Reference Restrictions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#address--and-data-dependency-difficulties"><span class="toc-number">15.3.2.</span> <span class="toc-text">15.3.2 Address- and Data-Dependency Difficulties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#control-dependency-calamities"><span class="toc-number">15.3.3.</span> <span class="toc-text">15.3.3 Control-Dependency Calamities</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#higher-level-primitives"><span class="toc-number">15.4.</span> <span class="toc-text">15.4 Higher-Level Primitives</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#memory-allocation"><span class="toc-number">15.4.1.</span> <span class="toc-text">15.4.1 Memory Allocation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locking-2"><span class="toc-number">15.4.2.</span> <span class="toc-text">15.4.2 Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcu"><span class="toc-number">15.4.3.</span> <span class="toc-text">15.4.3 RCU</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hardware-specifics"><span class="toc-number">15.5.</span> <span class="toc-text">15.5 Hardware Specifics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#alpha"><span class="toc-number">15.5.1.</span> <span class="toc-text">15.5.1 Alpha</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#armv7-ar"><span class="toc-number">15.5.2.</span> <span class="toc-text">15.5.2 Armv7-A&#x2F;R</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#armv8"><span class="toc-number">15.5.3.</span> <span class="toc-text">15.5.3 Armv8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#itanium"><span class="toc-number">15.5.4.</span> <span class="toc-text">15.5.4 Itanium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mips"><span class="toc-number">15.5.5.</span> <span class="toc-text">15.5.5 MIPS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#power-powerpc"><span class="toc-number">15.5.6.</span> <span class="toc-text">15.5.6 POWER &#x2F; PowerPC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sparc-tso"><span class="toc-number">15.5.7.</span> <span class="toc-text">15.5.7 SPARC TSO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x86"><span class="toc-number">15.5.8.</span> <span class="toc-text">15.5.8 x86</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#z-systems"><span class="toc-number">15.5.9.</span> <span class="toc-text">15.5.9 z Systems</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#where-is-memory-ordering-needed"><span class="toc-number">15.6.</span> <span class="toc-text">15.6 Where is Memory Ordering Needed?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ease-of-use"><span class="toc-number">16.</span> <span class="toc-text">16 Ease of Use</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-easy"><span class="toc-number">16.1.</span> <span class="toc-text">16.1 What is Easy?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rusty-scale-for-api-design"><span class="toc-number">16.2.</span> <span class="toc-text">16.2 Rusty Scale for API Design</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shaving-the-mandelbrot-set"><span class="toc-number">16.3.</span> <span class="toc-text">16.3 Shaving the Mandelbrot Set</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#conflicting-visions-of-the-future"><span class="toc-number">17.</span> <span class="toc-text">17 Conflicting Visions of the Future</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-future-of-cpu-technology-aint-what-it-used-to-be"><span class="toc-number">17.1.</span> <span class="toc-text">17.1 The Future of CPU Technology Ain&#39;t What it Used to Be</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#uniprocessor-%C3%BCber-alles"><span class="toc-number">17.1.1.</span> <span class="toc-text">17.1.1 Uniprocessor Über Alles</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multithreaded-mania"><span class="toc-number">17.1.2.</span> <span class="toc-text">17.1.2 Multithreaded Mania</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#more-of-the-same"><span class="toc-number">17.1.3.</span> <span class="toc-text">17.1.3 More of the Same</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crash-dummies-slamming-into-the-memory-wall"><span class="toc-number">17.1.4.</span> <span class="toc-text">17.1.4 Crash Dummies Slamming into the Memory Wall</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#astounding-accelerators"><span class="toc-number">17.1.5.</span> <span class="toc-text">17.1.5 Astounding Accelerators</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transactional-memory"><span class="toc-number">17.2.</span> <span class="toc-text">17.2 Transactional Memory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#outside-world"><span class="toc-number">17.2.1.</span> <span class="toc-text">17.2.1 Outside World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#process-modification"><span class="toc-number">17.2.2.</span> <span class="toc-text">17.2.2 Process Modification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#synchronization"><span class="toc-number">17.2.3.</span> <span class="toc-text">17.2.3 Synchronization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discussion-2"><span class="toc-number">17.2.4.</span> <span class="toc-text">17.2.4 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hardware-transactional-memory"><span class="toc-number">17.3.</span> <span class="toc-text">17.3 Hardware Transactional Memory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#htm-benefits-wrt-locking"><span class="toc-number">17.3.1.</span> <span class="toc-text">17.3.1 HTM Benefits WRT Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#htm-weaknesses-wrt-locking"><span class="toc-number">17.3.2.</span> <span class="toc-text">17.3.2 HTM Weaknesses WRT Locking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#htm-weaknesses-wrt-locking-when-augmented"><span class="toc-number">17.3.3.</span> <span class="toc-text">17.3.3 HTM Weaknesses WRT Locking When Augmented</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where-does-htm-best-fit-in"><span class="toc-number">17.3.4.</span> <span class="toc-text">17.3.4 Where Does HTM Best Fit In?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#potential-game-changers"><span class="toc-number">17.3.5.</span> <span class="toc-text">17.3.5 Potential Game Changers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#conclusions"><span class="toc-number">17.3.6.</span> <span class="toc-text">17.3.6 Conclusions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#formal-regression-testing"><span class="toc-number">17.4.</span> <span class="toc-text">17.4 Formal Regression Testing?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#automatic-translation"><span class="toc-number">17.4.1.</span> <span class="toc-text">17.4.1 Automatic Translation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#environment"><span class="toc-number">17.4.2.</span> <span class="toc-text">17.4.2 Environment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#overhead"><span class="toc-number">17.4.3.</span> <span class="toc-text">17.4.3 Overhead</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#locate-bugs"><span class="toc-number">17.4.4.</span> <span class="toc-text">17.4.4 Locate Bugs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#minimal-scaffolding"><span class="toc-number">17.4.5.</span> <span class="toc-text">17.4.5 Minimal Scaffolding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#relevant-bugs"><span class="toc-number">17.4.6.</span> <span class="toc-text">17.4.6 Relevant Bugs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#formal-regression-scorecard"><span class="toc-number">17.4.7.</span> <span class="toc-text">17.4.7 Formal Regression Scorecard</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#functional-programming-for-parallelism"><span class="toc-number">17.5.</span> <span class="toc-text">17.5 Functional Programming for Parallelism</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-4"><span class="toc-number">17.6.</span> <span class="toc-text">17.6 Summary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#looking-forward-and-back"><span class="toc-number">18.</span> <span class="toc-text">18 Looking Forward and Back</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#a-important-questions"><span class="toc-number">19.</span> <span class="toc-text">A Important Questions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a.1-why-arent-parallel-programs-always-faster"><span class="toc-number">19.1.</span> <span class="toc-text">A.1 Why Aren&#39;t Parallel Programs Always Faster?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.2-why-not-remove-locking"><span class="toc-number">19.2.</span> <span class="toc-text">A.2 Why Not Remove Locking?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.3-what-time-is-it"><span class="toc-number">19.3.</span> <span class="toc-text">A.3 What Time Is It?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.4-what-does-after-mean"><span class="toc-number">19.4.</span> <span class="toc-text">A.4 What Does &#96;&#96;After&#39;&#39; Mean?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.5-how-much-ordering-is-needed"><span class="toc-number">19.5.</span> <span class="toc-text">A.5 How Much Ordering Is Needed?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a.5.1-where-is-the-defining-data"><span class="toc-number">19.5.1.</span> <span class="toc-text">A.5.1 Where is the Defining Data?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a.5.2-consistent-data-used-consistently"><span class="toc-number">19.5.2.</span> <span class="toc-text">A.5.2 Consistent Data Used Consistently?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a.5.3-is-the-problem-partitionable"><span class="toc-number">19.5.3.</span> <span class="toc-text">A.5.3 Is the Problem Partitionable?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#a.5.4-none-of-the-above"><span class="toc-number">19.5.4.</span> <span class="toc-text">A.5.4 None of the Above?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.6-what-is-the-difference-between-concurrent-and-parallel"><span class="toc-number">19.6.</span> <span class="toc-text">A.6 What is the Difference Between &#39;&#39;Concurrent&#39;&#39; and &#39;&#39;Parallel&#39;&#39;?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a.7-why-is-software-buggy"><span class="toc-number">19.7.</span> <span class="toc-text">A.7 Why Is Software Buggy?</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/07/a6f2ba33bf73.html" title="ts js html"><img src="/img/cover/41.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ts js html"/></a><div class="content"><a class="title" href="/2023/07/a6f2ba33bf73.html" title="ts js html">ts js html</a><time datetime="2023-08-16T14:06:55.121Z" title="Updated 2023-08-16 22:06:55">2023-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/329021a6ce35.html" title="develop-exercise"><img src="/img/cover/5.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="develop-exercise"/></a><div class="content"><a class="title" href="/2023/08/329021a6ce35.html" title="develop-exercise">develop-exercise</a><time datetime="2023-08-13T07:31:19.491Z" title="Updated 2023-08-13 15:31:19">2023-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/ffc01122c09c.html" title="js-test"><img src="/img/cover/55.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js-test"/></a><div class="content"><a class="title" href="/2023/08/ffc01122c09c.html" title="js-test">js-test</a><time datetime="2023-08-13T07:17:09.250Z" title="Updated 2023-08-13 15:17:09">2023-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/724d57ab8c34.html" title="操作系统"><img src="/img/cover/110.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2023/05/724d57ab8c34.html" title="操作系统">操作系统</a><time datetime="2023-08-10T03:40:21.683Z" title="Updated 2023-08-10 11:40:21">2023-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/4df836237f4a.html" title="计算机网络总结"><img src="/img/cover/45.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机网络总结"/></a><div class="content"><a class="title" href="/2020/09/4df836237f4a.html" title="计算机网络总结">计算机网络总结</a><time datetime="2023-08-08T15:00:01.996Z" title="Updated 2023-08-08 23:00:01">2023-08-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>