<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>rust | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="rust">
<meta property="og:url" content="https://sinos_wei.gitee.io/2023/03/8e79e78184fa.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/IMG_6256.jpg">
<meta property="article:published_time" content="2023-03-03T07:26:37.000Z">
<meta property="article:modified_time" content="2023-05-26T08:21:22.943Z">
<meta property="article:author" content="Sinos">
<meta property="article:tag" content="string">
<meta property="article:tag" content="println">
<meta property="article:tag" content="let">
<meta property="article:tag" content="tuple">
<meta property="article:tag" content="self">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/IMG_6256.jpg"><link rel="shortcut icon" href="/img/cover/IMG_2242.jpg"><link rel="canonical" href="https://sinos_wei.gitee.io/2023/03/8e79e78184fa.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'rust',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-26 16:21:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cover/IMG_2242.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">156</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/IMG_6256.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Sinos_wei's blog"><span class="site-name">Sinos_wei's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">rust</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-03-03T07:26:37.000Z" title="Created 2023-03-03 15:26:37">2023-03-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-05-26T08:21:22.943Z" title="Updated 2023-05-26 16:21:22">2023-05-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/undefined/">undefined</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="rust"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>

</blockquote>
<span id="more"></span>
<h1 id="安装">安装</h1>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl --proto &#x27;=https&#x27; --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br></pre></td></tr></table></figure>
<p>检查环境变量</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export PATH=&quot;$HOME/.cargo/bin:$PATH&quot;</span><br></pre></td></tr></table></figure>
<h2 id="rust-ecosystem">rust ecosystem</h2>
<ul>
<li><code>rustc</code>: the Rust compiler which turns <code>.rs</code> files into binaries and other intermediate formats.</li>
<li><code>cargo</code>: the Rust dependency manager and build tool. Cargo knows how to download dependencies hosted on <a target="_blank" rel="noopener" href="https://crates.io/">https://crates.io</a> and it will pass them to <code>rustc</code> when building your project. Cargo also comes with a built-in test runner which is used to execute unit tests.</li>
<li><code>rustup</code>: the Rust toolchain installer and updater. This tool is used to install and update <code>rustc</code> and <code>cargo</code> when new versions of Rust is released. In addition, <code>rustup</code> can also download documentation for the standard library. You can have multiple versions of Rust installed at once and <code>rustup</code> will let you switch between them as needed.</li>
</ul>
<h2 id="hello-world">hello world</h2>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cargo new coding</span><br><span class="line">cd coding</span><br><span class="line">cargo run</span><br><span class="line">cargo test</span><br><span class="line">cargo build</span><br><span class="line">cargo build --release</span><br></pre></td></tr></table></figure>
<p>You can add dependencies for your project by editing <code>Cargo.toml</code>. When you run <code>cargo</code> commands, it will automatically download and compile missing dependencies for you.</p>
<h1 id="syntax">syntax</h1>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello,?world!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;              <span class="comment">// Program entry point</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span>: <span class="type">i32</span> = <span class="number">6</span>;  <span class="comment">// Mutable variable binding</span></span><br><span class="line">    <span class="built_in">print!</span>(<span class="string">&quot;&#123;x&#125;&quot;</span>);       <span class="comment">// Macro for printing</span></span><br><span class="line">    <span class="keyword">while</span> x != <span class="number">1</span> &#123;       <span class="comment">// No parenthesis around expression</span></span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span> &#123;  <span class="comment">// Math like in other languages</span></span><br><span class="line">            x = x / <span class="number">2</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x = <span class="number">3</span> * x + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print!</span>(<span class="string">&quot; -&gt; &#123;x&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>interger default to be i32</li>
<li>string default to be utf-8</li>
<li>var default to be immutable</li>
</ul>
<h2 id="compile-time-guarantees">compile time guarantees</h2>
<ul>
<li>No uninitialized variables.</li>
<li>No memory leaks (<em>mostly</em>, see notes).</li>
<li>No double-frees.</li>
<li>No use-after-free.</li>
<li>No <code>NULL</code> pointers.</li>
<li>No forgotten locked mutexes.</li>
<li>No data races between threads.</li>
<li>No iterator invalidation.</li>
</ul>
<h2 id="runtime-guarantees">runtime guarantees</h2>
<ul>
<li><p>No undefined behavior at runtime:</p>
<ul>
<li><p>Array access is bounds checked.</p></li>
<li><p>Integer overflow is defined.</p></li>
</ul></li>
</ul>
<h2 id="loops">loops</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">array</span> = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>];</span><br><span class="line">    <span class="built_in">print!</span>(<span class="string">&quot;Iterating over array:&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">n</span> <span class="keyword">in</span> array &#123;</span><br><span class="line">        <span class="built_in">print!</span>(<span class="string">&quot; &#123;n&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print!</span>(<span class="string">&quot;Iterating over range:&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="number">3</span> &#123;</span><br><span class="line">        <span class="built_in">print!</span>(<span class="string">&quot; &#123;&#125;&quot;</span>, array[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="iterator">iterator</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i8</span>&gt; = <span class="built_in">vec!</span>[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">iter</span> = v.<span class="title function_ invoke__">iter</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;v[0]: &#123;:?&#125;&quot;</span>, iter.<span class="title function_ invoke__">next</span>());</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;v[1]: &#123;:?&#125;&quot;</span>, iter.<span class="title function_ invoke__">next</span>());</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;v[2]: &#123;:?&#125;&quot;</span>, iter.<span class="title function_ invoke__">next</span>());</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;No more items: &#123;:?&#125;&quot;</span>, iter.<span class="title function_ invoke__">next</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="const">const</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> DIGEST_SIZE: <span class="type">usize</span> = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> ZERO: <span class="type">Option</span>&lt;<span class="type">u8</span>&gt; = <span class="title function_ invoke__">Some</span>(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">compute_digest</span>(text: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> [<span class="type">u8</span>; DIGEST_SIZE] &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">digest</span> = [ZERO.<span class="title function_ invoke__">unwrap_or</span>(<span class="number">0</span>); DIGEST_SIZE];</span><br><span class="line">    <span class="title function_ invoke__">for</span> (idx, &amp;b) <span class="keyword">in</span> text.<span class="title function_ invoke__">as_bytes</span>().<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        digest[idx % DIGEST_SIZE] = digest[idx % DIGEST_SIZE].<span class="title function_ invoke__">wrapping_add</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">    digest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">digest</span> = <span class="title function_ invoke__">compute_digest</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Digest: &#123;digest:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="static">static</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> BANNER: &amp;<span class="type">str</span> = <span class="string">&quot;Welcome to RustOS 3.14&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;BANNER&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Mention that <code>const</code> behaves semantically similar to C++’s <code>constexpr</code>.</li>
<li><code>static</code>, on the other hand, is much more similar to a <code>const</code> or mutable global variable in C++.</li>
<li>It isn’t super common that one would need a runtime evaluated constant, but it is helpful and safer than using a static.</li>
</ul>
<h2 id="shadow">shadow</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">b</span> = &amp;a;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = a + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;a&#125; &#123;b&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 1</span></span><br></pre></td></tr></table></figure>
<h2 id="types">types</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th>Types</th>
<th>Literals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Signed integers</td>
<td><code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code>, <code>isize</code></td>
<td><code>-10</code>, <code>0</code>, <code>1_000</code>, <code>123i64</code></td>
</tr>
<tr class="even">
<td>Unsigned integers</td>
<td><code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, <code>usize</code></td>
<td><code>0</code>, <code>123</code>, <code>10u16</code></td>
</tr>
<tr class="odd">
<td>Floating point numbers</td>
<td><code>f32</code>, <code>f64</code></td>
<td><code>3.14</code>, <code>-10.0e20</code>, <code>2f32</code></td>
</tr>
<tr class="even">
<td>Strings</td>
<td><code>&amp;str</code></td>
<td><code>"foo"</code>, <code>r#"\\"#</code></td>
</tr>
<tr class="odd">
<td>Unicode scalar values</td>
<td><code>char</code> 32 bit wide</td>
<td><code>'a'</code>, <code>'α'</code>, <code>'∞'</code></td>
</tr>
<tr class="even">
<td>Byte strings</td>
<td><code>&amp;[u8]</code></td>
<td><code>b"abc"</code>, <code>br#" " "#</code></td>
</tr>
<tr class="odd">
<td>Booleans</td>
<td><code>bool</code> 8 bit wide</td>
<td><code>true</code>, <code>false</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th></th>
<th>Types</th>
<th>Literals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Arrays</td>
<td><code>[T; N]</code></td>
<td><code>[20, 30, 40]</code>, <code>[0; 3]</code></td>
</tr>
<tr class="even">
<td>Tuples</td>
<td><code>()</code>, <code>(T,)</code>, <code>(T1, T2)</code>, …</td>
<td><code>()</code>, <code>('x',)</code>, <code>('x', 1.2)</code>, …</td>
</tr>
</tbody>
</table>
<h3 id="array">array</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">a</span>: [<span class="type">i8</span>; <span class="number">10</span>] = [<span class="number">42</span>; <span class="number">10</span>];</span><br><span class="line">    a[<span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a: &#123;:?&#125;&quot;</span>, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//a: [42, 42, 42, 42, 42, 0, 42, 42, 42, 42]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Arrays have elements of the same type, <code>T</code>, and length, <code>N</code>, which is a compile-time constant. Note that the length of the array is <em>part of its type</em></li>
<li><code>&#123;:?&#125;</code> gives the debug output.</li>
<li>Adding <code>#</code>, eg <code>&#123;a:#?&#125;</code>, invokes a “pretty printing” format, which can be easier to read.(竖着打印?)</li>
</ul>
<h3 id="tuple">tuple</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">t</span>: (<span class="type">i8</span>, <span class="type">bool</span>) = (<span class="number">7</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;1st index: &#123;&#125;&quot;</span>, t.<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;2nd index: &#123;&#125;&quot;</span>, t.<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Like arrays, tuples have a fixed length.</li>
<li>Tuples group together values of <strong>different types</strong> into a compound type.</li>
</ul>
<h3 id="slices">slices</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span>: [<span class="type">i32</span>; <span class="number">6</span>] = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>];</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a: &#123;a:?&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span>: &amp;[<span class="type">i32</span>] = &amp;a[<span class="number">2</span>..<span class="number">4</span>];</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s: &#123;s:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>slices always borrow</li>
</ul>
<h3 id="string-and-str">string and str</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span>: &amp;<span class="type">str</span> = <span class="string">&quot;World&quot;</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s1: &#123;s1&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s2</span>: <span class="type">String</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello &quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s2: &#123;s2&#125;&quot;</span>);</span><br><span class="line">    s2.<span class="title function_ invoke__">push_str</span>(s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s2: &#123;s2&#125;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s3</span>: &amp;<span class="type">str</span> = &amp;s2[<span class="number">6</span>..];</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s3: &#123;s3&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">s1: World</span></span><br><span class="line"><span class="comment">s2: Hello </span></span><br><span class="line"><span class="comment">s2: Hello World</span></span><br><span class="line"><span class="comment">s3: World</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>&amp;str</code> an immutable reference to a <strong>string slice.</strong></li>
<li><code>String</code> a mutable string buffer.</li>
<li>As with many other types <code>String::from()</code> creates a string from a string literal; <code>String::new()</code> creates a new empty string, to which string data can be added using the <code>push()</code> and <code>push_str()</code> methods.</li>
<li>The <code>format!()</code> macro is a convenient way to generate an owned string from dynamic values. It accepts the same format specification as <code>println!()</code>.</li>
</ul>
<h3 id="enums">enums</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">generate_random_number</span>() <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">    <span class="number">4</span>  <span class="comment">// Chosen by fair dice roll. Guaranteed to be random.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">CoinFlip</span> &#123;</span><br><span class="line">    Heads,</span><br><span class="line">    Tails,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">flip_coin</span>() <span class="punctuation">-&gt;</span> CoinFlip &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">random_number</span> = <span class="title function_ invoke__">generate_random_number</span>();</span><br><span class="line">    <span class="keyword">if</span> random_number % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CoinFlip::Heads;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CoinFlip::Tails;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You got: &#123;:?&#125;&quot;</span>, <span class="title function_ invoke__">flip_coin</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">WebEvent</span> &#123;</span><br><span class="line">    PageLoad,                 <span class="comment">// Variant without payload</span></span><br><span class="line">    <span class="title function_ invoke__">KeyPress</span>(<span class="type">char</span>),           <span class="comment">// Tuple struct variant</span></span><br><span class="line">    Click &#123; x: <span class="type">i64</span>, y: <span class="type">i64</span> &#125;, <span class="comment">// Full struct variant</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[rustfmt::skip]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">inspect</span>(event: WebEvent) &#123;</span><br><span class="line">    <span class="keyword">match</span> event &#123;</span><br><span class="line">        WebEvent::PageLoad       =&gt; <span class="built_in">println!</span>(<span class="string">&quot;page loaded&quot;</span>),</span><br><span class="line">        WebEvent::<span class="title function_ invoke__">KeyPress</span>(c)    =&gt; <span class="built_in">println!</span>(<span class="string">&quot;pressed &#x27;&#123;c&#125;&#x27;&quot;</span>),</span><br><span class="line">        WebEvent::Click &#123; x, y &#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;clicked at x=&#123;x&#125;, y=&#123;y&#125;&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">load</span> = WebEvent::PageLoad;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">press</span> = WebEvent::<span class="title function_ invoke__">KeyPress</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">click</span> = WebEvent::Click &#123; x: <span class="number">20</span>, y: <span class="number">80</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">inspect</span>(load);</span><br><span class="line">    <span class="title function_ invoke__">inspect</span>(press);</span><br><span class="line">    <span class="title function_ invoke__">inspect</span>(click);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The match expression has a value. The value is the last expression in the match arm which was executed.</li>
</ul>
<h2 id="reference">reference</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span>: <span class="type">i32</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">ref_x</span>: &amp;<span class="keyword">mut</span> <span class="type">i32</span> = &amp;<span class="keyword">mut</span> x; <span class="comment">//&amp;mut x 的&amp;mut 是必须要有的</span></span><br><span class="line">    *ref_x = <span class="number">20</span>;           </span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x: &#123;x&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Be sure to note the difference between <code>let mut ref_x: &amp;i32</code> and <code>let ref_x: &amp;mut i32</code>. The first one represents a mutable reference which can be bound to different values, while the second represents a reference to a mutable value.</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">ref_x</span>: &amp;<span class="type">i32</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">10</span>;</span><br><span class="line">        ref_x = &amp;x; <span class="comment">//error</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;ref_x: &#123;ref_x&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>A reference is said to “borrow” the value it refers to.</li>
<li>Rust is tracking the lifetimes of all references to ensure they live long enough.</li>
</ul>
<h2 id="function">function</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">fizzbuzz_to</span>(<span class="number">20</span>);   <span class="comment">// Defined below, no forward declaration needed</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">is_divisible_by</span>(lhs: <span class="type">u32</span>, rhs: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> rhs == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// Corner case, early return</span></span><br><span class="line">    &#125;</span><br><span class="line">    lhs % rhs == <span class="number">0</span>     <span class="comment">// The last expression in a block is the return value</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">fizzbuzz</span>(n: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> () &#123;  <span class="comment">// No return value means returning the unit type `()`</span></span><br><span class="line">    <span class="title function_ invoke__">match</span> (<span class="title function_ invoke__">is_divisible_by</span>(n, <span class="number">3</span>), <span class="title function_ invoke__">is_divisible_by</span>(n, <span class="number">5</span>)) &#123;</span><br><span class="line">        (<span class="literal">true</span>,  <span class="literal">true</span>)  =&gt; <span class="built_in">println!</span>(<span class="string">&quot;fizzbuzz&quot;</span>),</span><br><span class="line">        (<span class="literal">true</span>,  <span class="literal">false</span>) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;fizz&quot;</span>),</span><br><span class="line">        (<span class="literal">false</span>, <span class="literal">true</span>)  =&gt; <span class="built_in">println!</span>(<span class="string">&quot;buzz&quot;</span>),</span><br><span class="line">        (<span class="literal">false</span>, <span class="literal">false</span>) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;n&#125;&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">fizzbuzz_to</span>(n: <span class="type">u32</span>) &#123;  <span class="comment">// `-&gt; ()` is normally omitted</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..=n &#123;</span><br><span class="line">        <span class="title function_ invoke__">fizzbuzz</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The last expression in a function body (or any block) becomes the return value. Simply omit the <code>;</code> at the end of the expression.</li>
<li>Some functions have no return value, and return the ‘unit type’, <code>()</code>. The compiler will infer this if the <code>-&gt; ()</code> return type is omitted.</li>
<li>The range expression in the <code>for</code> loop in <code>fizzbuzz_to()</code> contains <code>=n</code>, which causes it to include the upper bound. 去掉<code>=</code>就不包含 upper bound</li>
</ul>
<h3 id="overloading">overloading</h3>
<p>不允许重载, 不允许默认参数(可以用 macro?)</p>
<p>可以用泛型</p>
<h2 id="methods">methods</h2>
<p>they are simply functions that are associated with a particular type.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">inc_width</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, delta: <span class="type">u32</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.width += delta;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rect</span> = Rectangle &#123; width: <span class="number">10</span>, height: <span class="number">5</span> &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;old area: &#123;&#125;&quot;</span>, rect.<span class="title function_ invoke__">area</span>());</span><br><span class="line">    rect.<span class="title function_ invoke__">inc_width</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;new area: &#123;&#125;&quot;</span>, rect.<span class="title function_ invoke__">area</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="match">match</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// destructure</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(<span class="type">i32</span>),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(<span class="type">String</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">divide_in_two</span>(n: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="type">Result</span>::<span class="title function_ invoke__">Ok</span>(n / <span class="number">2</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">Result</span>::<span class="title function_ invoke__">Err</span>(<span class="built_in">format!</span>(<span class="string">&quot;cannot divide &#123;n&#125; into two equal parts&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">n</span> = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">divide_in_two</span>(n) &#123;</span><br><span class="line">        <span class="type">Result</span>::<span class="title function_ invoke__">Ok</span>(half) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;n&#125; divided in two is &#123;half&#125;&quot;</span>),</span><br><span class="line">        <span class="type">Result</span>::<span class="title function_ invoke__">Err</span>(msg) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;sorry, an error happened: &#123;msg&#125;&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// array</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">inspect</span>(&amp;[<span class="number">0</span>, -<span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">    <span class="title function_ invoke__">inspect</span>(&amp;[<span class="number">0</span>, -<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[rustfmt::skip]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">inspect</span>(slice: &amp;[<span class="type">i32</span>]) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Tell me about &#123;slice:?&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> slice &#123;</span><br><span class="line">        &amp;[<span class="number">0</span>, y, z] =&gt; <span class="built_in">println!</span>(<span class="string">&quot;First is 0, y = &#123;y&#125;, and z = &#123;z&#125;&quot;</span>),</span><br><span class="line">        &amp;[<span class="number">1</span>, ..]   =&gt; <span class="built_in">println!</span>(<span class="string">&quot;First is 1 and the rest were ignored&quot;</span>),</span><br><span class="line">        _          =&gt; <span class="built_in">println!</span>(<span class="string">&quot;All elements were ignored&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[rustfmt::skip]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pair</span> = (<span class="number">2</span>, -<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Tell me about &#123;pair:?&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> pair &#123;</span><br><span class="line">        (x, y) <span class="keyword">if</span> x == y     =&gt; <span class="built_in">println!</span>(<span class="string">&quot;These are twins&quot;</span>),</span><br><span class="line">        (x, y) <span class="keyword">if</span> x + y == <span class="number">0</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Antimatter, kaboom!&quot;</span>),</span><br><span class="line">        (x, _) <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;The first one is odd&quot;</span>),</span><br><span class="line">        _                    =&gt; <span class="built_in">println!</span>(<span class="string">&quot;No correlation...&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>_</code> pattern is a wildcard pattern which matches any value.</p>
<h2 id="block">block</h2>
<p>A block in Rust has a value and a type: the value is the last expression of the block.</p>
<p>However if the last expression ends with <code>;</code>, then the resulting value and type is <code>()</code>.</p>
<h2 id="while">while</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">iter</span> = v.<span class="title function_ invoke__">into_iter</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = iter.<span class="title function_ invoke__">next</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;x: &#123;x&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="标签">标签</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">iter</span> = v.<span class="title function_ invoke__">into_iter</span>();</span><br><span class="line">    <span class="symbol">&#x27;outer</span>: <span class="keyword">while</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = iter.<span class="title function_ invoke__">next</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;x: &#123;x&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> i &lt; x &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;x: &#123;x&#125;, i: &#123;i&#125;&quot;</span>);</span><br><span class="line">            i += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">3</span> &#123;</span><br><span class="line">                <span class="keyword">break</span> <span class="symbol">&#x27;outer</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="memory">memory</h1>
<p>Full control <em>and</em> safety via compile time enforcement of correct memory management.</p>
<h2 id="stack">stack</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> s1   stack                 heap                           </span><br><span class="line"> ┌────────┬──────┐        ┌─────┐</span><br><span class="line"> │ptr     │   ───┼───────▶│hello│</span><br><span class="line"> │len     │   <span class="number">5</span>  │        └─────┘</span><br><span class="line"> │capacity│   <span class="number">5</span>  │               </span><br><span class="line"> └───────────────┘     </span><br></pre></td></tr></table></figure>
<h2 id="ownership">ownership</h2>
<p>All variable bindings have a <strong>scope</strong> where they are valid and it is an error to use a variable outside its scope:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">p</span> = <span class="title function_ invoke__">Point</span>(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;x: &#123;&#125;&quot;</span>, p.<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;y: &#123;&#125;&quot;</span>, p.<span class="number">1</span>);<span class="comment">// error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="move">move</h2>
<p>An assignment will transfer ownership between variables: the data is <strong>moved</strong> when assignment</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s1</span>: <span class="type">String</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s2</span>: <span class="type">String</span> = s1;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s2: &#123;s2&#125;&quot;</span>);</span><br><span class="line">    <span class="comment">// println!(&quot;s1: &#123;s1&#125;&quot;); error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>There is always <em>exactly</em> one variable binding which owns a value.</li>
<li>In Rust, clones are explicit (by using <code>clone</code>).</li>
<li>When you pass a value to a function, the value is assigned to the function parameter. This transfers ownership.</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">say_hello</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello &#123;name&#125;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">name</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">say_hello</span>(name);</span><br><span class="line">    <span class="comment">// say_hello(name); error, 已经转移到函数里</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>move 是默认的, 但是有些类型 copy 是默认的, 比如 int 等</li>
<li>Copying and cloning are not the same thing:
<ul>
<li>Copying refers to <strong>bitwise copies</strong> of memory regions and does not work on arbitrary objects.</li>
<li>Copying does not allow for custom logic (unlike copy constructors in C++).</li>
<li>Cloning is a more general operation and also allows for custom behavior by implementing the <code>Clone</code> trait.</li>
<li>Copying does not work on types that implement the <code>Drop</code> trait.</li>
</ul></li>
</ul>
<h2 id="borrow">borrow</h2>
<p>Instead of transferring ownership when calling a function, you can let a function <em>borrow</em> the value:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">add</span>(p1: &amp;Point, p2: &amp;Point) <span class="punctuation">-&gt;</span> Point &#123;</span><br><span class="line">    <span class="title function_ invoke__">Point</span>(p1.<span class="number">0</span> + p2.<span class="number">0</span>, p1.<span class="number">1</span> + p2.<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p1</span> = <span class="title function_ invoke__">Point</span>(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p2</span> = <span class="title function_ invoke__">Point</span>(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p3</span> = <span class="title function_ invoke__">add</span>(&amp;p1, &amp;p2);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;p1:?&#125; + &#123;p2:?&#125; = &#123;p3:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The <code>add</code> function <strong>borrows</strong> two points and returns a new point.</li>
<li>The caller <strong>retains ownership</strong> of the inputs.</li>
</ul>
<p>Rust puts constraints on the ways you can borrow values:</p>
<ul>
<li>You can have one or more <code>&amp;T</code> values at any given time, <em>or</em></li>
<li>You can have exactly one <code>&amp;mut T</code> value.</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">a</span>: <span class="type">i32</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">b</span>: &amp;<span class="type">i32</span> = &amp;a;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">c</span>: &amp;<span class="keyword">mut</span> <span class="type">i32</span> = &amp;<span class="keyword">mut</span> a; <span class="comment">//error</span></span><br><span class="line">        *c = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a: &#123;a&#125;&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;b: &#123;b&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The above code does not compile because <code>a</code> is borrowed as mutable (through <code>c</code>) and as immutable (through <code>b</code>) at the same time.</li>
<li>Move the <code>println!</code> statement for <code>b</code> before the scope that introduces <code>c</code> to make the code compile.</li>
<li>After that change, <strong>the compiler realizes that <code>b</code> is only ever used before the new mutable borrow of <code>a</code> through <code>c</code>. This is a feature of the borrow checker called “non-lexical lifetimes”.</strong></li>
</ul>
<h2 id="lifetime">lifetime</h2>
<ul>
<li>Read <code>&amp;'a Point</code> as “a borrowed <code>Point</code> which is valid for at least the lifetime <code>a</code>”.</li>
<li>Lifetimes are always inferred by the compiler: you cannot assign a lifetime yourself.
<ul>
<li>Lifetime annotations create constraints; the compiler verifies that there is a valid solution.</li>
</ul></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">left_most</span>&lt;<span class="symbol">&#x27;a</span>&gt;(p1: &amp;<span class="symbol">&#x27;a</span> Point, p2: &amp;<span class="symbol">&#x27;a</span> Point) <span class="punctuation">-&gt;</span> &amp;<span class="symbol">&#x27;a</span> Point &#123;</span><br><span class="line">    <span class="keyword">if</span> p1.<span class="number">0</span> &lt; p2.<span class="number">0</span> &#123; p1 &#125; <span class="keyword">else</span> &#123; p2 &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p1</span>: Point = <span class="title function_ invoke__">Point</span>(<span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p2</span>: Point = <span class="title function_ invoke__">Point</span>(<span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p3</span>: &amp;Point = <span class="title function_ invoke__">left_most</span>(&amp;p1, &amp;p2);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;left-most point: &#123;:?&#125;&quot;</span>, p3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>'a</code> is a generic parameter, it is inferred by the compiler.</li>
<li>Lifetimes start with <code>'</code> and <code>'a</code> is a typical default name.</li>
<li>Another way to explain it:
<ul>
<li>Two references to two values are borrowed by a function and the function returns another reference.</li>
<li>It must have come from one of those two inputs (or from a global variable).</li>
<li>Which one is it? The compiler needs to to know, <strong>so at the call site the returned reference is not used for longer than a variable from where the reference came from.</strong></li>
</ul></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Highlight</span>&lt;<span class="symbol">&#x27;doc</span>&gt;(&amp;<span class="symbol">&#x27;doc</span> <span class="type">str</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">erase</span>(text: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Bye &#123;text&#125;!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">text</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;The quick brown fox jumps over the lazy dog.&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">fox</span> = <span class="title function_ invoke__">Highlight</span>(&amp;text[<span class="number">4</span>..<span class="number">19</span>]);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">dog</span> = <span class="title function_ invoke__">Highlight</span>(&amp;text[<span class="number">35</span>..<span class="number">43</span>]);</span><br><span class="line">    <span class="comment">// erase(text); </span></span><br><span class="line">    <span class="comment">// cannot move out of `text` because it is borrowed</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;fox:?&#125;&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;dog:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="struct">struct</h1>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    name: <span class="type">String</span>,</span><br><span class="line">    age: <span class="type">u8</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">peter</span> = Person &#123;</span><br><span class="line">        name: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Peter&quot;</span>),</span><br><span class="line">        age: <span class="number">27</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is &#123;&#125; years old&quot;</span>, peter.name, peter.age);</span><br><span class="line">    </span><br><span class="line">    peter.age = <span class="number">28</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is &#123;&#125; years old&quot;</span>, peter.name, peter.age);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">jackie</span> = Person &#123;</span><br><span class="line">        name: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Jackie&quot;</span>),</span><br><span class="line">        ..peter</span><br><span class="line">      <span class="comment">// the syntax ..peter allows us to copy the majority of the fields from the old struct without having to explicitly type it all out. It must always be the last element.</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is &#123;&#125; years old&quot;</span>, jackie.name, jackie.age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p</span> = <span class="title function_ invoke__">Point</span>(<span class="number">17</span>, <span class="number">23</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;(&#123;&#125;, &#123;&#125;)&quot;</span>, p.<span class="number">0</span>, p.<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Unlike in C++, there is no inheritance between structs.</li>
</ul>
<p>tuple</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p</span> = <span class="title function_ invoke__">Point</span>(<span class="number">17</span>, <span class="number">23</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;(&#123;&#125;, &#123;&#125;)&quot;</span>, p.<span class="number">0</span>, p.<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    name: <span class="type">String</span>,</span><br><span class="line">    age: <span class="type">u8</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(name: <span class="type">String</span>, age: <span class="type">u8</span>) <span class="punctuation">-&gt;</span> Person &#123;</span><br><span class="line">        Person &#123; name, age &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//or</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(name: <span class="type">String</span>, age: <span class="type">u8</span>) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        <span class="keyword">Self</span> &#123; name, age &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">peter</span> = Person::<span class="title function_ invoke__">new</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Peter&quot;</span>), <span class="number">27</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;peter:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>default</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    name: <span class="type">String</span>,</span><br><span class="line">    age: <span class="type">u8</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Default</span> <span class="keyword">for</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">default</span>() <span class="punctuation">-&gt;</span> Person &#123;</span><br><span class="line">        Person &#123;</span><br><span class="line">            name: <span class="string">&quot;Bot&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">            age: <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">create_default</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tmp</span> = Person &#123;</span><br><span class="line">        ..<span class="built_in">Default</span>::<span class="title function_ invoke__">default</span>()</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tmp</span> = Person &#123;</span><br><span class="line">        name: <span class="string">&quot;Sam&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">        ..<span class="built_in">Default</span>::<span class="title function_ invoke__">default</span>()</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Methods are defined in the <code>impl</code> block.</li>
<li>Use <code>&#123;:#?&#125;</code> when printing structs to request the <code>Debug</code> representation.</li>
</ul>
<h2 id="methods-1">methods</h2>
<p>You do this with an <code>impl</code> block:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    name: <span class="type">String</span>,</span><br><span class="line">    age: <span class="type">u8</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">say_hello</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Hello, my name is &#123;&#125;&quot;</span>, <span class="keyword">self</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">say_goodbye</span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;gb, my name is &#123;&#125;&quot;</span>, <span class="keyword">self</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">peter</span> = Person &#123;</span><br><span class="line">        name: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Peter&quot;</span>),</span><br><span class="line">        age: <span class="number">27</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    peter.<span class="title function_ invoke__">say_hello</span>();</span><br><span class="line">    peter.<span class="title function_ invoke__">say_goodbye</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Point out the use of the keyword <code>self</code>, a method receiver.</p>
<ul>
<li>Show that it is an abbreviated term for <code>self:&amp;Self</code> and perhaps show how the struct name could also be used.</li>
<li>Explain that <code>Self</code> is a type alias for the type the <code>impl</code> block is in and can be used elsewhere in the block.</li>
<li>Note how <code>self</code> is used like other structs and dot notation can be used to refer to individual fields.</li>
<li>This might be a good time to demonstrate how the <code>&amp;self</code> differs from <code>self</code> by modifying the code and trying to run say_hello twice.</li>
</ul></li>
<li><p>The <code>&amp;self</code> above indicates that the method borrows the object immutably. There are other possible receivers for a method:</p>
<ul>
<li><code>&amp;self</code>: <strong>borrows the object from the caller using a shared and immutable reference.</strong> The object can be used again afterwards.</li>
<li><code>&amp;mut self</code>: borrows the object from the caller using a unique and <strong>mutable</strong> reference. The object can be used again afterwards.</li>
<li><code>self</code>: <strong>takes ownership of the object</strong> and moves it away from the caller. The method becomes the owner of the object. The object will be dropped (deallocated) when the method returns, unless its ownership is explicitly transmitted.</li>
<li><code>mut self</code>: same as above, but while the method owns the object, it can <strong>mutate</strong> it too. Complete ownership does not automatically mean mutability.</li>
<li>No receiver: this becomes a <strong>static method</strong> on the struct. Typically used to create constructors which are called <code>new</code> by convention.</li>
</ul>
<p>Beyond variants on <code>self</code>, there are also <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/reference/special-types-and-traits.html">special wrapper types</a> allowed to be receiver types, such as <code>Box&lt;Self&gt;</code>.</p></li>
<li><p>Note that although the method receivers are different, the non-static functions are called the same way in the main body. <strong>Rust enables automatic referencing and dereferencing when calling methods. Rust automatically adds in the <code>&amp;</code>, <code>*</code>, <code>muts</code></strong> so that that object matches the method signature.</p></li>
</ul>
<h1 id="standard-library">standard library</h1>
<h2 id="option-and-result">option and result</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">numbers</span> = <span class="built_in">vec!</span>[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">first</span>: <span class="type">Option</span>&lt;&amp;<span class="type">i8</span>&gt; = numbers.<span class="title function_ invoke__">first</span>();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;first: &#123;first:?&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">idx</span>: <span class="type">Result</span>&lt;<span class="type">usize</span>, <span class="type">usize</span>&gt; = numbers.<span class="title function_ invoke__">binary_search</span>(&amp;<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;idx: &#123;idx:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Option&lt;&amp;T&gt;</code> has zero space overhead compared to <code>&amp;T</code>.</li>
<li><code>Result</code> is the standard type to implement error handling as we will see on Day 3.</li>
<li><code>binary_search</code> returns <code>Result&lt;usize, usize&gt;</code>
<ul>
<li>If found, <code>Result::Ok</code> holds the index where the element is found.</li>
<li>Otherwise, <code>Result::Err</code> contains the index where such an element should be inserted.</li>
</ul></li>
</ul>
<h2 id="string">string</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    s1.<span class="title function_ invoke__">push_str</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s1: len = &#123;&#125;, capacity = &#123;&#125;&quot;</span>, s1.<span class="title function_ invoke__">len</span>(), s1.<span class="title function_ invoke__">capacity</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s2</span> = <span class="type">String</span>::<span class="title function_ invoke__">with_capacity</span>(s1.<span class="title function_ invoke__">len</span>() + <span class="number">1</span>);</span><br><span class="line">    s2.<span class="title function_ invoke__">push_str</span>(&amp;s1);</span><br><span class="line">    s2.<span class="title function_ invoke__">push</span>(<span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s2: len = &#123;&#125;, capacity = &#123;&#125;&quot;</span>, s2.<span class="title function_ invoke__">len</span>(), s2.<span class="title function_ invoke__">capacity</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s3</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;🇨🇭&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;s3: len = &#123;&#125;, number of chars = &#123;&#125;&quot;</span>, s3.<span class="title function_ invoke__">len</span>(),</span><br><span class="line">             s3.<span class="title function_ invoke__">chars</span>().<span class="title function_ invoke__">count</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>String</code> implements <code>Deref&lt;Target = str&gt;</code> which means that you can call all <code>str</code> methods on a <code>String</code>.</li>
<li>When people refer to strings they could either be talking about <code>&amp;str</code> or <code>String</code>.</li>
</ul>
<h2 id="vec">Vec</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v1</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    v1.<span class="title function_ invoke__">push</span>(<span class="number">42</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;v1: len = &#123;&#125;, capacity = &#123;&#125;&quot;</span>, v1.<span class="title function_ invoke__">len</span>(), v1.<span class="title function_ invoke__">capacity</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v2</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">with_capacity</span>(v1.<span class="title function_ invoke__">len</span>() + <span class="number">1</span>);</span><br><span class="line">    v2.<span class="title function_ invoke__">extend</span>(v1.<span class="title function_ invoke__">iter</span>());</span><br><span class="line">    v2.<span class="title function_ invoke__">push</span>(<span class="number">9999</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;v2: len = &#123;&#125;, capacity = &#123;&#125;&quot;</span>, v2.<span class="title function_ invoke__">len</span>(), v2.<span class="title function_ invoke__">capacity</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Canonical macro to initialize a vector with elements.</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v3</span> = <span class="built_in">vec!</span>[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Retain only the even elements.</span></span><br><span class="line">    v3.<span class="title function_ invoke__">retain</span>(|x| x % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;v3:?&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove consecutive duplicates.</span></span><br><span class="line">    v3.<span class="title function_ invoke__">dedup</span>();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;v3:?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The data it contains is stored on the heap. This means the amount of data doesn’t need to be known at compile time. It can grow or shrink at runtime.</li>
</ul>
<h2 id="hashmap">hashmap</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">page_counts</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    page_counts.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;Adventures of Huckleberry Finn&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="number">207</span>);</span><br><span class="line">    page_counts.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;Grimms&#x27; Fairy Tales&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="number">751</span>);</span><br><span class="line">    page_counts.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;Pride and Prejudice&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="number">303</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> !page_counts.<span class="title function_ invoke__">contains_key</span>(<span class="string">&quot;Les Misérables&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;We know about &#123;&#125; books, but not Les Misérables.&quot;</span>,</span><br><span class="line">                 page_counts.<span class="title function_ invoke__">len</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">book</span> <span class="keyword">in</span> [<span class="string">&quot;Pride and Prejudice&quot;</span>, <span class="string">&quot;Alice&#x27;s Adventure in Wonderland&quot;</span>] &#123;</span><br><span class="line">        <span class="keyword">match</span> page_counts.<span class="title function_ invoke__">get</span>(book) &#123;</span><br><span class="line">            <span class="title function_ invoke__">Some</span>(count) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;book&#125;: &#123;count&#125; pages&quot;</span>),</span><br><span class="line">            <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;book&#125; is unknown.&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Use the .entry() method to insert a value if nothing is found.</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">book</span> <span class="keyword">in</span> [<span class="string">&quot;Pride and Prejudice&quot;</span>, <span class="string">&quot;Alice&#x27;s Adventure in Wonderland&quot;</span>] &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">page_count</span>: &amp;<span class="keyword">mut</span> <span class="type">i32</span> = page_counts.<span class="title function_ invoke__">entry</span>(book.<span class="title function_ invoke__">to_string</span>()).<span class="title function_ invoke__">or_insert</span>(<span class="number">0</span>);</span><br><span class="line">        *page_count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;page_counts:#?&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="box">box</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">five</span> = <span class="type">Box</span>::<span class="title function_ invoke__">new</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;five: &#123;&#125;&quot;</span>, *five);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a box is never null</p>
<h2 id="rc">Rc</h2>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::rc::Rc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">a</span> = Rc::<span class="title function_ invoke__">new</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">b</span> = a.<span class="title function_ invoke__">clone</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a: &#123;a&#125;&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;b: &#123;b&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mod">mod</h2>
<p>精读到此</p>
<h1 id="section">?</h1>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Tuples can be used as function arguments and as return values</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">reverse</span>(pair: (<span class="type">i32</span>, <span class="type">bool</span>)) <span class="punctuation">-&gt;</span> (<span class="type">bool</span>, <span class="type">i32</span>) &#123;</span><br><span class="line">    <span class="comment">// `let` can be used to bind the members of a tuple to variables</span></span><br><span class="line">    <span class="keyword">let</span> (int_param, bool_param) = pair;</span><br><span class="line"></span><br><span class="line">    (bool_param, int_param)</span><br><span class="line">  <span class="comment">//return ?</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The following struct is for the activity.</span></span><br><span class="line"><span class="meta">#[derive(Debug)]</span><span class="comment">//?</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span>(<span class="type">f32</span>, <span class="type">f32</span>, <span class="type">f32</span>, <span class="type">f32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// A tuple with a bunch of different types</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">long_tuple</span> = (<span class="number">1u8</span>, <span class="number">2u16</span>, <span class="number">3u32</span>, <span class="number">4u64</span>,</span><br><span class="line">                      -<span class="number">1i8</span>, -<span class="number">2i16</span>, -<span class="number">3i32</span>, -<span class="number">4i64</span>,</span><br><span class="line">                      <span class="number">0.1f32</span>, <span class="number">0.2f64</span>,</span><br><span class="line">                      <span class="string">&#x27;a&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Values can be extracted from the tuple using tuple indexing</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;long tuple first value: &#123;&#125;&quot;</span>, long_tuple.<span class="number">0</span>);<span class="comment">// .</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;long tuple second value: &#123;&#125;&quot;</span>, long_tuple.<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Tuples can be tuple members</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tuple_of_tuples</span> = ((<span class="number">1u8</span>, <span class="number">2u16</span>, <span class="number">2u32</span>), (<span class="number">4u64</span>, -<span class="number">1i8</span>), -<span class="number">2i16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Tuples are printable</span></span><br><span class="line">  <span class="comment">//&#123;:?&#125;?</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;tuple of tuples: &#123;:?&#125;&quot;</span>, tuple_of_tuples);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// But long Tuples (more than 12 elements) cannot be printed</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pair</span> = (<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;pair is &#123;:?&#125;&quot;</span>, pair);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;the reversed pair is &#123;:?&#125;&quot;</span>, <span class="title function_ invoke__">reverse</span>(pair));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// To create one element tuples, the comma is required to tell them apart</span></span><br><span class="line">    <span class="comment">// from a literal surrounded by parentheses</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;one element tuple: &#123;:?&#125;&quot;</span>, (<span class="number">5u32</span>,));</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;just an integer: &#123;:?&#125;&quot;</span>, (<span class="number">5u32</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//tuples can be destructured to create bindings</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tuple</span> = (<span class="number">1</span>, <span class="string">&quot;hello&quot;</span>, <span class="number">4.5</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> (a, b, c, d) = tuple;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;, &#123;:?&#125;, &#123;:?&#125;, &#123;:?&#125;&quot;</span>, a, b, c, d);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">matrix</span> = <span class="title function_ invoke__">Matrix</span>(<span class="number">1.1</span>, <span class="number">1.2</span>, <span class="number">2.1</span>, <span class="number">2.2</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, matrix);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">xs</span>: [<span class="type">i32</span>; <span class="number">5</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// All elements can be initialized to the same value</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">ys</span>: [<span class="type">i32</span>; <span class="number">500</span>] = [<span class="number">0</span>; <span class="number">500</span>];</span><br></pre></td></tr></table></figure>
<p>Slices are similar to arrays, but their length is not known at compile time. Instead, a slice is a two-word object, <strong>the first word is a pointer to the data, and the second word is the length of the slice.</strong></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2023/03/8e79e78184fa.html">https://sinos_wei.gitee.io/2023/03/8e79e78184fa.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/string/">string</a><a class="post-meta__tags" href="/tags/println/">println</a><a class="post-meta__tags" href="/tags/let/">let</a><a class="post-meta__tags" href="/tags/tuple/">tuple</a><a class="post-meta__tags" href="/tags/self/">self</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/IMG_6256.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/03/558c2ce4f43d.html" title="blogs"><img class="cover" src="/img/cover/IMG_2082.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">blogs</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/5e52a7d197f6.html" title="游戏编程模式读书笔记"><img class="cover" src="/img/cover/IMG_2406.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">游戏编程模式读书笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/01/c283701d8e64.html" title="java"><img class="cover" src="/img/cover/IMG_2945.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-25</div><div class="title">java</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cover/IMG_2242.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">156</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SinosGray"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/SinosGray" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rust-ecosystem"><span class="toc-number">1.1.</span> <span class="toc-text">rust ecosystem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hello-world"><span class="toc-number">1.2.</span> <span class="toc-text">hello world</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#syntax"><span class="toc-number">2.</span> <span class="toc-text">syntax</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#compile-time-guarantees"><span class="toc-number">2.1.</span> <span class="toc-text">compile time guarantees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#runtime-guarantees"><span class="toc-number">2.2.</span> <span class="toc-text">runtime guarantees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loops"><span class="toc-number">2.3.</span> <span class="toc-text">loops</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iterator"><span class="toc-number">2.4.</span> <span class="toc-text">iterator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#const"><span class="toc-number">2.5.</span> <span class="toc-text">const</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#static"><span class="toc-number">2.6.</span> <span class="toc-text">static</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shadow"><span class="toc-number">2.7.</span> <span class="toc-text">shadow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#types"><span class="toc-number">2.8.</span> <span class="toc-text">types</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#array"><span class="toc-number">2.8.1.</span> <span class="toc-text">array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tuple"><span class="toc-number">2.8.2.</span> <span class="toc-text">tuple</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slices"><span class="toc-number">2.8.3.</span> <span class="toc-text">slices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#string-and-str"><span class="toc-number">2.8.4.</span> <span class="toc-text">string and str</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#enums"><span class="toc-number">2.8.5.</span> <span class="toc-text">enums</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reference"><span class="toc-number">2.9.</span> <span class="toc-text">reference</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#function"><span class="toc-number">2.10.</span> <span class="toc-text">function</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#overloading"><span class="toc-number">2.10.1.</span> <span class="toc-text">overloading</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#methods"><span class="toc-number">2.11.</span> <span class="toc-text">methods</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#match"><span class="toc-number">2.12.</span> <span class="toc-text">match</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#block"><span class="toc-number">2.13.</span> <span class="toc-text">block</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#while"><span class="toc-number">2.14.</span> <span class="toc-text">while</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE"><span class="toc-number">2.15.</span> <span class="toc-text">标签</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#memory"><span class="toc-number">3.</span> <span class="toc-text">memory</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#stack"><span class="toc-number">3.1.</span> <span class="toc-text">stack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ownership"><span class="toc-number">3.2.</span> <span class="toc-text">ownership</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#move"><span class="toc-number">3.3.</span> <span class="toc-text">move</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#borrow"><span class="toc-number">3.4.</span> <span class="toc-text">borrow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lifetime"><span class="toc-number">3.5.</span> <span class="toc-text">lifetime</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#struct"><span class="toc-number">4.</span> <span class="toc-text">struct</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#methods-1"><span class="toc-number">4.1.</span> <span class="toc-text">methods</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#standard-library"><span class="toc-number">5.</span> <span class="toc-text">standard library</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#option-and-result"><span class="toc-number">5.1.</span> <span class="toc-text">option and result</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#string"><span class="toc-number">5.2.</span> <span class="toc-text">string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vec"><span class="toc-number">5.3.</span> <span class="toc-text">Vec</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hashmap"><span class="toc-number">5.4.</span> <span class="toc-text">hashmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#box"><span class="toc-number">5.5.</span> <span class="toc-text">box</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rc"><span class="toc-number">5.6.</span> <span class="toc-text">Rc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mod"><span class="toc-number">5.7.</span> <span class="toc-text">mod</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#section"><span class="toc-number">6.</span> <span class="toc-text">?</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/cd35e6945182.html" title="408目录"><img src="/img/cover/IMG_3193.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="408目录"/></a><div class="content"><a class="title" href="/2023/05/cd35e6945182.html" title="408目录">408目录</a><time datetime="2023-06-01T09:35:54.879Z" title="Updated 2023-06-01 17:35:54">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/f05961026253.html" title="数据结构"><img src="/img/cover/980fc83b6l8ac6c52817c35e43c0cb4e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构"/></a><div class="content"><a class="title" href="/2023/05/f05961026253.html" title="数据结构">数据结构</a><time datetime="2023-06-01T09:35:48.538Z" title="Updated 2023-06-01 17:35:48">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/724d57ab8c34.html" title="操作系统"><img src="/img/cover/IMG_4167.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2023/05/724d57ab8c34.html" title="操作系统">操作系统</a><time datetime="2023-06-01T09:35:39.937Z" title="Updated 2023-06-01 17:35:39">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/1d8ca121605c.html" title="计算机网络"><img src="/img/cover/IMG_9501.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机网络"/></a><div class="content"><a class="title" href="/2023/05/1d8ca121605c.html" title="计算机网络">计算机网络</a><time datetime="2023-06-01T09:35:32.290Z" title="Updated 2023-06-01 17:35:32">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/4ef6e1899988.html" title="计算机组成原理"><img src="/img/cover/IMG_3302.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理"/></a><div class="content"><a class="title" href="/2023/05/4ef6e1899988.html" title="计算机组成原理">计算机组成原理</a><time datetime="2023-06-01T09:35:20.903Z" title="Updated 2023-06-01 17:35:20">2023-06-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>