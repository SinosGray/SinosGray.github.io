<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>cmake | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="cmake">
<meta property="og:url" content="https://sinos_wei.gitee.io/2023/01/07/cmake/index.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/IMG_2495.JPG">
<meta property="article:published_time" content="2023-01-07T07:38:00.000Z">
<meta property="article:modified_time" content="2023-01-12T08:44:02.876Z">
<meta property="article:author" content="Sinos">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/IMG_2495.JPG"><link rel="shortcut icon" href="/img/icon.JPG"><link rel="canonical" href="https://sinos_wei.gitee.io/2023/01/07/cmake/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'cmake',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-12 16:44:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.PNG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/IMG_2495.JPG')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Sinos_wei's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">cmake</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-01-07T07:38:00.000Z" title="Created 2023-01-07 15:38:00">2023-01-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-01-12T08:44:02.876Z" title="Updated 2023-01-12 16:44:02">2023-01-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="cmake"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>

</blockquote>
<span id="more"></span>
<h1 id="mac-vscode-cmake-llvm开发环境">mac vscode cmake llvm开发环境</h1>
<h2 id="包">包</h2>
<p><code>brew install cmake llvm ninja pkgconfig</code></p>
<h2 id="vs-插件">vs 插件</h2>
<p>cmake</p>
<p>cmake tools</p>
<p>codelldb(debug)</p>
<p>clangd</p>
<p>doxygen(快捷键产生注释)</p>
<h2 id="配置文件">配置文件</h2>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cmakelists.txt </span></span><br><span class="line"><span class="keyword">project</span>(hello_world) </span><br><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSTON <span class="number">3.15</span>.<span class="number">0</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">20</span>) </span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_EXTENSTONS <span class="keyword">OFF</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span> hello.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(fmt REQUIRED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(</span><br><span class="line"><span class="variable">$&#123;CMAKE_PROJECT_NAME&#125;</span> PRIVATE</span><br><span class="line">fmt::fmt</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">//.vscode/launch.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lldb&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Debug&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;command:cmake.LaunchTargetPath&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;internalConsoleOptions&quot;</span><span class="punctuation">:</span> <span class="string">&quot;neveropen&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;console&quot;</span><span class="punctuation">:</span> <span class="string">&quot;integratedTerminal&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// build/compile_commands.json</span><br><span class="line">// clang 实际执行编译指令</span><br><span class="line">//settings-&gt;clangd settings-&gt;arguments</span><br><span class="line">//clangd -help</span><br><span class="line"></span><br><span class="line">//.clang-tidty是配置 clang-tidy 的文件</span><br><span class="line">--compile-commands-dir=$(workspaceFolder&#125;/build</span><br><span class="line">--header-insertion=iwyu</span><br><span class="line">--background-index</span><br><span class="line">--clang-tidy</span><br><span class="line">--pch-storage=memory </span><br><span class="line">-j=12</span><br><span class="line">--pretty </span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .clang-format</span></span><br><span class="line"><span class="attr">BasedOnStyle:</span> <span class="string">LLVM</span></span><br><span class="line"><span class="attr">UseTab:</span> <span class="string">Never</span></span><br><span class="line"><span class="attr">IndentWidth:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">DerivePointerAlignment:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">PointerAlignment:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlwaysBreakAfterReturnType:</span> <span class="string">None</span></span><br><span class="line"><span class="attr">AlwaysBreakTemplateDeclarations:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlwaysBreakBeforeMultilineStrings:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlignOperands:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlignAfterOpenBracket:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlignConsecutiveBitFields:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AlignConsecutiveMacros:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">ConstructorInitializerAllOnOneLineOrOnePerLine:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">AllowAllConstructorInitializersOnNextLine:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">BinPackArguments:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">BinPackParameters:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">IncludeBlocks:</span> <span class="string">Regroup</span></span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Users &gt; akunda &gt; Library &gt; Application Support &gt; Code &gt; User &gt; snippets &gt; &#123;&#125; cpp.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Main&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">    <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;int main(int argc, char* argc[]) &#123;&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;	$1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;	return 0;&quot;</span></span><br><span class="line">      <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Main function&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>CMake：编辑用户本地 CMake 工具包 CMake: Edit User-Local CMake Kits</p>
<p>cmake-tools-kits.json</p>
<h2 id="流程">流程</h2>
<p><code>cmake config</code> choose toolchain</p>
<p><code>build</code></p>
<h1 id="a-intro">A intro</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_cmake)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_cmake main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment">## add_executable($&#123;PROJECT_NAME&#125; main.cpp)</span></span><br></pre></td></tr></table></figure>
<p>The +add_executable()+ command specifies that an executable should be build from the specified source files</p>
<p>The root or top level folder that you run the cmake command from is known as your <strong>CMAKE_BINARY_DIR</strong> and is the root folder for all your binary files.</p>
<p>Out-of-Source Build</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make .</span><br><span class="line">./hello_cmake</span><br></pre></td></tr></table></figure>
<h1 id="b-header">B header</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_headers)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a sources variable with a link to all cpp files to compile</span></span><br><span class="line"><span class="keyword">set</span>(SOURCES</span><br><span class="line">    src/Hello.cpp</span><br><span class="line">    src/main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable with the above sources</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_headers <span class="variable">$&#123;SOURCES&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the directories that should be included in the build command for this target</span></span><br><span class="line"><span class="comment"># when running g++ these will be included as -I/directory/path/</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(hello_headers</span><br><span class="line">    PRIVATE </span><br><span class="line">        <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="cmake-variables">cmake variables</h2>
<p>|CMAKE_SOURCE_DIR |The root source directory</p>
<p>|<strong>CMAKE_CURRENT_SOURCE_DIR</strong> |The current source directory if using sub-projects and directories.</p>
<p>|<strong>PROJECT_SOURCE_DIR</strong> |The source directory of the current cmake project.</p>
<p>|<strong>CMAKE_BINARY_DIR</strong> |The root binary / build directory. This is the directory where you ran the cmake command.</p>
<p>|CMAKE_CURRENT_BINARY_DIR |The build directory you are currently in.</p>
<p>|PROJECT_BINARY_DIR |The build directory for the current project.</p>
<p>The base install location is controlled by the variable <strong>CMAKE_INSTALL_PREFIX</strong></p>
<p>In the previous examples, when running the make command the output only shows the status of the build. To see the full output for debugging purposes you can add +VERBOSE=1+ flag when running make.</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">make clean</span><br><span class="line">make VERBOSE=1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="c-static-library">C static library</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(hello_library)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create a library</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Generate the static library from the library sources</span></span><br><span class="line"><span class="keyword">add_library</span>(hello_library STATIC </span><br><span class="line">    src/Hello.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(hello_library</span><br><span class="line">    PUBLIC </span><br><span class="line">        <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create an executable</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable with the above sources</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_binary </span><br><span class="line">    src/main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link the new hello_library target with the hello_binary target</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>( hello_binary</span><br><span class="line">    PRIVATE </span><br><span class="line">        hello_library</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>This will cause the included directory used in the following places:</p>
<ul>
<li>When compiling the library</li>
<li>When compiling any additional target that links the library.</li>
</ul>
<p>The meaning of scopes are:</p>
<ul>
<li>+PRIVATE+ - the directory is added to this target's include directories</li>
<li>+INTERFACE+ - the directory is added to the include directories for any targets that link this library.</li>
<li>+PUBLIC+ - As above, it is included in this library and also any targets that link this library.</li>
</ul>
<h1 id="d-shared-library">D shared library</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(hello_library)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create a library</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Generate the shared library from the library sources</span></span><br><span class="line"><span class="keyword">add_library</span>(hello_library SHARED </span><br><span class="line">    src/Hello.cpp</span><br><span class="line">)</span><br><span class="line"><span class="comment">#As shown below, this allows you to reference the target using the alias name when linking it against other targets.</span></span><br><span class="line"><span class="keyword">add_library</span>(hello::library ALIAS hello_library)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(hello_library</span><br><span class="line">    PUBLIC </span><br><span class="line">        <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create an executable</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable with the above sources</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_binary</span><br><span class="line">    src/main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link the new hello_library target with the hello_binary target</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>( hello_binary</span><br><span class="line">    PRIVATE </span><br><span class="line">        hello::library</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Static Libraries:</strong> A <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/static-vs-dynamic-libraries/">Static library</a> or statically-linked library is a set of routines, external functions and variables which are resolved in a caller at compile-time and copied into a target application by a compiler, linker, or binder, producing an object file and a stand-alone executable. This executable and the process of compiling it are both known as a static build of the program. Historically, libraries could only be static. They are usually faster than the shared libraries because a set of commonly used object files is put into a single library executable file. One can build multiple executables without the need to recompile the file. Because it is a single file to be built, use of link commands are simpler than shared library link commands, because you specify the name of the static library.</p>
<p><strong>Shared Libraries:</strong> <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/working-with-shared-libraries-set-1/">Shared libraries</a> are .so (or in Windows .dll, or in OS X .dylib) files. These are linked dynamically simply including the address of the library (whereas static linking is a waste of space). Dynamic linking links the libraries at the run-time. Thus, all the functions are in a special place in memory space, and every program can access them, without having multiple copies of them.</p>
<h1 id="e-installation">E installation</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(cmake_examples_install)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create a library</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Generate the shared library from the library sources</span></span><br><span class="line"><span class="keyword">add_library</span>(cmake_examples_inst SHARED</span><br><span class="line">    src/Hello.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(cmake_examples_inst</span><br><span class="line">    PUBLIC </span><br><span class="line">        <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Create an executable</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable with the above sources</span></span><br><span class="line"><span class="keyword">add_executable</span>(cmake_examples_inst_bin</span><br><span class="line">    src/main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link the new hello_library target with the hello_binary target</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>( cmake_examples_inst_bin</span><br><span class="line">    PRIVATE </span><br><span class="line">        cmake_examples_inst</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># Install</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Binaries</span></span><br><span class="line"><span class="comment"># Install the binary generated from the target cmake_examples_inst_bin target to the destination $&#123;CMAKE_INSTALL_PREFIX&#125;/bin</span></span><br><span class="line"><span class="keyword">install</span> (TARGETS cmake_examples_inst_bin</span><br><span class="line">    DESTINATION bin)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Library</span></span><br><span class="line"><span class="comment"># Install the shared library generated from the target cmake_examples_inst target to the destination $&#123;CMAKE_INSTALL_PREFIX&#125;/lib</span></span><br><span class="line"><span class="keyword">install</span> (TARGETS cmake_examples_inst</span><br><span class="line">    LIBRARY DESTINATION lib)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Header files</span></span><br><span class="line"><span class="comment"># Install the header files for developing against the cmake_examples_inst library into the $&#123;CMAKE_INSTALL_PREFIX&#125;/include directory.</span></span><br><span class="line"><span class="keyword">install</span>(DIRECTORY <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span>/ </span><br><span class="line">    DESTINATION <span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="comment"># Install a configuration file to the destination $&#123;CMAKE_INSTALL_PREFIX&#125;/etc</span></span><br><span class="line"><span class="keyword">install</span> (FILES cmake-examples.conf</span><br><span class="line">    DESTINATION etc)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>make install</code>会把文件装到/usr/local/xxx 中</p>
<p>to uninstall</p>
<p><code>sudo xargs rm &lt; install_manifest.txt</code></p>
<h1 id="f-build-type">F build type</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set a default build type if none was specified</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">NOT</span> CMAKE_BUILD_TYPE <span class="keyword">AND</span> <span class="keyword">NOT</span> CMAKE_CONFIGURATION_TYPES)</span><br><span class="line">  <span class="keyword">message</span>(<span class="string">&quot;Setting build type to &#x27;RelWithDebInfo&#x27; as none was specified.&quot;</span>)</span><br><span class="line">  <span class="keyword">set</span>(CMAKE_BUILD_TYPE RelWithDebInfo CACHE <span class="keyword">STRING</span> <span class="string">&quot;Choose the type of build.&quot;</span> FORCE)</span><br><span class="line">  <span class="comment"># Set the possible values of build type for cmake-gui</span></span><br><span class="line">  <span class="keyword">set_property</span>(CACHE CMAKE_BUILD_TYPE PROPERTY STRINGS <span class="string">&quot;Debug&quot;</span> <span class="string">&quot;Release&quot;</span></span><br><span class="line">    <span class="string">&quot;MinSizeRel&quot;</span> <span class="string">&quot;RelWithDebInfo&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (build_type)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(cmake_examples_build_type main.cpp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>cmake gui 本电脑装在 qt 内</p>
<h1 id="g-compile-flags">G compile flags</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set a default C++ compile flag</span></span><br><span class="line"><span class="comment"># To set additional default compile flags you can add the following to your top level CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span> (CMAKE_CXX_FLAGS <span class="string">&quot;$&#123;CMAKE_CXX_FLAGS&#125; -DEX2&quot;</span> CACHE <span class="keyword">STRING</span> <span class="string">&quot;Set C++ Compiler Flags&quot;</span> FORCE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (compile_flags)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(cmake_examples_compile_flags main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># compile flag</span></span><br><span class="line"><span class="keyword">target_compile_definitions</span>(cmake_examples_compile_flags </span><br><span class="line">    PRIVATE EX3</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h1 id="h-third-party-lib">H third party lib</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (third_party_include)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># find a boost install with the libraries filesystem and system</span></span><br><span class="line"><span class="comment"># Boost - Name of the library. This is part of used to find the module file FindBoost.cmake</span></span><br><span class="line"><span class="comment"># 1.46.1 - The minimum version of boost to find</span></span><br><span class="line"><span class="comment"># REQUIRED - Tells the module that this is required and to fail if it cannot be found</span></span><br><span class="line"><span class="comment"># COMPONENTS - The list of components to find in the library.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(Boost <span class="number">1.46</span>.<span class="number">1</span> REQUIRED COMPONENTS filesystem system)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if boost was found</span></span><br><span class="line"><span class="keyword">if</span>(Boost_FOUND)</span><br><span class="line">    <span class="keyword">message</span> (<span class="string">&quot;boost found&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">message</span> (FATAL_ERROR <span class="string">&quot;Cannot find Boost&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(third_party_include main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link against the boost libraries</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>( third_party_include</span><br><span class="line">    PRIVATE</span><br><span class="line">        Boost::filesystem</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>This will search for CMake modules in the format "FindXXX.cmake" from the list of folders in <code>CMAKE_MODULE_PATH</code>. On linux the default search path will include <code>/usr/share/cmake/Modules</code>.</p>
<p>一些变量是 package specific, 需要查看FindXXX.cmake</p>
<h1 id="i-compile-with-clang">I compile with clang</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set the minimum version of CMake that can be used</span></span><br><span class="line"><span class="comment"># To find the cmake version run</span></span><br><span class="line"><span class="comment"># $ cmake --version</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_cmake)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_cmake main.cpp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>CMAKE_C_COMPILER - The program used to compile c code.</li>
<li>CMAKE_CXX_COMPILER - The program used to compile c++ code.</li>
<li>CMAKE_LINKER - The program used to link your binary.</li>
</ul>
<p><code>cmake .. -DCMAKE_C_COMPILER=clang-3.6 -DCMAKE_CXX_COMPILER=clang++-3.6</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake .. -DCMAKE_C_COMPILER=/opt/local/bin/clang -DCMAKE_CXX_COMPILER=/opt/local/bin/clang++</span><br></pre></td></tr></table></figure>
<h1 id="j-ninja">J ninja</h1>
<p><code>cmake .. -G Ninja</code></p>
<h1 id="k-import-target">K import target</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (imported_targets)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># find a boost install with the libraries filesystem and system</span></span><br><span class="line"><span class="keyword">find_package</span>(Boost <span class="number">1.46</span>.<span class="number">1</span> REQUIRED COMPONENTS filesystem system)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if boost was found</span></span><br><span class="line"><span class="keyword">if</span>(Boost_FOUND)</span><br><span class="line">    <span class="keyword">message</span> (<span class="string">&quot;boost found&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">message</span> (FATAL_ERROR <span class="string">&quot;Cannot find Boost&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(imported_targets main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link against the boost libraries</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>( imported_targets</span><br><span class="line">    PRIVATE</span><br><span class="line">        Boost::filesystem</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="l-cpp-standard">L cpp standard</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">2.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_cpp11)</span><br><span class="line"></span><br><span class="line"><span class="comment"># try conditional compilation</span></span><br><span class="line"><span class="keyword">include</span>(CheckCXXCompilerFlag)</span><br><span class="line"><span class="comment"># The line include(CheckCXXCompilerFlag) tells CMake to include this function to make it available for use.</span></span><br><span class="line">CHECK_CXX_COMPILER_FLAG(<span class="string">&quot;-std=c++11&quot;</span> COMPILER_SUPPORTS_CXX11)</span><br><span class="line">CHECK_CXX_COMPILER_FLAG(<span class="string">&quot;-std=c++0x&quot;</span> COMPILER_SUPPORTS_CXX0X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check results and add flag</span></span><br><span class="line"><span class="keyword">if</span>(COMPILER_SUPPORTS_CXX11)<span class="comment">#</span></span><br><span class="line">    <span class="keyword">set</span>(CMAKE_CXX_FLAGS <span class="string">&quot;$&#123;CMAKE_CXX_FLAGS&#125; -std=c++11&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span>(COMPILER_SUPPORTS_CXX0X)<span class="comment">#</span></span><br><span class="line">    <span class="keyword">set</span>(CMAKE_CXX_FLAGS <span class="string">&quot;$&#123;CMAKE_CXX_FLAGS&#125; -std=c++0x&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;The compiler $&#123;CMAKE_CXX_COMPILER&#125; has no C++11 support. Please use a different C++ compiler.&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_cpp11 main.cpp)</span><br></pre></td></tr></table></figure>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_cpp11)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the C++ standard to C++ 11</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)</span><br><span class="line"><span class="comment"># Setting the CMAKE_CXX_STANDARD variable causes the CXX_STANDARD property on all targets. This causes CMake to set the appropriate flag at compille time.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_cpp11 main.cpp)</span><br></pre></td></tr></table></figure>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (hello_cpp11)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(hello_cpp11 main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the C++ standard to the appropriate standard for using auto</span></span><br><span class="line"><span class="keyword">target_compile_features</span>(hello_cpp11 PUBLIC cxx_auto_type)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the list of known compile features for this version of CMake</span></span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;List of compile features: $&#123;CMAKE_CXX_COMPILE_FEATURES&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>As with other <code>target_*</code> functions, you can specify the scope of the feature for the selected target. This populates the <a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.1/prop_tgt/INTERFACE_COMPILE_FEATURES.html#prop_tgt:INTERFACE_COMPILE_FEATURES">INTERFACE_COMPILE_FEATURES</a> property for the target.</p>
<p>The list of available features can be found from the <a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.1/variable/CMAKE_CXX_COMPILE_FEATURES.html#variable:CMAKE_CXX_COMPILE_FEATURES">CMAKE_CXX_COMPILE_FEATURES</a> variable. You can obtain a list of the available features using the following code:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">message</span>(<span class="string">&quot;List of compile features: $&#123;CMAKE_CXX_COMPILE_FEATURES&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="library">library</h1>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(subprojects)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add sub directories</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(sublibrary1)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(sublibrary2)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(subbinary)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################# subbinary</span></span><br><span class="line"><span class="keyword">project</span>(subbinary)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Link the static library from subproject1 using its alias sub::lib1</span></span><br><span class="line"><span class="comment"># Link the header only library from subproject2 using its alias sub::lib2</span></span><br><span class="line"><span class="comment"># This will cause the include directories for that target to be added to this project</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">    sub::lib1</span><br><span class="line">    sub::lib2</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################# sublibrary1</span></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (sublibrary1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a library with the above sources</span></span><br><span class="line"><span class="keyword">add_library</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> src/sublib1.cpp)</span><br><span class="line"><span class="keyword">add_library</span>(sub::lib1 ALIAS <span class="variable">$&#123;PROJECT_NAME&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>( <span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">    PUBLIC <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################# sublibrary2</span></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (sublibrary2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> INTERFACE)</span><br><span class="line"><span class="keyword">add_library</span>(sub::lib2 ALIAS <span class="variable">$&#123;PROJECT_NAME&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">    INTERFACE</span><br><span class="line">        <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/<span class="keyword">include</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">├── CMakeLists.txt</span><br><span class="line">├── subbinary</span><br><span class="line">│   ├── CMakeLists.txt</span><br><span class="line">│   └── main.cpp</span><br><span class="line">├── sublibrary1</span><br><span class="line">│   ├── CMakeLists.txt</span><br><span class="line">│   ├── include</span><br><span class="line">│   │   └── sublib1</span><br><span class="line">│   │       └── sublib1.h</span><br><span class="line">│   └── src</span><br><span class="line">│       └── sublib1.cpp</span><br><span class="line">└── sublibrary2</span><br><span class="line">    ├── CMakeLists.txt</span><br><span class="line">    └── include</span><br><span class="line">        └── sublib2</span><br><span class="line">            └── sublib2.h</span><br></pre></td></tr></table></figure>
<h1 id="code-generationprotobuf">code generation(protobuf)</h1>
<p>During the call to cmake it is possible to create files that use variables from the CMakeLists.txt and cmake cache. During CMake generation the file is copied to a new location and any cmake variables are replaced.</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (cf_example)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set a project version</span></span><br><span class="line"><span class="keyword">set</span> (cf_example_VERSION_MAJOR <span class="number">0</span>)</span><br><span class="line"><span class="keyword">set</span> (cf_example_VERSION_MINOR <span class="number">2</span>)</span><br><span class="line"><span class="keyword">set</span> (cf_example_VERSION_PATCH <span class="number">1</span>)</span><br><span class="line"><span class="keyword">set</span> (cf_example_VERSION <span class="string">&quot;$&#123;cf_example_VERSION_MAJOR&#125;.$&#123;cf_example_VERSION_MINOR&#125;.$&#123;cf_example_VERSION_PATCH&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Call configure files on ver.h.in to set the version.</span></span><br><span class="line"><span class="comment"># Uses the standard $&#123;VARIABLE&#125; syntax in the file</span></span><br><span class="line"><span class="keyword">configure_file</span>(ver.h.in <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span>/ver.h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># configure the path.h.in file.</span></span><br><span class="line"><span class="comment"># This file can only use the @VARIABLE@ syntax in the file</span></span><br><span class="line"><span class="keyword">configure_file</span>(path.h.in <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span>/path.h @ONLY)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(cf_example</span><br><span class="line">    main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># include the directory with the new files</span></span><br><span class="line"><span class="keyword">target_include_directories</span>( cf_example</span><br><span class="line">    PUBLIC</span><br><span class="line">        <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#ifndef __PATH_H__</span><br><span class="line">#define __PATH_H__</span><br><span class="line"></span><br><span class="line">// version variable that will be substituted by cmake</span><br><span class="line">// This shows an example using the @ variable type</span><br><span class="line">const char* path = &quot;@CMAKE_SOURCE_DIR@&quot;;</span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the project name</span></span><br><span class="line"><span class="keyword">project</span> (protobuf_example)</span><br><span class="line"><span class="comment"># 更改位置</span></span><br><span class="line"><span class="keyword">set</span>(Protobuf_PROTOC_EXECUTABLE <span class="string">&quot;/usr/local/Cellar/protobuf/21.9_1/bin/protoc&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># find the protobuf compiler and libraries</span></span><br><span class="line"><span class="keyword">find_package</span>(Protobuf REQUIRED)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if protobuf was found</span></span><br><span class="line"><span class="keyword">if</span>(PROTOBUF_FOUND)</span><br><span class="line">    <span class="keyword">message</span> (<span class="string">&quot;protobuf found&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">message</span> (FATAL_ERROR <span class="string">&quot;Cannot find Protobuf&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate the .h and .cxx files</span></span><br><span class="line">PROTOBUF_GENERATE_CPP(PROTO_SRCS PROTO_HDRS AddressBook.proto)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print path to generated files</span></span><br><span class="line"><span class="keyword">message</span> (<span class="string">&quot;PROTO_SRCS = $&#123;PROTO_SRCS&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">message</span> (<span class="string">&quot;PROTO_HDRS = $&#123;PROTO_HDRS&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add an executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(protobuf_example</span><br><span class="line">    main.cpp</span><br><span class="line">    <span class="variable">$&#123;PROTO_SRCS&#125;</span></span><br><span class="line">    <span class="variable">$&#123;PROTO_HDRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_include_directories</span>(protobuf_example</span><br><span class="line">    PUBLIC</span><br><span class="line">    <span class="variable">$&#123;PROTOBUF_INCLUDE_DIRS&#125;</span></span><br><span class="line">    <span class="variable">$&#123;CMAKE_CURRENT_BINARY_DIR&#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># link the exe against the libraries</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(protobuf_example</span><br><span class="line">    PUBLIC</span><br><span class="line">    <span class="variable">$&#123;PROTOBUF_LIBRARIES&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> tutorial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">message </span><span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">string</span> name = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="type">int32</span> id = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">optional</span> <span class="type">string</span> email = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">enum </span><span class="title class_">PhoneType</span> &#123;</span><br><span class="line">    MOBILE = <span class="number">0</span>;</span><br><span class="line">    HOME = <span class="number">1</span>;</span><br><span class="line">    WORK = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">message </span><span class="title class_">PhoneNumber</span> &#123;</span><br><span class="line">    <span class="keyword">required</span> <span class="type">string</span> number = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">optional</span> PhoneType type = <span class="number">2</span> [default = HOME];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">repeated</span> PhoneNumber phone = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">message </span><span class="title class_">AddressBook</span> &#123;</span><br><span class="line">  <span class="keyword">repeated</span> Person person = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="static-check">static check</h1>
<h2 id="clang-analyzer">clang-analyzer</h2>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(cppcheck_analysis)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use debug build as recommended</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_BUILD_TYPE Debug)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Have cmake create a compile database</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_EXPORT_COMPILE_COMMANDS <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add sub directories</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(subproject1)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(subproject2)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scan-build-3.6 cmake ..</span><br><span class="line">scan-build-3.6 make</span><br></pre></td></tr></table></figure>
<h2 id="clang-format">clang-format</h2>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(cppcheck_analysis)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a custom CMake Modules directory</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_MODULE_PATH <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/cmake/modules</span><br><span class="line">                      <span class="variable">$&#123;CMAKE_MODULE_PATH&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add sub directories</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(subproject1)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(subproject2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CLANG_FORMAT_BIN_NAME clang-format-<span class="number">3.6</span>)</span><br><span class="line"><span class="keyword">set</span>(CLANG_FORMAT_EXCLUDE_PATTERNS  <span class="string">&quot;build/&quot;</span> <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>)</span><br><span class="line"><span class="keyword">find_package</span>(ClangFormat)</span><br></pre></td></tr></table></figure>
<h1 id="unit-test">unit test</h1>
<h1 id="package-management">package management</h1>
<h2 id="intro">intro</h2>
<p>Using your system provided packages is one of the oldest and most common form of package management solutions. For this, you use your systems package installer (e.g. apt, yum) to install libraries and headers into common locations. CMake can then use the <code>find_package()</code> function to search for these and make them available to your program.</p>
<h2 id="vendoring-code">vendoring code</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tree .</span><br><span class="line">├── 3rd_party</span><br><span class="line">│   └── catch2</span><br><span class="line">│       ├── catch2</span><br><span class="line">│       │   └── catch.hpp</span><br><span class="line">│       └── CMakeLists.txt</span><br><span class="line">├── CMakeLists.txt</span><br><span class="line">├── src</span><br><span class="line">│   └── example.cpp</span><br></pre></td></tr></table></figure>
<p>If these projects support CMake directly, it may be possible to do <code>add_subdirectory()</code> on the libraries folder and have that project build and be made available to your code.</p>
<p>If the third party code doesn’t support CMake, you may need to create a "shim" layer on top of the project to allow it to be build and discovered from CMake.</p>
<h2 id="external-project">external project</h2>
<p>A simple example of an external project is as follows:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(ExternalProject)</span><br><span class="line">ExternalProject_Add(googletest</span><br><span class="line">  URL    https://github.com/google/googletest/archive/bfc0ffc8a698072c794ae7299db9cb6866f4c0bc.tar.gz_</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Once added you will have a target <code>googletest</code> which will attempt to download, build, and install google test when your build your project.</p>
<h1 id="tree-example">tree example</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── CMakeLists.txt</span><br><span class="line">├── LICENSE</span><br><span class="line">├── README.md</span><br><span class="line">├── cmake</span><br><span class="line">│   ├── diagon_fuzzer.cmake <span class="comment">#.cmake?</span></span><br><span class="line">│   └── diagon_test.cmake</span><br><span class="line">├── favicon.png</span><br><span class="line">├── snap</span><br><span class="line">│   ├── gui</span><br><span class="line">│   │   ├── diagon.desktop</span><br><span class="line">│   │   └── diagon.png</span><br><span class="line">│   └── snapcraft.yaml</span><br><span class="line">├── src <span class="comment"># .hpp?</span></span><br><span class="line">│   ├── api.cpp</span><br><span class="line">│   ├── api.hpp</span><br><span class="line">│   ├── environment.h.in</span><br><span class="line">│   ├── favicon-32x32.png</span><br><span class="line">│   ├── filesystem.hpp</span><br><span class="line">│   ├── fuzzer.cpp</span><br><span class="line">│   ├── google-analytics.html</span><br><span class="line">│   ├── index.html</span><br><span class="line">│   ├── input_output_test.cpp</span><br><span class="line">│   ├── main.cpp</span><br><span class="line">│   ├── run_diagon.sh</span><br><span class="line">│   ├── screen <span class="comment">#target_link_libraries add_library</span></span><br><span class="line">│   │   ├── CMakeLists.txt</span><br><span class="line">│   │   ├── Screen.cpp</span><br><span class="line">│   │   └── Screen.h</span><br><span class="line">│   ├── style.css</span><br><span class="line">│   ├── translator</span><br><span class="line">│   │   ├── Factory.cpp</span><br><span class="line">│   │   ├── Factory.h</span><br><span class="line">│   │   ├── Translator.cpp</span><br><span class="line">│   │   ├── Translator.h</span><br><span class="line">│   │   ├── antlr_error_listener.cpp</span><br><span class="line">│   │   ├── antlr_error_listener.h</span><br><span class="line">│   │   ├── flowchart</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   ├── Flowchart.cpp</span><br><span class="line">│   │   │   └── Flowchart.g4</span><br><span class="line">│   │   ├── frame</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   └── Frame.cpp</span><br><span class="line">│   │   ├── grammar</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   └── Grammar.cpp</span><br><span class="line">│   │   ├── graph_dag</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   ├── GraphDAG.cpp</span><br><span class="line">│   │   │   └── dag_to_graph.cpp</span><br><span class="line">│   │   ├── graph_planar</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   ├── GraphPlanar.cpp</span><br><span class="line">│   │   │   ├── GraphPlanar.g4</span><br><span class="line">│   │   │   └── GraphPlanarEmpty.cpp</span><br><span class="line">│   │   ├── math</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   ├── Math.cpp</span><br><span class="line">│   │   │   └── Math.g4</span><br><span class="line">│   │   ├── sequence</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   ├── Graph.cpp</span><br><span class="line">│   │   │   ├── Graph.hpp</span><br><span class="line">│   │   │   ├── Sequence.cpp</span><br><span class="line">│   │   │   ├── Sequence.g4</span><br><span class="line">│   │   │   └── Sequence.hpp</span><br><span class="line">│   │   ├── table</span><br><span class="line">│   │   │   ├── CMakeLists.txt</span><br><span class="line">│   │   │   └── Table.cpp</span><br><span class="line">│   │   └── tree</span><br><span class="line">│   │       ├── CMakeLists.txt</span><br><span class="line">│   │       └── Tree.cpp</span><br><span class="line">│   └── util.hpp</span><br><span class="line">├── <span class="built_in">test</span></span><br><span class="line">│   └── Flowchart</span><br><span class="line">│       ├── example</span><br><span class="line">│       │   ├── input</span><br><span class="line">│       │   └── output</span><br><span class="line">│       └── loong-breakable-string</span><br><span class="line">│           ├── input</span><br><span class="line">│           └── output</span><br><span class="line">└── tools</span><br><span class="line">    ├── CMakeLists.txt</span><br><span class="line">    ├── format.sh</span><br><span class="line">    ├── license_headers.cpp</span><br><span class="line">    └── logo.png</span><br><span class="line"></span><br><span class="line">20 directories, 66 files</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2023/01/07/cmake/">https://sinos_wei.gitee.io/2023/01/07/cmake/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/cover/IMG_2495.JPG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/01/04/cpp20%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><img class="next-cover" src="/img/cover/IMG_2410.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">cpp20读书笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.PNG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SinosGray"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/SinosGray" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#mac-vscode-cmake-llvm%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">mac vscode cmake llvm开发环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%85"><span class="toc-number">1.1.</span> <span class="toc-text">包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vs-%E6%8F%92%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">vs 插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.</span> <span class="toc-text">流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#a-intro"><span class="toc-number">2.</span> <span class="toc-text">A intro</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b-header"><span class="toc-number">3.</span> <span class="toc-text">B header</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cmake-variables"><span class="toc-number">3.1.</span> <span class="toc-text">cmake variables</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#c-static-library"><span class="toc-number">4.</span> <span class="toc-text">C static library</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#d-shared-library"><span class="toc-number">5.</span> <span class="toc-text">D shared library</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#e-installation"><span class="toc-number">6.</span> <span class="toc-text">E installation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#f-build-type"><span class="toc-number">7.</span> <span class="toc-text">F build type</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#g-compile-flags"><span class="toc-number">8.</span> <span class="toc-text">G compile flags</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#h-third-party-lib"><span class="toc-number">9.</span> <span class="toc-text">H third party lib</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#i-compile-with-clang"><span class="toc-number">10.</span> <span class="toc-text">I compile with clang</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#j-ninja"><span class="toc-number">11.</span> <span class="toc-text">J ninja</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#k-import-target"><span class="toc-number">12.</span> <span class="toc-text">K import target</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#l-cpp-standard"><span class="toc-number">13.</span> <span class="toc-text">L cpp standard</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#library"><span class="toc-number">14.</span> <span class="toc-text">library</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#code-generationprotobuf"><span class="toc-number">15.</span> <span class="toc-text">code generation(protobuf)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#static-check"><span class="toc-number">16.</span> <span class="toc-text">static check</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#clang-analyzer"><span class="toc-number">16.1.</span> <span class="toc-text">clang-analyzer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#clang-format"><span class="toc-number">16.2.</span> <span class="toc-text">clang-format</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#unit-test"><span class="toc-number">17.</span> <span class="toc-text">unit test</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#package-management"><span class="toc-number">18.</span> <span class="toc-text">package management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#intro"><span class="toc-number">18.1.</span> <span class="toc-text">intro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vendoring-code"><span class="toc-number">18.2.</span> <span class="toc-text">vendoring code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#external-project"><span class="toc-number">18.3.</span> <span class="toc-text">external project</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tree-example"><span class="toc-number">19.</span> <span class="toc-text">tree example</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/07/cmake/" title="cmake"><img src="/img/cover/IMG_2495.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cmake"/></a><div class="content"><a class="title" href="/2023/01/07/cmake/" title="cmake">cmake</a><time datetime="2023-01-12T08:44:02.876Z" title="Updated 2023-01-12 16:44:02">2023-01-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/04/OS3pieces%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="OS3pieces读书笔记"><img src="/img/cover/IMG_0127.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OS3pieces读书笔记"/></a><div class="content"><a class="title" href="/2022/06/04/OS3pieces%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="OS3pieces读书笔记">OS3pieces读书笔记</a><time datetime="2023-01-10T10:51:16.295Z" title="Updated 2023-01-10 18:51:16">2023-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/04/cpp20%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="cpp20读书笔记"><img src="/img/cover/IMG_2410.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cpp20读书笔记"/></a><div class="content"><a class="title" href="/2023/01/04/cpp20%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="cpp20读书笔记">cpp20读书笔记</a><time datetime="2023-01-08T08:52:11.949Z" title="Updated 2023-01-08 16:52:11">2023-01-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/31/ai/" title="ai"><img src="/img/cover/IMG_0800.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ai"/></a><div class="content"><a class="title" href="/2022/12/31/ai/" title="ai">ai</a><time datetime="2023-01-03T12:55:00.573Z" title="Updated 2023-01-03 20:55:00">2023-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="tcpip详解读书笔记"><img src="/img/cover/IMG_3032.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="tcpip详解读书笔记"/></a><div class="content"><a class="title" href="/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="tcpip详解读书笔记">tcpip详解读书笔记</a><time datetime="2022-12-30T03:02:34.287Z" title="Updated 2022-12-30 11:02:34">2022-12-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>