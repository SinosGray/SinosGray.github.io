<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Category: 读书笔记 | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="tcpip详解读书笔记">
<meta property="og:url" content="https://sinos_wei.gitee.io/2022/12/331cfaa59458.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/IMG_8779.jpg">
<meta property="article:published_time" content="2022-12-17T07:59:07.000Z">
<meta property="article:modified_time" content="2023-06-29T11:34:54.496Z">
<meta property="article:author" content="Sinos">
<meta property="article:tag" content="tcp">
<meta property="article:tag" content="ipv6">
<meta property="article:tag" content="addresses">
<meta property="article:tag" content="ipv4">
<meta property="article:tag" content="internet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/IMG_8779.jpg"><link rel="shortcut icon" href="/img/cover/IMG_2242.jpg"><link rel="canonical" href="https://sinos_wei.gitee.io/2022/12/331cfaa59458.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Category: 读书笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-29 19:34:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cover/IMG_2242.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">167</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/IMG_8779.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Sinos_wei's blog"><span class="site-name">Sinos_wei's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">tcpip详解读书笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-12-17T07:59:07.000Z" title="Created 2022-12-17 15:59:07">2022-12-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-06-29T11:34:54.496Z" title="Updated 2023-06-29 19:34:54">2023-06-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="tcpip详解读书笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>

</blockquote>
<span id="more"></span>
<h1 id="chapter-1-introduction">Chapter 1 Introduction</h1>
<h2 id="architectural-principles">1.1 Architectural Principles</h2>
<h3 id="packets-connections-and-datagrams">1.1.1 Packets, Connections, and Datagrams</h3>
<p>分组交换-&gt;多路复用</p>
<p>FIFO-&gt;统计复用</p>
<p>数据报: 所有识别信息都位于分组中而不是交换机中</p>
<p>消息边界: 大部分数据报协议是保留消息边界的(UDP), 但是在电路交换和虚电路网络中, 不会保留消息边界(TCP)</p>
<h3 id="the-end-to-end-argument-and-fate-sharing">1.1.2 The End-to-End Argument and Fate Sharing</h3>
<p>端到端论点: 只有在通信系统端角度的应用知识的帮助下，才能完全和正确地实现问题中提到的功能。因此，作为通信自身的一个特点，不可能提供有疑问的功能。（有时， 通信系统提供的一个功能不完整的版本可能用于提高性能。）</p>
<p>命运共享: 建议所有必要的状态放在通信端点</p>
<h3 id="error-control-and-flow-control">1.1.3 Error Control and Flow Control</h3>
<p>差错控制: 网络中, 尽力而为</p>
<p>流量控制: 端</p>
<h2 id="design-and-implementation">1.2 Design and Implementation</h2>
<h3 id="layering">1.2.1 Layering</h3>
<p>从底层到高层数字递增</p>
<p>5 层 TCP/IP</p>
<p>7 层 OSI</p>
<h3 id="multiplexing-demultiplexing-and-encapsulation-in-layered-implementations">1.2.2 Multiplexing, Demultiplexing, and Encapsulation in Layered Implementations</h3>
<p>PDU 协议数据单元</p>
<p>switch, bridge 对网络层透明</p>
<h2 id="the-architecture-and-protocols-of-the-tcpip-suite">1.3 The Architecture and Protocols of the TCP/IP Suite</h2>
<h3 id="the-arpanet-reference-model">1.3.1 The ARPANET Reference Model</h3>
<p>三种类型 ip 地址:</p>
<p>单播, 广播, 组播</p>
<p>ICMP, IGMP</p>
<p>DCCP, SCTP</p>
<h3 id="multiplexing-demultiplexing-and-encapsulation-in-tcpip">1.3.2 Multiplexing, Demultiplexing, and Encapsulation in TCP/IP</h3>
<p>每层都有一个标识符</p>
<h3 id="port-numbers">1.3.3 Port Numbers</h3>
<p>熟知端口号: 0~1023</p>
<p>注册端口号: 1024~49151, 它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。</p>
<p>私有端口号: 49152~65535, 理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p>
<p>奇数端口号</p>
<h3 id="names-addresses-and-the-dns">1.3.4 Names, Addresses, and the DNS</h3>
<h2 id="internets-intranets-and-extranets">1.4 Internets, Intranets, and Extranets</h2>
<h2 id="designing-applications">1.5 Designing Applications</h2>
<h3 id="clientserver">1.5.1 Client/Server</h3>
<h3 id="peer-to-peer">1.5.2 Peer-to-Peer</h3>
<h3 id="application-programming-interfaces-apis">1.5.3 Application Programming Interfaces (APIs)</h3>
<h2 id="standardization-process">1.6 Standardization Process</h2>
<h3 id="request-for-comments-rfc">1.6.1 Request for Comments (RFC)</h3>
<h3 id="other-standards">1.6.2 Other Standards</h3>
<h2 id="implementations-and-software-distributions">1.7 Implementations and Software Distributions</h2>
<h2 id="attacks-involving-the-internet-architecture">1.8 Attacks Involving the Internet Architecture</h2>
<h2 id="summary">1.9 Summary</h2>
<h2 id="references">1.10 References</h2>
<h1 id="chapter-2-the-internet-address-architecture">Chapter 2 The Internet Address Architecture</h1>
<h2 id="introduction">2.1 Introduction</h2>
<h2 id="expressing-ip-addresses">2.2 Expressing IP Addresses</h2>
<p>ipv4: 4*8 = 32</p>
<p>ipv6: 8*16 = 128</p>
<p>ipv6 写法标准:</p>
<ol type="1">
<li>一个块中前导的零不必书写。在前面的例子中，地址可写为 5f05:2000:80ad:5800:58:800:2023:1d71。</li>
<li>全零的块可以省略，并用符号：代替。例如，IPv6 地址0:0:0:0:0:0:0:1可简写为 ::1. 同样，地址 2001:0db8:0:0:0:0:0:2可简写为 2001:db8::2。为了避免出现歧义，一个 IPv6 地址 中符号 :: 只能使用一次。</li>
<li>在IPv6 格式中嵌入IPv4 地址可使用混合符号形式，紧接着 IPv4 部分的地址块的值为ffff，地址的其余部分使用点分四组格式。例如，IPv6 地址 ::ffff:10.0.0.1可表示 IPv4 地址 10.0.0.1。它被称为IPv4 映射的 IPv6 地址。</li>
<li>IPv6 地址的低 32 位通常采用点分四组表示法。因此，IPv6 地址 ::0102:f001 相当于地址：::1.2.240.1。它被称为IPv4 兼容的 IPv6 地址。需要注意，IPv4 兼容地址与IPv4 映射地址不同；它们只是在能用类似 IPv4 地址的方式书写或由软件处理方面给人以兼容的感觉。这种地 址最初用于 IPv4 和 IPv6 之间的过渡计划，但现在不再需要 [RFC4291]。</li>
<li>前导的零必须压缩（例如，2001:0db8::0022变成 2001:db8::22)</li>
<li>:: 只能用于影响最大的地方（压缩最多的零)，但并不只是针对16位的块。如果多个块中包含等长度的零，顺序靠前的块将被替换为 ::</li>
<li>a 到 f 的十六进制数字应该用小写表示。</li>
</ol>
<p>在大多数情况下，我们会遵守这些规则。</p>
<h2 id="basic-ip-address-structure">2.3 Basic IP Address Structure</h2>
<h3 id="classful-addressing">2.3.1 Classful Addressing</h3>
<p>(192 是 C 类地址)</p>
<p>ABC 用于单播地址</p>
<p>有几个地址通常不作为单播地址使用, 特别是第一个和最后一个, 一般要-2</p>
<figure>
<img src="https://tva1.sinaimg.cn/large/008vxvgGly1h9ib4d26ecj30v00i2wfz.jpg" alt="截屏2022-12-27 13.32.26" /><figcaption aria-hidden="true">截屏2022-12-27 13.32.26</figcaption>
</figure>
<h3 id="subnet-addressing">2.3.2 Subnet Addressing</h3>
<p>将主机号划分为子网 id 和主机 id</p>
<h3 id="subnet-masks">2.3.3 Subnet Masks</h3>
<p>子网掩码用来划分子网id和主机id</p>
<p>外部 router 不关心子网掩码</p>
<h3 id="variable-length-subnet-masks-vlsm">2.3.4 Variable-Length Subnet Masks (VLSM)</h3>
<p>每个子网可以使用不同长度的子网掩码</p>
<h3 id="broadcast-addresses">2.3.5 Broadcast Addresses</h3>
<p>(子网广播地址)</p>
<p>即网络id 子网 id 不变, 将主机 id 全部设置为 1</p>
<p>但是这种定向广播是又问同样的, 在 internet 中被禁用</p>
<p>本地网络广播; 255.255.255.255, 不会被路由器转发, 但是同一网络中的其他主机会收到</p>
<h3 id="ipv6-addresses-and-interface-identifiers">2.3.6 IPv6 Addresses and Interface Identifiers</h3>
<h2 id="cidrclassless-inter-domain-routing-and-aggregation">2.4 CIDR(Classless Inter-Domain Routing) and Aggregation</h2>
<p>为了解决两个问题: ip 不足, 以及路由表过大</p>
<h3 id="prefixes">2.4.1 Prefixes</h3>
<p>类似 VLSM, CIDR掩码可以采用任意长度, 这个掩码是全球路由系统可见的, 这个又叫网络前缀</p>
<h3 id="aggregation-聚合">2.4.2 Aggregation 聚合</h3>
<p>分层路由: ip 地址与路由器的拓扑位置有关</p>
<p>在 internet 中, 通过将相邻的多个 ip 前缀合并为一个短前缀的过程叫做聚合</p>
<h2 id="special-use-addresses">2.5 Special-Use Addresses</h2>
<p>0.0.0.0/8 本地主机</p>
<p>127.0.0.1 主机回送地址</p>
<p>172.16.0.0/12, 192.168.0.0/16专用网络, 内联网地址, 不会出现在公共网中</p>
<p>255.255.255.255/32 本地网络广播地址</p>
<h3 id="addressing-ipv4ipv6-translators">2.5.1 Addressing IPv4/IPv6 Translators</h3>
<p>嵌入 ipv4 的 ipv6 地址</p>
<h3 id="multicast-addresses">2.5.2 Multicast Addresses</h3>
<p>ASM 任意源组播</p>
<p>SSM 特定组播, 每个组只使用一个方发送方</p>
<h3 id="ipv4-multicast-addresses">2.5.3 IPv4 Multicast Addresses</h3>
<h3 id="ipv6-multicast-addresses">2.5.4 IPv6 Multicast Addresses</h3>
<h3 id="anycast-addresses">2.5.5 Anycast Addresses</h3>
<h2 id="allocation">2.6 Allocation</h2>
<h3 id="unicast">2.6.1 Unicast</h3>
<p>RIR(Regional Internet Registry) -&gt; ISP -&gt; 客户</p>
<ul>
<li>PA 供应商聚合</li>
<li>PI 供应商独立</li>
</ul>
<p>供应商倾向使用 PA, 因为可以进行聚合减小路由表, PI 一般需要额外收费</p>
<h3 id="multicast">2.6.2 Multicast</h3>
<h2 id="unicast-address-assignment">2.7 Unicast Address Assignment</h2>
<h3 id="single-providerno-networksingle-address">2.7.1 Single Provider/No Network/Single Address</h3>
<p>单设备</p>
<h3 id="single-providersingle-networksingle-address">2.7.2 Single Provider/Single Network/Single Address</h3>
<p>LAN: 路由器</p>
<h3 id="single-providermultiple-networksmultiple-addresses">2.7.3 Single Provider/Multiple Networks/Multiple Addresses</h3>
<p>DMZ(demilitarized zone)</p>
<h3 id="multiple-providersmultiple-networksmultiple-addresses-multihoming">2.7.4 Multiple Providers/Multiple Networks/Multiple Addresses (Multihoming)</h3>
<h2 id="attacks-involving-ip-addresses">2.8 Attacks Involving IP Addresses</h2>
<h2 id="summary-1">2.9 Summary</h2>
<h2 id="references-1">2.10 References</h2>
<h1 id="chapter-3-link-layer">Chapter 3 Link Layer</h1>
<h2 id="introduction-1">3.1 Introduction</h2>
<h2 id="ethernet-and-the-ieee-802-lanman-standards">3.2 Ethernet and the IEEE 802 LAN/MAN Standards</h2>
<h3 id="the-ieee-802-lanman-standards">3.2.1 The IEEE 802 LAN/MAN Standards</h3>
<h3 id="the-ethernet-frame-format">3.2.2 The Ethernet Frame Format</h3>
<h4 id="pq-virtual-lans-and-qos-tagging">3.2.3 802.1p/q: Virtual LANs and QoS Tagging</h4>
<h5 id="ax-link-aggregation-formerly-802.3ad">3.2.4 802.1AX: Link Aggregation (Formerly 802.3ad)</h5>
<h3 id="full-duplex-power-save-autonegotiation-and-802.1x-flow-control">3.3 Full Duplex, Power Save, Autonegotiation, and 802.1X Flow Control</h3>
<h3 id="duplex-mismatch">3.3.1 Duplex Mismatch</h3>
<h3 id="wake-on-lan-wol-power-saving-and-magic-packets">3.3.2 Wake-on LAN (WoL), Power Saving, and Magic Packets</h3>
<h3 id="link-layer-flow-control">3.3.3 Link-Layer Flow Control</h3>
<h2 id="bridges-and-switches">3.4 Bridges and Switches</h2>
<h3 id="spanning-tree-protocol-stp">3.4.1 Spanning Tree Protocol (STP)</h3>
<h4 id="ak-multiple-registration-protocol-mrp">3.4.2 802.1ak: Multiple Registration Protocol (MRP)</h4>
<h3 id="wireless-lansieee-802.11wi-fi">3.5 Wireless LANs—IEEE 802.11(Wi-Fi)</h3>
<h4 id="frames">3.5.1 802.11 Frames</h4>
<h3 id="power-save-mode-and-the-time-sync-function-tsf">3.5.2 Power Save Mode and the Time Sync Function (TSF)</h3>
<h4 id="media-access-control">3.5.3 802.11 Media Access Control</h4>
<h3 id="physical-layer-details-rates-channels-and-frequencies">3.5.4 Physical-Layer Details: Rates, Channels, and Frequencies</h3>
<h3 id="wi-fi-security">3.5.5 Wi-Fi Security</h3>
<h4 id="wi-fi-mesh-802.11s">3.5.6 Wi-Fi Mesh (802.11s)</h4>
<h2 id="point-to-point-protocol-ppp">3.6 Point-to-Point Protocol (PPP)</h2>
<h3 id="link-control-protocol-lcp">3.6.1 Link Control Protocol (LCP)</h3>
<h3 id="multilink-ppp-mp">3.6.2 Multilink PPP (MP)</h3>
<h3 id="compression-control-protocol-ccp">3.6.3 Compression Control Protocol (CCP)</h3>
<h3 id="ppp-authentication">3.6.4 PPP Authentication</h3>
<h3 id="network-control-protocols-ncps">3.6.5 Network Control Protocols (NCPs)</h3>
<h3 id="header-compression">3.6.6 Header Compression</h3>
<h3 id="example">3.6.7 Example</h3>
<h2 id="loopback">3.7 Loopback</h2>
<h2 id="mtu-and-path-mtu">3.8 MTU and Path MTU</h2>
<h2 id="tunneling-basics">3.9 Tunneling Basics</h2>
<h3 id="unidirectional-links">3.9.1 Unidirectional Links</h3>
<h2 id="attacks-on-the-link-layer">3.10 Attacks on the Link Layer</h2>
<h2 id="summary-2">3.11 Summary</h2>
<h2 id="references-2">3.12 References</h2>
<h1 id="chapter-4-arp-address-resolution-protocol">Chapter 4 ARP: Address Resolution Protocol</h1>
<h2 id="introduction-2">4.1 Introduction</h2>
<h2 id="an-example">4.2 An Example</h2>
<h3 id="direct-delivery-and-arp">4.2.1 Direct Delivery and ARP</h3>
<h2 id="arp-cache">4.3 ARP Cache</h2>
<h2 id="arp-frame-format">4.4 ARP Frame Format</h2>
<h2 id="arp-examples">4.5 ARP Examples</h2>
<h3 id="normal-example">4.5.1 Normal Example</h3>
<h3 id="arp-request-to-a-nonexistent-host">4.5.2 ARP Request to a Nonexistent Host</h3>
<h2 id="arp-cache-timeout">4.6 ARP Cache Timeout</h2>
<h2 id="proxy-arp">4.7 Proxy ARP</h2>
<h2 id="gratuitous-arp-and-address-conflict-detection-acd">4.8 Gratuitous ARP and Address Conflict Detection (ACD)</h2>
<h2 id="the-arp-command">4.9 The arp Command</h2>
<h2 id="using-arp-to-set-an-embedded-devices-ipv4-address">4.10 Using ARP to Set an Embedded Device’s IPv4 Address</h2>
<h2 id="attacks-involving-arp">4.11 Attacks Involving ARP</h2>
<h2 id="summary-3">4.12 Summary</h2>
<h2 id="references-3">4.13 References</h2>
<h1 id="chapter-5-the-internet-protocol-ip">Chapter 5 The Internet Protocol (IP)</h1>
<h2 id="introduction-3">5.1 Introduction</h2>
<h2 id="ipv4-and-ipv6-headers">5.2 IPv4 and IPv6 Headers</h2>
<h3 id="ip-header-fields">5.2.1 IP Header Fields</h3>
<h3 id="the-internet-checksum">5.2.2 The Internet Checksum</h3>
<h3 id="ds-field-and-ecn-formerly-called-the-tos-byte-or-ipv6-traffic-class">5.2.3 DS Field and ECN (Formerly Called the ToS Byte or IPv6 Traffic Class)</h3>
<h3 id="ip-options">5.2.4 IP Options</h3>
<h2 id="ipv6-extension-headers">5.3 IPv6 Extension Headers</h2>
<h3 id="ipv6-options">5.3.1 IPv6 Options</h3>
<h3 id="routing-header">5.3.2 Routing Header</h3>
<h3 id="fragment-header">5.3.3 Fragment Header</h3>
<h2 id="ip-forwarding">5.4 IP Forwarding</h2>
<h3 id="forwarding-table">5.4.1 Forwarding Table</h3>
<h3 id="ip-forwarding-actions">5.4.2 IP Forwarding Actions</h3>
<h3 id="examples">5.4.3 Examples</h3>
<h3 id="discussion">5.4.4 Discussion</h3>
<h2 id="mobile-ip">5.5 Mobile IP</h2>
<h3 id="the-basic-model-bidirectional-tunneling">5.5.1 The Basic Model: Bidirectional Tunneling</h3>
<h3 id="route-optimization-ro">5.5.2 Route Optimization (RO)</h3>
<h3 id="discussion-1">5.5.3 Discussion</h3>
<h2 id="host-processing-of-ip-datagrams">5.6 Host Processing of IP Datagrams</h2>
<h3 id="host-models">5.6.1 Host Models</h3>
<h3 id="address-selection">5.6.2 Address Selection</h3>
<h2 id="attacks-involving-ip">5.7 Attacks Involving IP</h2>
<h2 id="summary-4">5.8 Summary</h2>
<h2 id="references-4">5.9 References</h2>
<h1 id="chapter-6-system-configuration-dhcp-and-autoconfiguration">Chapter 6 System Configuration: DHCP and Autoconfiguration</h1>
<h2 id="introduction-4">6.1 Introduction</h2>
<h2 id="dynamic-host-configuration-protocol-dhcp">6.2 Dynamic Host Configuration Protocol (DHCP)</h2>
<h3 id="address-pools-and-leases">6.2.1 Address Pools and Leases</h3>
<h3 id="dhcp-and-bootp-message-format">6.2.2 DHCP and BOOTP Message Format</h3>
<h3 id="dhcp-and-bootp-options">6.2.3 DHCP and BOOTP Options</h3>
<h3 id="dhcp-protocol-operation">6.2.4 DHCP Protocol Operation</h3>
<h3 id="dhcpv6">6.2.5 DHCPv6</h3>
<h3 id="using-dhcp-with-relays">6.2.6 Using DHCP with Relays</h3>
<h3 id="dhcp-authentication">6.2.7 DHCP Authentication</h3>
<h3 id="reconfigure-extension">6.2.8 Reconfigure Extension</h3>
<h3 id="rapid-commit">6.2.9 Rapid Commit</h3>
<h3 id="location-information-lci-and-lost">6.2.10 Location Information (LCI and LoST)</h3>
<h3 id="mobility-and-handoff-information-mos-and-andsf">6.2.11 Mobility and Handoff Information (MoS and ANDSF)</h3>
<h3 id="dhcp-snooping">6.2.12 DHCP Snooping</h3>
<h2 id="stateless-address-autoconfiguration-slaac">6.3 Stateless Address Autoconfiguration (SLAAC)</h2>
<h3 id="dynamic-configuration-of-ipv4-link-local-addresses">6.3.1 Dynamic Configuration of IPv4 Link-Local Addresses</h3>
<h3 id="ipv6-slaac-for-link-local-addresses">6.3.2 IPv6 SLAAC for Link-Local Addresses</h3>
<h2 id="dhcp-and-dns-interaction">6.4 DHCP and DNS Interaction</h2>
<h2 id="ppp-over-ethernet-pppoe">6.5 PPP over Ethernet (PPPoE)</h2>
<h2 id="attacks-involving-system-configuration">6.6 Attacks Involving System Configuration</h2>
<h2 id="summary-5">6.7 Summary</h2>
<h2 id="references-5">6.8 References</h2>
<h1 id="chapter-7-firewalls-and-network-address-translation-nat">Chapter 7 Firewalls and Network Address Translation (NAT)</h1>
<h2 id="introduction-5">7.1 Introduction</h2>
<h2 id="firewalls">7.2 Firewalls</h2>
<h3 id="packet-filtering-firewalls">7.2.1 Packet-Filtering Firewalls</h3>
<h3 id="proxy-firewalls">7.2.2 Proxy Firewalls</h3>
<h2 id="network-address-translation-nat">7.3 Network Address Translation (NAT)</h2>
<h3 id="traditional-nat-basic-nat-and-napt">7.3.1 Traditional NAT: Basic NAT and NAPT</h3>
<h3 id="address-and-port-translation-behavior">7.3.2 Address and Port Translation Behavior</h3>
<h3 id="filtering-behavior">7.3.3 Filtering Behavior</h3>
<h3 id="servers-behind-nats">7.3.4 Servers behind NATs</h3>
<h3 id="hairpinning-and-nat-loopback">7.3.5 Hairpinning and NAT Loopback</h3>
<h3 id="nat-editors">7.3.6 NAT Editors</h3>
<h3 id="service-provider-nat-spnat-and-service-provider-ipv6-transition">7.3.7 Service Provider NAT (SPNAT) and Service Provider IPv6 Transition</h3>
<h2 id="nat-traversal">7.4 NAT Traversal</h2>
<h3 id="pinholes-and-hole-punching">7.4.1 Pinholes and Hole Punching</h3>
<h3 id="unilateral-self-address-fixing-unsaf">7.4.2 UNilateral Self-Address Fixing (UNSAF)</h3>
<h3 id="session-traversal-utilities-for-nat-stun">7.4.3 Session Traversal Utilities for NAT (STUN)</h3>
<h3 id="traversal-using-relays-around-nat-turn">7.4.4 Traversal Using Relays around NAT (TURN)</h3>
<h3 id="interactive-connectivity-establishment-ice">7.4.5 Interactive Connectivity Establishment (ICE)</h3>
<h2 id="configuring-packet-filtering-firewalls-and-nats">7.5 Configuring Packet-Filtering Firewalls and NATs</h2>
<h3 id="firewall-rules">7.5.1 Firewall Rules</h3>
<h3 id="nat-rules">7.5.2 NAT Rules</h3>
<h3 id="direct-interaction-with-nats-and-firewalls-upnp-nat-pmp-and-pcp">7.5.3 Direct Interaction with NATs and Firewalls: UPnP, NAT-PMP, and PCP</h3>
<h2 id="nat-for-ipv4ipv6-coexistence-and-transition">7.6 NAT for IPv4/IPv6 Coexistence and Transition</h2>
<h3 id="dual-stack-lite-ds-lite">7.6.1 Dual-Stack Lite (DS-Lite)</h3>
<h3 id="ipv4ipv6-translation-using-nats-and-algs">7.6.2 IPv4/IPv6 Translation Using NATs and ALGs</h3>
<h2 id="attacks-involving-firewalls-and-nats">7.7 Attacks Involving Firewalls and NATs</h2>
<h2 id="summary-6">7.8 Summary</h2>
<h2 id="references-6">7.9 References</h2>
<h1 id="chapter-8-icmpv4-and-icmpv6-internet-control-message-protocol">Chapter 8 ICMPv4 and ICMPv6: Internet Control Message Protocol</h1>
<h2 id="introduction-6">8.1 Introduction</h2>
<h3 id="encapsulation-in-ipv4-and-ipv6">8.1.1 Encapsulation in IPv4 and IPv6</h3>
<h2 id="icmp-messages">8.2 ICMP Messages</h2>
<h3 id="icmpv4-messages">8.2.1 ICMPv4 Messages</h3>
<h3 id="icmpv6-messages">8.2.2 ICMPv6 Messages</h3>
<h3 id="processing-of-icmp-messages">8.2.3 Processing of ICMP Messages</h3>
<h2 id="icmp-error-messages">8.3 ICMP Error Messages</h2>
<h3 id="extended-icmp-and-multipart-messages">8.3.1 Extended ICMP and Multipart Messages</h3>
<h3 id="destination-unreachable-icmpv4-type-3-icmpv6-type-1-and-packet-too-big-icmpv6-type-2">8.3.2 Destination Unreachable (ICMPv4 Type 3, ICMPv6 Type 1) and Packet Too Big (ICMPv6 Type 2)</h3>
<h3 id="redirect-icmpv4-type-5-icmpv6-type-137">8.3.3 Redirect (ICMPv4 Type 5, ICMPv6 Type 137)</h3>
<h3 id="icmp-time-exceeded-icmpv4-type-11-icmpv6-type-3">8.3.4 ICMP Time Exceeded (ICMPv4 Type 11, ICMPv6 Type 3)</h3>
<h3 id="parameter-problem-icmpv4-type-12-icmpv6-type-4">8.3.5 Parameter Problem (ICMPv4 Type 12, ICMPv6 Type 4)</h3>
<h2 id="icmp-queryinformational-messages">8.4 ICMP Query/Informational Messages</h2>
<h3 id="echo-requestreply-ping-icmpv4-types-08-icmpv6-types-129128">8.4.1 Echo Request/Reply (ping) (ICMPv4 Types 0/8, ICMPv6 Types 129/128)</h3>
<h3 id="router-discovery-router-solicitation-and-advertisement-icmpv4-types-9-10">8.4.2 Router Discovery: Router Solicitation and Advertisement (ICMPv4 Types 9, 10)</h3>
<h3 id="home-agent-address-discovery-requestreply-icmpv6-types-144145">8.4.3 Home Agent Address Discovery Request/Reply (ICMPv6 Types 144/145)</h3>
<h3 id="mobile-prefix-solicitationadvertisement-icmpv6-types-146147">8.4.4 Mobile Prefix Solicitation/Advertisement (ICMPv6 Types 146/147)</h3>
<h3 id="mobile-ipv6-fast-handover-messages-icmpv6-type-154">8.4.5 Mobile IPv6 Fast Handover Messages (ICMPv6 Type 154)</h3>
<h3 id="multicast-listener-queryreportdone-icmpv6-types-130131132">8.4.6 Multicast Listener Query/Report/Done (ICMPv6 Types 130/131/132)</h3>
<h3 id="version-2-multicast-listener-discovery-mldv2-icmpv6-type-143">8.4.7 Version 2 Multicast Listener Discovery (MLDv2) (ICMPv6 Type 143)</h3>
<h3 id="multicast-router-discovery-mrd-igmp-types-484950-icmpv6-types-151152153">8.4.8 Multicast Router Discovery (MRD) (IGMP Types 48/49/50, ICMPv6 Types 151/152/153)</h3>
<h2 id="neighbor-discovery-in-ipv6">8.5 Neighbor Discovery in IPv6</h2>
<h3 id="icmpv6-router-solicitation-and-advertisement-icmpv6-types-133-134">8.5.1 ICMPv6 Router Solicitation and Advertisement (ICMPv6 Types 133, 134)</h3>
<h3 id="icmpv6-neighbor-solicitation-and-advertisement-imcpv6-types-135-136">8.5.2 ICMPv6 Neighbor Solicitation and Advertisement (IMCPv6 Types 135, 136)</h3>
<h3 id="icmpv6-inverse-neighbor-discovery-solicitationadvertisement-icmpv6-types-141142">8.5.3 ICMPv6 Inverse Neighbor Discovery Solicitation/Advertisement (ICMPv6 Types 141/142)</h3>
<h3 id="neighbor-unreachability-detection-nud">8.5.4 Neighbor Unreachability Detection (NUD)</h3>
<h3 id="secure-neighbor-discovery-send">8.5.5 Secure Neighbor Discovery (SEND)</h3>
<h3 id="icmpv6-neighbor-discovery-nd-options">8.5.6 ICMPv6 Neighbor Discovery (ND) Options</h3>
<h2 id="translating-icmpv4-and-icmpv6">8.6 Translating ICMPv4 and ICMPv6</h2>
<h3 id="translating-icmpv4-to-icmpv6">8.6.1 Translating ICMPv4 to ICMPv6</h3>
<h3 id="translating-icmpv6-to-icmpv4">8.6.2 Translating ICMPv6 to ICMPv4</h3>
<h2 id="attacks-involving-icmp">8.7 Attacks Involving ICMP</h2>
<h2 id="summary-7">8.8 Summary</h2>
<h2 id="references-7">8.9 References</h2>
<h1 id="chapter-9-broadcasting-and-local-multicasting-igmp-and-mld">Chapter 9 Broadcasting and Local Multicasting (IGMP and MLD)</h1>
<h2 id="introduction-7">9.1 Introduction</h2>
<h2 id="broadcasting">9.2 Broadcasting</h2>
<h3 id="using-broadcast-addresses">9.2.1 Using Broadcast Addresses</h3>
<h3 id="sending-broadcast-datagrams">9.2.2 Sending Broadcast Datagrams</h3>
<h2 id="multicasting">9.3 Multicasting</h2>
<h3 id="converting-ip-multicast-addresses-to-802-macethernet-addresses">9.3.1 Converting IP Multicast Addresses to 802 MAC/Ethernet Addresses</h3>
<h3 id="examples-1">9.3.2 Examples</h3>
<h3 id="sending-multicast-datagrams">9.3.3 Sending Multicast Datagrams</h3>
<h3 id="receiving-multicast-datagrams">9.3.4 Receiving Multicast Datagrams</h3>
<h3 id="host-address-filtering">9.3.5 Host Address Filtering</h3>
<h2 id="the-internet-group-management-protocol-igmp-and-multicast-listener-discovery-protocol-mld">9.4 The Internet Group Management Protocol (IGMP) and Multicast Listener Discovery Protocol (MLD)</h2>
<h3 id="igmp-and-mld-processing-by-group-members-group-member-part">9.4.1 IGMP and MLD Processing by Group Members (“Group Member Part”)</h3>
<h3 id="igmp-and-mld-processing-by-multicast-routers-multicast-router-part">9.4.2 IGMP and MLD Processing by Multicast Routers (“Multicast Router Part”)</h3>
<h3 id="examples-2">9.4.3 Examples</h3>
<h3 id="lightweight-igmpv3-and-mldv2">9.4.4 Lightweight IGMPv3 and MLDv2</h3>
<h3 id="igmp-and-mld-robustness">9.4.5 IGMP and MLD Robustness</h3>
<h3 id="igmp-and-mld-counters-and-variables">9.4.6 IGMP and MLD Counters and Variables</h3>
<h3 id="igmp-and-mld-snooping">9.4.7 IGMP and MLD Snooping</h3>
<h2 id="attacks-involving-igmp-and-mld">9.5 Attacks Involving IGMP and MLD</h2>
<h2 id="summary-8">9.6 Summary</h2>
<h2 id="references-8">9.7 References</h2>
<h1 id="chapter-10-user-datagram-protocol-udp-and-ip-fragmentation">Chapter 10 User Datagram Protocol (UDP) and IP Fragmentation</h1>
<h2 id="introduction-8">10.1 Introduction</h2>
<h2 id="udp-header">10.2 UDP Header</h2>
<h2 id="udp-checksum">10.3 UDP Checksum</h2>
<h2 id="examples-3">10.4 Examples</h2>
<h2 id="udp-and-ipv6">10.5 UDP and IPv6</h2>
<h3 id="teredo-tunneling-ipv6-through-ipv4-networks">10.5.1 Teredo: Tunneling IPv6 through IPv4 Networks</h3>
<h2 id="udp-lite">10.6 UDP-Lite</h2>
<h2 id="ip-fragmentation">10.7 IP Fragmentation</h2>
<h3 id="example-udpipv4-fragmentation">10.7.1 Example: UDP/IPv4 Fragmentation</h3>
<h3 id="reassembly-timeout">10.7.2 Reassembly Timeout</h3>
<h2 id="path-mtu-discovery-with-udp">10.8 Path MTU Discovery with UDP</h2>
<h3 id="example-1">10.8.1 Example</h3>
<h2 id="interaction-between-ip-fragmentation-and-arpnd">10.9 Interaction between IP Fragmentation and ARP/ND</h2>
<h2 id="maximum-udp-datagram-size">10.10 Maximum UDP Datagram Size</h2>
<h3 id="implementation-limitations">10.10.1 Implementation Limitations</h3>
<h3 id="datagram-truncation">10.10.2 Datagram Truncation</h3>
<h2 id="udp-server-design">10.11 UDP Server Design</h2>
<h3 id="ip-addresses-and-udp-port-numbers">10.11.1 IP Addresses and UDP Port Numbers</h3>
<h3 id="restricting-local-ip-addresses">10.11.2 Restricting Local IP Addresses</h3>
<h3 id="using-multiple-addresses">10.11.3 Using Multiple Addresses</h3>
<h3 id="restricting-foreign-ip-address">10.11.4 Restricting Foreign IP Address</h3>
<h3 id="using-multiple-servers-per-port">10.11.5 Using Multiple Servers per Port</h3>
<h3 id="spanning-address-families-ipv4-and-ipv6">10.11.6 Spanning Address Families: IPv4 and IPv6</h3>
<h3 id="lack-of-flow-and-congestion-control">10.11.7 Lack of Flow and Congestion Control</h3>
<h2 id="translating-udpipv4-and-udpipv6-datagrams">10.12 Translating UDP/IPv4 and UDP/IPv6 Datagrams</h2>
<h2 id="udp-in-the-internet">10.13 UDP in the Internet</h2>
<h2 id="attacks-involving-udp-and-ip-fragmentation">10.14 Attacks Involving UDP and IP Fragmentation</h2>
<h2 id="summary-9">10.15 Summary</h2>
<h2 id="references-9">10.16 References</h2>
<h1 id="chapter-11-name-resolution-and-the-domain-name-system-dns">Chapter 11 Name Resolution and the Domain Name System (DNS)</h1>
<h2 id="introduction-9">11.1 Introduction</h2>
<h2 id="the-dns-name-space">11.2 The DNS Name Space</h2>
<h3 id="dns-naming-syntax">11.2.1 DNS Naming Syntax</h3>
<h2 id="name-servers-and-zones">11.3 Name Servers and Zones</h2>
<h2 id="caching">11.4 Caching</h2>
<h2 id="the-dns-protocol">11.5 The DNS Protocol</h2>
<h3 id="dns-message-format">11.5.1 DNS Message Format</h3>
<h3 id="the-dns-extension-format-edns0">11.5.2 The DNS Extension Format (EDNS0)</h3>
<h3 id="udp-or-tcp">11.5.3 UDP or TCP</h3>
<h3 id="question-query-and-zone-section-format">11.5.4 Question (Query) and Zone Section Format</h3>
<h3 id="answer-authority-and-additional-information-section-formats">11.5.5 Answer, Authority, and Additional Information Section Formats</h3>
<h3 id="resource-record-types">11.5.6 Resource Record Types</h3>
<h3 id="dynamic-updates-dns-update">11.5.7 Dynamic Updates (DNS UPDATE)</h3>
<h3 id="zone-transfers-and-dns-notify">11.5.8 Zone Transfers and DNS NOTIFY</h3>
<h2 id="sort-lists-round-robin-and-split-dns">11.6 Sort Lists, Round-Robin, and Split DNS</h2>
<h2 id="open-dns-servers-and-dyndns">11.7 Open DNS Servers and DynDNS</h2>
<h2 id="transparency-and-extensibility">11.8 Transparency and Extensibility</h2>
<h2 id="translating-dns-from-ipv4-to-ipv6-dns64">11.9 Translating DNS from IPv4 to IPv6 (DNS64)</h2>
<h2 id="llmnr-and-mdns">11.10 LLMNR and mDNS</h2>
<h2 id="ldap">11.11 LDAP</h2>
<h2 id="attacks-on-the-dns">11.12 Attacks on the DNS</h2>
<h2 id="summary-10">11.13 Summary</h2>
<h2 id="references-10">11.14 References</h2>
<h1 id="chapter-12-tcp-the-transmission-control-protocol-preliminaries">Chapter 12 TCP: The Transmission Control Protocol (Preliminaries)</h1>
<h2 id="introduction-10">12.1 Introduction</h2>
<h3 id="arq-and-retransmission">12.1.1 ARQ and Retransmission</h3>
<h3 id="windows-of-packets-and-sliding-windows">12.1.2 Windows of Packets and Sliding Windows</h3>
<h3 id="variable-windows-flow-control-and-congestion-control">12.1.3 Variable Windows: Flow Control and Congestion Control</h3>
<h3 id="setting-the-retransmission-timeout">12.1.4 Setting the Retransmission Timeout</h3>
<h2 id="introduction-to-tcp">12.2 Introduction to TCP</h2>
<h3 id="the-tcp-service-model">12.2.1 The TCP Service Model</h3>
<h3 id="reliability-in-tcp">12.2.2 Reliability in TCP</h3>
<h2 id="tcp-header-and-encapsulation">12.3 TCP Header and Encapsulation</h2>
<h2 id="summary-11">12.4 Summary</h2>
<h2 id="references-11">12.5 References</h2>
<h1 id="chapter-13-tcp-connection-management">Chapter 13 TCP Connection Management</h1>
<h2 id="introduction-11">13.1 Introduction</h2>
<h2 id="tcp-connection-establishment-and-termination">13.2 TCP Connection Establishment and Termination</h2>
<h3 id="tcp-half-close">13.2.1 TCP Half-Close</h3>
<h3 id="simultaneous-open-and-close">13.2.2 Simultaneous Open and Close</h3>
<h3 id="initial-sequence-number-isn">13.2.3 Initial Sequence Number (ISN)</h3>
<h3 id="example-2">13.2.4 Example</h3>
<h3 id="timeout-of-connection-establishment">13.2.5 Timeout of Connection Establishment</h3>
<h3 id="connections-and-translators">13.2.6 Connections and Translators</h3>
<h2 id="tcp-options">13.3 TCP Options</h2>
<h3 id="maximum-segment-size-mss-option">13.3.1 Maximum Segment Size (MSS) Option</h3>
<h3 id="selective-acknowledgment-sack-options">13.3.2 Selective Acknowledgment (SACK) Options</h3>
<h3 id="window-scale-wscale-or-wsopt-option">13.3.3 Window Scale (WSCALE or WSOPT) Option</h3>
<h3 id="timestamps-option-and-protection-against-wrapped-sequence-numbers-paws">13.3.4 Timestamps Option and Protection against Wrapped Sequence Numbers (PAWS)</h3>
<h3 id="user-timeout-uto-option">13.3.5 User Timeout (UTO) Option</h3>
<h3 id="authentication-option-tcp-ao">13.3.6 Authentication Option (TCP-AO)</h3>
<h2 id="path-mtu-discovery-with-tcp">13.4 Path MTU Discovery with TCP</h2>
<h3 id="example-3">13.4.1 Example</h3>
<h2 id="tcp-state-transitions">13.5 TCP State Transitions</h2>
<h3 id="tcp-state-transition-diagram">13.5.1 TCP State Transition Diagram</h3>
<h3 id="time_wait-2msl-wait-state">13.5.2 TIME_WAIT (2MSL Wait) State</h3>
<h3 id="quiet-time-concept">13.5.3 Quiet Time Concept</h3>
<h3 id="fin_wait_2-state">13.5.4 FIN_WAIT_2 State</h3>
<h3 id="simultaneous-open-and-close-transitions">13.5.5 Simultaneous Open and Close Transitions</h3>
<h2 id="reset-segments">13.6 Reset Segments</h2>
<h3 id="connection-request-to-nonexistent-port">13.6.1 Connection Request to Nonexistent Port</h3>
<h3 id="aborting-a-connection">13.6.2 Aborting a Connection</h3>
<h3 id="half-open-connections">13.6.3 Half-Open Connections</h3>
<h3 id="time-wait-assassination-twa">13.6.4 TIME-WAIT Assassination (TWA)</h3>
<h2 id="tcp-server-operation">13.7 TCP Server Operation</h2>
<h3 id="tcp-port-numbers">13.7.1 TCP Port Numbers</h3>
<h3 id="restricting-local-ip-addresses-1">13.7.2 Restricting Local IP Addresses</h3>
<h3 id="restricting-foreign-endpoints">13.7.3 Restricting Foreign Endpoints</h3>
<h3 id="incoming-connection-queue">13.7.4 Incoming Connection Queue</h3>
<h2 id="attacks-involving-tcp-connection-management">13.8 Attacks Involving TCP Connection Management</h2>
<h2 id="summary-12">13.9 Summary</h2>
<h2 id="references-12">13.10 References</h2>
<h1 id="chapter-14-tcp-timeout-and-retransmission">Chapter 14 TCP Timeout and Retransmission</h1>
<h2 id="introduction-12">14.1 Introduction</h2>
<h2 id="simple-timeout-and-retransmission-example">14.2 Simple Timeout and Retransmission Example</h2>
<h2 id="setting-the-retransmission-timeout-rto">14.3 Setting the Retransmission Timeout (RTO)</h2>
<h3 id="the-classic-method">14.3.1 The Classic Method</h3>
<h3 id="the-standard-method">14.3.2 The Standard Method</h3>
<h3 id="the-linux-method">14.3.3 The Linux Method</h3>
<h3 id="rtt-estimator-behaviors">14.3.4 RTT Estimator Behaviors</h3>
<h3 id="rttm-robustness-to-loss-and-reordering">14.3.5 RTTM Robustness to Loss and Reordering</h3>
<h2 id="timer-based-retransmission">14.4 Timer-Based Retransmission</h2>
<h3 id="example-4">14.4.1 Example</h3>
<h2 id="fast-retransmit">14.5 Fast Retransmit</h2>
<h3 id="example-5">14.5.1 Example</h3>
<h2 id="retransmission-with-selective-acknowledgments">14.6 Retransmission with Selective Acknowledgments</h2>
<h3 id="sack-receiver-behavior">14.6.1 SACK Receiver Behavior</h3>
<h3 id="sack-sender-behavior">14.6.2 SACK Sender Behavior</h3>
<h3 id="example-6">14.6.3 Example</h3>
<h2 id="spurious-timeouts-and-retransmissions">14.7 Spurious Timeouts and Retransmissions</h2>
<h3 id="duplicate-sack-dsack-extension">14.7.1 Duplicate SACK (DSACK) Extension</h3>
<h3 id="the-eifel-detection-algorithm">14.7.2 The Eifel Detection Algorithm</h3>
<h3 id="forward-rto-recovery-f-rto">14.7.3 Forward-RTO Recovery (F-RTO)</h3>
<h3 id="the-eifel-response-algorithm">14.7.4 The Eifel Response Algorithm</h3>
<h2 id="packet-reordering-and-duplication">14.8 Packet Reordering and Duplication</h2>
<h3 id="reordering">14.8.1 Reordering</h3>
<h3 id="duplication">14.8.2 Duplication</h3>
<h2 id="destination-metrics">14.9 Destination Metrics</h2>
<h2 id="repacketization">14.10 Repacketization</h2>
<h2 id="attacks-involving-tcp-retransmission">14.11 Attacks Involving TCP Retransmission</h2>
<h2 id="summary-13">14.12 Summary</h2>
<h2 id="references-13">14.13 References</h2>
<h1 id="chapter-15-tcp-data-flow-and-window-management">Chapter 15 TCP Data Flow and Window Management</h1>
<h2 id="introduction-13">15.1 Introduction</h2>
<h2 id="interactive-communication">15.2 Interactive Communication</h2>
<h2 id="delayed-acknowledgments">15.3 Delayed Acknowledgments</h2>
<h2 id="nagle-algorithm">15.4 Nagle Algorithm</h2>
<h3 id="delayed-ack-and-nagle-algorithm-interaction">15.4.1 Delayed ACK and Nagle Algorithm Interaction</h3>
<h3 id="disabling-the-nagle-algorithm">15.4.2 Disabling the Nagle Algorithm</h3>
<h2 id="flow-control-and-window-management">15.5 Flow Control and Window Management</h2>
<h3 id="sliding-windows">15.5.1 Sliding Windows</h3>
<h3 id="zero-windows-and-the-tcp-persist-timer">15.5.2 Zero Windows and the TCP Persist Timer</h3>
<h3 id="silly-window-syndrome-sws">15.5.3 Silly Window Syndrome (SWS)</h3>
<h3 id="large-buffers-and-auto-tuning">15.5.4 Large Buffers and Auto-Tuning</h3>
<h2 id="urgent-mechanism">15.6 Urgent Mechanism</h2>
<h3 id="example-7">15.6.1 Example</h3>
<h2 id="attacks-involving-window-management">15.7 Attacks Involving Window Management</h2>
<h2 id="summary-14">15.8 Summary</h2>
<h2 id="references-14">15.9 References</h2>
<h1 id="chapter-16-tcp-congestion-control">Chapter 16 TCP Congestion Control</h1>
<h2 id="introduction-14">16.1 Introduction</h2>
<h3 id="detection-of-congestion-in-tcp">16.1.1 Detection of Congestion in TCP</h3>
<h3 id="slowing-down-a-tcp-sender">16.1.2 Slowing Down a TCP Sender</h3>
<h2 id="the-classic-algorithms">16.2 The Classic Algorithms</h2>
<h3 id="slow-start">16.2.1 Slow Start</h3>
<h3 id="congestion-avoidance">16.2.2 Congestion Avoidance</h3>
<h3 id="selecting-between-slow-start-and-congestion-avoidance">16.2.3 Selecting between Slow Start and Congestion Avoidance</h3>
<h3 id="tahoe-reno-and-fast-recovery">16.2.4 Tahoe, Reno, and Fast Recovery</h3>
<h3 id="standard-tcp">16.2.5 Standard TCP</h3>
<h2 id="evolution-of-the-standard-algorithms">16.3 Evolution of the Standard Algorithms</h2>
<h3 id="newreno">16.3.1 NewReno</h3>
<h3 id="tcp-congestion-control-with-sack">16.3.2 TCP Congestion Control with SACK</h3>
<h3 id="forward-acknowledgment-fack-and-rate-halving">16.3.3 Forward Acknowledgment (FACK) and Rate Halving</h3>
<h3 id="limited-transmit">16.3.4 Limited Transmit</h3>
<h3 id="congestion-window-validation-cwv">16.3.5 Congestion Window Validation (CWV)</h3>
<h2 id="handling-spurious-rtosthe-eifel-response-algorithm">16.4 Handling Spurious RTOs—the Eifel Response Algorithm</h2>
<h2 id="an-extended-example">16.5 An Extended Example</h2>
<h3 id="slow-start-behavior">16.5.1 Slow Start Behavior</h3>
<h3 id="sender-pause-and-local-congestion-event-1">16.5.2 Sender Pause and Local Congestion (Event 1)</h3>
<h3 id="stretch-acks-and-recovery-from-local-congestion">16.5.3 Stretch ACKs and Recovery from Local Congestion</h3>
<h3 id="fast-retransmission-and-sack-recovery-event-2">16.5.4 Fast Retransmission and SACK Recovery (Event 2)</h3>
<h3 id="additional-local-congestion-and-fast-retransmit-events">16.5.5 Additional Local Congestion and Fast Retransmit Events</h3>
<h3 id="timeouts-retransmissions-and-undoing-cwnd-changes">16.5.6 Timeouts, Retransmissions, and Undoing cwnd Changes</h3>
<h3 id="connection-completion">16.5.7 Connection Completion</h3>
<h2 id="sharing-congestion-state">16.6 Sharing Congestion State</h2>
<h2 id="tcp-friendliness">16.7 TCP Friendliness</h2>
<h2 id="tcp-in-high-speed-environments">16.8 TCP in High-Speed Environments</h2>
<h3 id="highspeed-tcp-hstcp-and-limited-slow-start">16.8.1 HighSpeed TCP (HSTCP) and Limited Slow Start</h3>
<h3 id="binary-increase-congestion-control-bic-and-cubic">16.8.2 Binary Increase Congestion Control (BIC and CUBIC)</h3>
<h2 id="delay-based-congestion-control">16.9 Delay-Based Congestion Control</h2>
<h3 id="vegas">16.9.1 Vegas</h3>
<h3 id="fast">16.9.2 FAST</h3>
<h3 id="tcp-westwood-and-westwood">16.9.3 TCP Westwood and Westwood+</h3>
<h3 id="compound-tcp">16.9.4 Compound TCP</h3>
<h2 id="buffer-bloat">16.10 Buffer Bloat</h2>
<h2 id="active-queue-management-and-ecn">16.11 Active Queue Management and ECN</h2>
<h2 id="attacks-involving-tcp-congestion-control">16.12 Attacks Involving TCP Congestion Control</h2>
<h2 id="summary-15">16.13 Summary</h2>
<h2 id="references-15">16.14 References</h2>
<h1 id="chapter-17-tcp-keepalive">Chapter 17 TCP Keepalive</h1>
<h2 id="introduction-15">17.1 Introduction</h2>
<h2 id="description">17.2 Description</h2>
<h3 id="keepalive-examples">17.2.1 Keepalive Examples</h3>
<h2 id="attacks-involving-tcp-keepalives">17.3 Attacks Involving TCP Keepalives</h2>
<h2 id="summary-16">17.4 Summary</h2>
<h2 id="references-16">17.5 References</h2>
<h1 id="chapter-18-security-eap-ipsec-tls-dnssec-and-dkim">Chapter 18 Security: EAP, IPsec, TLS, DNSSEC, and DKIM</h1>
<h2 id="introduction-16">18.1 Introduction</h2>
<h2 id="basic-principles-of-information-security">18.2 Basic Principles of Information Security</h2>
<h2 id="threats-to-network-communication">18.3 Threats to Network Communication</h2>
<h2 id="basic-cryptography-and-security-mechanisms">18.4 Basic Cryptography and Security Mechanisms</h2>
<h3 id="cryptosystems">18.4.1 Cryptosystems</h3>
<h3 id="rivest-shamir-and-adleman-rsa-public-key-cryptography">18.4.2 Rivest, Shamir, and Adleman (RSA) Public Key Cryptography</h3>
<h3 id="diffie-hellman-merkle-key-agreement-aka-diffie-hellman-or-dh">18.4.3 Diffie-Hellman-Merkle Key Agreement (aka Diffie-Hellman or DH)</h3>
<h3 id="signcryption-and-elliptic-curve-cryptography-ecc">18.4.4 Signcryption and Elliptic Curve Cryptography (ECC)</h3>
<h3 id="key-derivation-and-perfect-forward-secrecy-pfs">18.4.5 Key Derivation and Perfect Forward Secrecy (PFS)</h3>
<h3 id="pseudorandom-numbers-generators-and-function-families">18.4.6 Pseudorandom Numbers, Generators, and Function Families</h3>
<h3 id="nonces-and-salt">18.4.7 Nonces and Salt</h3>
<h3 id="cryptographic-hash-functions-and-message-digests">18.4.8 Cryptographic Hash Functions and Message Digests</h3>
<h3 id="message-authentication-codes-macs-hmac-cmac-and-gmac">18.4.9 Message Authentication Codes (MACs, HMAC, CMAC, and GMAC)</h3>
<h3 id="cryptographic-suites-and-cipher-suites">18.4.10 Cryptographic Suites and Cipher Suites</h3>
<h2 id="certificates-certificate-authorities-cas-and-pkis">18.5 Certificates, Certificate Authorities (CAs), and PKIs</h2>
<h4 id="public-key-certificates-certificate-authorities-and-x.509">18.5.1 Public Key Certificates, Certificate Authorities, and X.509</h4>
<h3 id="validating-and-revoking-certificates">18.5.2 Validating and Revoking Certificates</h3>
<h3 id="attribute-certificates">18.5.3 Attribute Certificates</h3>
<h2 id="tcpip-security-protocols-and-layering">18.6 TCP/IP Security Protocols and Layering</h2>
<h4 id="network-access-control-802.1x-802.1ae-eap-and-pana">18.7 Network Access Control: 802.1X, 802.1AE, EAP, and PANA</h4>
<h3 id="eap-methods-and-key-derivation">18.7.1 EAP Methods and Key Derivation</h3>
<h3 id="the-eap-re-authentication-protocol-erp">18.7.2 The EAP Re-authentication Protocol (ERP)</h3>
<h3 id="protocol-for-carrying-authentication-for-network-access-pana">18.7.3 Protocol for Carrying Authentication for Network Access (PANA)</h3>
<h2 id="layer-3-ip-security-ipsec">18.8 Layer 3 IP Security (IPsec)</h2>
<h3 id="internet-key-exchange-ikev2-protocol">18.8.1 Internet Key Exchange (IKEv2) Protocol</h3>
<h3 id="authentication-header-ah">18.8.2 Authentication Header (AH)</h3>
<h3 id="encapsulating-security-payload-esp">18.8.3 Encapsulating Security Payload (ESP)</h3>
<h3 id="multicast-1">18.8.4 Multicast</h3>
<h3 id="l2tpipsec">18.8.5 L2TP/IPsec</h3>
<h3 id="ipsec-nat-traversal">18.8.6 IPsec NAT Traversal</h3>
<h3 id="example-8">18.8.7 Example</h3>
<h2 id="transport-layer-security-tls-and-dtls">18.9 Transport Layer Security (TLS and DTLS)</h2>
<h4 id="tls-1.2">18.9.1 TLS 1.2</h4>
<h3 id="tls-with-datagrams-dtls">18.9.2 TLS with Datagrams (DTLS)</h3>
<h2 id="dns-security-dnssec">18.10 DNS Security (DNSSEC)</h2>
<h3 id="dnssec-resource-records">18.10.1 DNSSEC Resource Records</h3>
<h3 id="dnssec-operation">18.10.2 DNSSEC Operation</h3>
<h3 id="transaction-authentication-tsig-tkey-and-sig0">18.10.3 Transaction Authentication (TSIG, TKEY, and SIG(0))</h3>
<h3 id="dnssec-with-dns64">18.10.4 DNSSEC with DNS64</h3>
<h2 id="domainkeys-identified-mail-dkim">18.11 DomainKeys Identified Mail (DKIM)</h2>
<h3 id="dkim-signatures">18.11.1 DKIM Signatures</h3>
<h3 id="example-9">18.11.2 Example</h3>
<h2 id="attacks-on-security-protocols">18.12 Attacks on Security Protocols</h2>
<h2 id="summary-17">18.13 Summary</h2>
<h2 id="references-17">18.14 References</h2>
<h1 id="其他">其他</h1>
<h1 id="internet-www-difference">internet www difference</h1>
<table>
<colgroup>
<col style="width: 3%" />
<col style="width: 48%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">S.No.</th>
<th style="text-align: left;">INTERNET</th>
<th style="text-align: left;">WWW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Internet is a global network of networks.</td>
<td style="text-align: left;">WWW stands for World wide Web.</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Internet is a means of connecting a computer to any other computer anywhere in the world.</td>
<td style="text-align: left;">World Wide Web which is a collection of information which is accessed via the Internet.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Internet is infrastructure.</td>
<td style="text-align: left;">WWW is <strong>service</strong> on top of that infrastructure.</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Internet can be viewed as a big book-store.</td>
<td style="text-align: left;">Web can be viewed as collection of books on that store.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">At some advanced level, to understand we can think of the Internet as hardware.</td>
<td style="text-align: left;">At some advanced level, to understand we can think of the WWW as software.</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Internet is primarily hardware-based.</td>
<td style="text-align: left;">WWW is more software-oriented as compared to the Internet.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">It is originated sometimes in late 1960s.</td>
<td style="text-align: left;">English scientist Tim Berners-Lee invented the World Wide Web in 1989.</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Internet is superset of WWW.</td>
<td style="text-align: left;">WWW is a subset of the Internet.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">The first version of the Internet was known as ARPANET.</td>
<td style="text-align: left;">In the beginning WWW was known as NSFNET.</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Internet uses IP address.</td>
<td style="text-align: left;">WWW uses HTTP.</td>
</tr>
</tbody>
</table>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2022/12/331cfaa59458.html">https://sinos_wei.gitee.io/2022/12/331cfaa59458.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/tcp/">tcp</a><a class="post-meta__tags" href="/tags/ipv6/">ipv6</a><a class="post-meta__tags" href="/tags/addresses/">addresses</a><a class="post-meta__tags" href="/tags/ipv4/">ipv4</a><a class="post-meta__tags" href="/tags/internet/">internet</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/IMG_8779.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/a8bdee1d82ac.html" title="ai"><img class="cover" src="/img/cover/IMG_2241.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">ai</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/968c41444c80.html" title="http权威指南读书笔记"><img class="cover" src="/img/cover/DESIGN17.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">http权威指南读书笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/05/1d8ca121605c.html" title="计算机网络"><img class="cover" src="/img/cover/IMG_3798.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-15</div><div class="title">计算机网络</div></div></a></div><div><a href="/2022/08/5f9009e5e107.html" title="自顶向下读书笔记"><img class="cover" src="/img/cover/IMG_2242.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-03</div><div class="title">自顶向下读书笔记</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cover/IMG_2242.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">167</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SinosGray"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/SinosGray" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://8.130.42.149:5230" target="_blank" title="memo"><i class="fab fa-heart"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-1-introduction"><span class="toc-number">1.</span> <span class="toc-text">Chapter 1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#architectural-principles"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 Architectural Principles</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#packets-connections-and-datagrams"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 Packets, Connections, and Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-end-to-end-argument-and-fate-sharing"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 The End-to-End Argument and Fate Sharing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#error-control-and-flow-control"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 Error Control and Flow Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#design-and-implementation"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Design and Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#layering"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 Layering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multiplexing-demultiplexing-and-encapsulation-in-layered-implementations"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 Multiplexing, Demultiplexing, and Encapsulation in Layered Implementations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-architecture-and-protocols-of-the-tcpip-suite"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 The Architecture and Protocols of the TCP&#x2F;IP Suite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-arpanet-reference-model"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.3.1 The ARPANET Reference Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multiplexing-demultiplexing-and-encapsulation-in-tcpip"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.3.2 Multiplexing, Demultiplexing, and Encapsulation in TCP&#x2F;IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#port-numbers"><span class="toc-number">1.3.3.</span> <span class="toc-text">1.3.3 Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#names-addresses-and-the-dns"><span class="toc-number">1.3.4.</span> <span class="toc-text">1.3.4 Names, Addresses, and the DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#internets-intranets-and-extranets"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 Internets, Intranets, and Extranets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#designing-applications"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 Designing Applications</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#clientserver"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.5.1 Client&#x2F;Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#peer-to-peer"><span class="toc-number">1.5.2.</span> <span class="toc-text">1.5.2 Peer-to-Peer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#application-programming-interfaces-apis"><span class="toc-number">1.5.3.</span> <span class="toc-text">1.5.3 Application Programming Interfaces (APIs)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#standardization-process"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 Standardization Process</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#request-for-comments-rfc"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.6.1 Request for Comments (RFC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#other-standards"><span class="toc-number">1.6.2.</span> <span class="toc-text">1.6.2 Other Standards</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#implementations-and-software-distributions"><span class="toc-number">1.7.</span> <span class="toc-text">1.7 Implementations and Software Distributions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-the-internet-architecture"><span class="toc-number">1.8.</span> <span class="toc-text">1.8 Attacks Involving the Internet Architecture</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">1.9.</span> <span class="toc-text">1.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references"><span class="toc-number">1.10.</span> <span class="toc-text">1.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-2-the-internet-address-architecture"><span class="toc-number">2.</span> <span class="toc-text">Chapter 2 The Internet Address Architecture</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#expressing-ip-addresses"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Expressing IP Addresses</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-ip-address-structure"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Basic IP Address Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#classful-addressing"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 Classful Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#subnet-addressing"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 Subnet Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#subnet-masks"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.3 Subnet Masks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#variable-length-subnet-masks-vlsm"><span class="toc-number">2.3.4.</span> <span class="toc-text">2.3.4 Variable-Length Subnet Masks (VLSM)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#broadcast-addresses"><span class="toc-number">2.3.5.</span> <span class="toc-text">2.3.5 Broadcast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6-addresses-and-interface-identifiers"><span class="toc-number">2.3.6.</span> <span class="toc-text">2.3.6 IPv6 Addresses and Interface Identifiers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cidrclassless-inter-domain-routing-and-aggregation"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 CIDR(Classless Inter-Domain Routing) and Aggregation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#prefixes"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 Prefixes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aggregation-%E8%81%9A%E5%90%88"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 Aggregation 聚合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#special-use-addresses"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 Special-Use Addresses</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#addressing-ipv4ipv6-translators"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 Addressing IPv4&#x2F;IPv6 Translators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast-addresses"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv4-multicast-addresses"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3 IPv4 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6-multicast-addresses"><span class="toc-number">2.5.4.</span> <span class="toc-text">2.5.4 IPv6 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#anycast-addresses"><span class="toc-number">2.5.5.</span> <span class="toc-text">2.5.5 Anycast Addresses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#allocation"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 Allocation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unicast"><span class="toc-number">2.6.1.</span> <span class="toc-text">2.6.1 Unicast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast"><span class="toc-number">2.6.2.</span> <span class="toc-text">2.6.2 Multicast</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unicast-address-assignment"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 Unicast Address Assignment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#single-providerno-networksingle-address"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1 Single Provider&#x2F;No Network&#x2F;Single Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#single-providersingle-networksingle-address"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2 Single Provider&#x2F;Single Network&#x2F;Single Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#single-providermultiple-networksmultiple-addresses"><span class="toc-number">2.7.3.</span> <span class="toc-text">2.7.3 Single Provider&#x2F;Multiple Networks&#x2F;Multiple Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multiple-providersmultiple-networksmultiple-addresses-multihoming"><span class="toc-number">2.7.4.</span> <span class="toc-text">2.7.4 Multiple Providers&#x2F;Multiple Networks&#x2F;Multiple Addresses (Multihoming)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-ip-addresses"><span class="toc-number">2.8.</span> <span class="toc-text">2.8 Attacks Involving IP Addresses</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-1"><span class="toc-number">2.9.</span> <span class="toc-text">2.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-1"><span class="toc-number">2.10.</span> <span class="toc-text">2.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-3-link-layer"><span class="toc-number">3.</span> <span class="toc-text">Chapter 3 Link Layer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-1"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ethernet-and-the-ieee-802-lanman-standards"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 Ethernet and the IEEE 802 LAN&#x2F;MAN Standards</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-ieee-802-lanman-standards"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 The IEEE 802 LAN&#x2F;MAN Standards</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-ethernet-frame-format"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 The Ethernet Frame Format</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pq-virtual-lans-and-qos-tagging"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">3.2.3 802.1p&#x2F;q: Virtual LANs and QoS Tagging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ax-link-aggregation-formerly-802.3ad"><span class="toc-number">3.2.2.1.1.</span> <span class="toc-text">3.2.4 802.1AX: Link Aggregation (Formerly 802.3ad)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#full-duplex-power-save-autonegotiation-and-802.1x-flow-control"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.3 Full Duplex, Power Save, Autonegotiation, and 802.1X Flow Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#duplex-mismatch"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.3.1 Duplex Mismatch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wake-on-lan-wol-power-saving-and-magic-packets"><span class="toc-number">3.2.5.</span> <span class="toc-text">3.3.2 Wake-on LAN (WoL), Power Saving, and Magic Packets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#link-layer-flow-control"><span class="toc-number">3.2.6.</span> <span class="toc-text">3.3.3 Link-Layer Flow Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bridges-and-switches"><span class="toc-number">3.3.</span> <span class="toc-text">3.4 Bridges and Switches</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#spanning-tree-protocol-stp"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.4.1 Spanning Tree Protocol (STP)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ak-multiple-registration-protocol-mrp"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">3.4.2 802.1ak: Multiple Registration Protocol (MRP)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireless-lansieee-802.11wi-fi"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.5 Wireless LANs—IEEE 802.11(Wi-Fi)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#frames"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">3.5.1 802.11 Frames</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#power-save-mode-and-the-time-sync-function-tsf"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.5.2 Power Save Mode and the Time Sync Function (TSF)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#media-access-control"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">3.5.3 802.11 Media Access Control</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#physical-layer-details-rates-channels-and-frequencies"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.5.4 Physical-Layer Details: Rates, Channels, and Frequencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wi-fi-security"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.5.5 Wi-Fi Security</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#wi-fi-mesh-802.11s"><span class="toc-number">3.3.5.1.</span> <span class="toc-text">3.5.6 Wi-Fi Mesh (802.11s)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#point-to-point-protocol-ppp"><span class="toc-number">3.4.</span> <span class="toc-text">3.6 Point-to-Point Protocol (PPP)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#link-control-protocol-lcp"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.6.1 Link Control Protocol (LCP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multilink-ppp-mp"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.6.2 Multilink PPP (MP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#compression-control-protocol-ccp"><span class="toc-number">3.4.3.</span> <span class="toc-text">3.6.3 Compression Control Protocol (CCP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ppp-authentication"><span class="toc-number">3.4.4.</span> <span class="toc-text">3.6.4 PPP Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#network-control-protocols-ncps"><span class="toc-number">3.4.5.</span> <span class="toc-text">3.6.5 Network Control Protocols (NCPs)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#header-compression"><span class="toc-number">3.4.6.</span> <span class="toc-text">3.6.6 Header Compression</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example"><span class="toc-number">3.4.7.</span> <span class="toc-text">3.6.7 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loopback"><span class="toc-number">3.5.</span> <span class="toc-text">3.7 Loopback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mtu-and-path-mtu"><span class="toc-number">3.6.</span> <span class="toc-text">3.8 MTU and Path MTU</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tunneling-basics"><span class="toc-number">3.7.</span> <span class="toc-text">3.9 Tunneling Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unidirectional-links"><span class="toc-number">3.7.1.</span> <span class="toc-text">3.9.1 Unidirectional Links</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-on-the-link-layer"><span class="toc-number">3.8.</span> <span class="toc-text">3.10 Attacks on the Link Layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-2"><span class="toc-number">3.9.</span> <span class="toc-text">3.11 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-2"><span class="toc-number">3.10.</span> <span class="toc-text">3.12 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-4-arp-address-resolution-protocol"><span class="toc-number">4.</span> <span class="toc-text">Chapter 4 ARP: Address Resolution Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-2"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#an-example"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 An Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#direct-delivery-and-arp"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 Direct Delivery and ARP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#arp-cache"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 ARP Cache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#arp-frame-format"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 ARP Frame Format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#arp-examples"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 ARP Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#normal-example"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 Normal Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arp-request-to-a-nonexistent-host"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 ARP Request to a Nonexistent Host</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#arp-cache-timeout"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 ARP Cache Timeout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxy-arp"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 Proxy ARP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gratuitous-arp-and-address-conflict-detection-acd"><span class="toc-number">4.8.</span> <span class="toc-text">4.8 Gratuitous ARP and Address Conflict Detection (ACD)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-arp-command"><span class="toc-number">4.9.</span> <span class="toc-text">4.9 The arp Command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#using-arp-to-set-an-embedded-devices-ipv4-address"><span class="toc-number">4.10.</span> <span class="toc-text">4.10 Using ARP to Set an Embedded Device’s IPv4 Address</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-arp"><span class="toc-number">4.11.</span> <span class="toc-text">4.11 Attacks Involving ARP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-3"><span class="toc-number">4.12.</span> <span class="toc-text">4.12 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-3"><span class="toc-number">4.13.</span> <span class="toc-text">4.13 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-5-the-internet-protocol-ip"><span class="toc-number">5.</span> <span class="toc-text">Chapter 5 The Internet Protocol (IP)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-3"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ipv4-and-ipv6-headers"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 IPv4 and IPv6 Headers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-header-fields"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 IP Header Fields</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-internet-checksum"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 The Internet Checksum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ds-field-and-ecn-formerly-called-the-tos-byte-or-ipv6-traffic-class"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.2.3 DS Field and ECN (Formerly Called the ToS Byte or IPv6 Traffic Class)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-options"><span class="toc-number">5.2.4.</span> <span class="toc-text">5.2.4 IP Options</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ipv6-extension-headers"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 IPv6 Extension Headers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6-options"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1 IPv6 Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#routing-header"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2 Routing Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fragment-header"><span class="toc-number">5.3.3.</span> <span class="toc-text">5.3.3 Fragment Header</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip-forwarding"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 IP Forwarding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#forwarding-table"><span class="toc-number">5.4.1.</span> <span class="toc-text">5.4.1 Forwarding Table</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-forwarding-actions"><span class="toc-number">5.4.2.</span> <span class="toc-text">5.4.2 IP Forwarding Actions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#examples"><span class="toc-number">5.4.3.</span> <span class="toc-text">5.4.3 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discussion"><span class="toc-number">5.4.4.</span> <span class="toc-text">5.4.4 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mobile-ip"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 Mobile IP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-basic-model-bidirectional-tunneling"><span class="toc-number">5.5.1.</span> <span class="toc-text">5.5.1 The Basic Model: Bidirectional Tunneling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#route-optimization-ro"><span class="toc-number">5.5.2.</span> <span class="toc-text">5.5.2 Route Optimization (RO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discussion-1"><span class="toc-number">5.5.3.</span> <span class="toc-text">5.5.3 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#host-processing-of-ip-datagrams"><span class="toc-number">5.6.</span> <span class="toc-text">5.6 Host Processing of IP Datagrams</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#host-models"><span class="toc-number">5.6.1.</span> <span class="toc-text">5.6.1 Host Models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#address-selection"><span class="toc-number">5.6.2.</span> <span class="toc-text">5.6.2 Address Selection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-ip"><span class="toc-number">5.7.</span> <span class="toc-text">5.7 Attacks Involving IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-4"><span class="toc-number">5.8.</span> <span class="toc-text">5.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-4"><span class="toc-number">5.9.</span> <span class="toc-text">5.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-6-system-configuration-dhcp-and-autoconfiguration"><span class="toc-number">6.</span> <span class="toc-text">Chapter 6 System Configuration: DHCP and Autoconfiguration</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-4"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dynamic-host-configuration-protocol-dhcp"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 Dynamic Host Configuration Protocol (DHCP)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#address-pools-and-leases"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1 Address Pools and Leases</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-and-bootp-message-format"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2 DHCP and BOOTP Message Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-and-bootp-options"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3 DHCP and BOOTP Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-protocol-operation"><span class="toc-number">6.2.4.</span> <span class="toc-text">6.2.4 DHCP Protocol Operation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcpv6"><span class="toc-number">6.2.5.</span> <span class="toc-text">6.2.5 DHCPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#using-dhcp-with-relays"><span class="toc-number">6.2.6.</span> <span class="toc-text">6.2.6 Using DHCP with Relays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-authentication"><span class="toc-number">6.2.7.</span> <span class="toc-text">6.2.7 DHCP Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reconfigure-extension"><span class="toc-number">6.2.8.</span> <span class="toc-text">6.2.8 Reconfigure Extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rapid-commit"><span class="toc-number">6.2.9.</span> <span class="toc-text">6.2.9 Rapid Commit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#location-information-lci-and-lost"><span class="toc-number">6.2.10.</span> <span class="toc-text">6.2.10 Location Information (LCI and LoST)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mobility-and-handoff-information-mos-and-andsf"><span class="toc-number">6.2.11.</span> <span class="toc-text">6.2.11 Mobility and Handoff Information (MoS and ANDSF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-snooping"><span class="toc-number">6.2.12.</span> <span class="toc-text">6.2.12 DHCP Snooping</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stateless-address-autoconfiguration-slaac"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 Stateless Address Autoconfiguration (SLAAC)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dynamic-configuration-of-ipv4-link-local-addresses"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1 Dynamic Configuration of IPv4 Link-Local Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6-slaac-for-link-local-addresses"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2 IPv6 SLAAC for Link-Local Addresses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dhcp-and-dns-interaction"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 DHCP and DNS Interaction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ppp-over-ethernet-pppoe"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 PPP over Ethernet (PPPoE)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-system-configuration"><span class="toc-number">6.6.</span> <span class="toc-text">6.6 Attacks Involving System Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-5"><span class="toc-number">6.7.</span> <span class="toc-text">6.7 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-5"><span class="toc-number">6.8.</span> <span class="toc-text">6.8 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-7-firewalls-and-network-address-translation-nat"><span class="toc-number">7.</span> <span class="toc-text">Chapter 7 Firewalls and Network Address Translation (NAT)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-5"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#firewalls"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 Firewalls</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#packet-filtering-firewalls"><span class="toc-number">7.2.1.</span> <span class="toc-text">7.2.1 Packet-Filtering Firewalls</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proxy-firewalls"><span class="toc-number">7.2.2.</span> <span class="toc-text">7.2.2 Proxy Firewalls</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#network-address-translation-nat"><span class="toc-number">7.3.</span> <span class="toc-text">7.3 Network Address Translation (NAT)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#traditional-nat-basic-nat-and-napt"><span class="toc-number">7.3.1.</span> <span class="toc-text">7.3.1 Traditional NAT: Basic NAT and NAPT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#address-and-port-translation-behavior"><span class="toc-number">7.3.2.</span> <span class="toc-text">7.3.2 Address and Port Translation Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filtering-behavior"><span class="toc-number">7.3.3.</span> <span class="toc-text">7.3.3 Filtering Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#servers-behind-nats"><span class="toc-number">7.3.4.</span> <span class="toc-text">7.3.4 Servers behind NATs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hairpinning-and-nat-loopback"><span class="toc-number">7.3.5.</span> <span class="toc-text">7.3.5 Hairpinning and NAT Loopback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nat-editors"><span class="toc-number">7.3.6.</span> <span class="toc-text">7.3.6 NAT Editors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#service-provider-nat-spnat-and-service-provider-ipv6-transition"><span class="toc-number">7.3.7.</span> <span class="toc-text">7.3.7 Service Provider NAT (SPNAT) and Service Provider IPv6 Transition</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nat-traversal"><span class="toc-number">7.4.</span> <span class="toc-text">7.4 NAT Traversal</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pinholes-and-hole-punching"><span class="toc-number">7.4.1.</span> <span class="toc-text">7.4.1 Pinholes and Hole Punching</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unilateral-self-address-fixing-unsaf"><span class="toc-number">7.4.2.</span> <span class="toc-text">7.4.2 UNilateral Self-Address Fixing (UNSAF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#session-traversal-utilities-for-nat-stun"><span class="toc-number">7.4.3.</span> <span class="toc-text">7.4.3 Session Traversal Utilities for NAT (STUN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#traversal-using-relays-around-nat-turn"><span class="toc-number">7.4.4.</span> <span class="toc-text">7.4.4 Traversal Using Relays around NAT (TURN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#interactive-connectivity-establishment-ice"><span class="toc-number">7.4.5.</span> <span class="toc-text">7.4.5 Interactive Connectivity Establishment (ICE)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#configuring-packet-filtering-firewalls-and-nats"><span class="toc-number">7.5.</span> <span class="toc-text">7.5 Configuring Packet-Filtering Firewalls and NATs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#firewall-rules"><span class="toc-number">7.5.1.</span> <span class="toc-text">7.5.1 Firewall Rules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nat-rules"><span class="toc-number">7.5.2.</span> <span class="toc-text">7.5.2 NAT Rules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#direct-interaction-with-nats-and-firewalls-upnp-nat-pmp-and-pcp"><span class="toc-number">7.5.3.</span> <span class="toc-text">7.5.3 Direct Interaction with NATs and Firewalls: UPnP, NAT-PMP, and PCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nat-for-ipv4ipv6-coexistence-and-transition"><span class="toc-number">7.6.</span> <span class="toc-text">7.6 NAT for IPv4&#x2F;IPv6 Coexistence and Transition</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dual-stack-lite-ds-lite"><span class="toc-number">7.6.1.</span> <span class="toc-text">7.6.1 Dual-Stack Lite (DS-Lite)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv4ipv6-translation-using-nats-and-algs"><span class="toc-number">7.6.2.</span> <span class="toc-text">7.6.2 IPv4&#x2F;IPv6 Translation Using NATs and ALGs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-firewalls-and-nats"><span class="toc-number">7.7.</span> <span class="toc-text">7.7 Attacks Involving Firewalls and NATs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-6"><span class="toc-number">7.8.</span> <span class="toc-text">7.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-6"><span class="toc-number">7.9.</span> <span class="toc-text">7.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-8-icmpv4-and-icmpv6-internet-control-message-protocol"><span class="toc-number">8.</span> <span class="toc-text">Chapter 8 ICMPv4 and ICMPv6: Internet Control Message Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-6"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#encapsulation-in-ipv4-and-ipv6"><span class="toc-number">8.1.1.</span> <span class="toc-text">8.1.1 Encapsulation in IPv4 and IPv6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-messages"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 ICMP Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv4-messages"><span class="toc-number">8.2.1.</span> <span class="toc-text">8.2.1 ICMPv4 Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv6-messages"><span class="toc-number">8.2.2.</span> <span class="toc-text">8.2.2 ICMPv6 Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#processing-of-icmp-messages"><span class="toc-number">8.2.3.</span> <span class="toc-text">8.2.3 Processing of ICMP Messages</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-error-messages"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 ICMP Error Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#extended-icmp-and-multipart-messages"><span class="toc-number">8.3.1.</span> <span class="toc-text">8.3.1 Extended ICMP and Multipart Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#destination-unreachable-icmpv4-type-3-icmpv6-type-1-and-packet-too-big-icmpv6-type-2"><span class="toc-number">8.3.2.</span> <span class="toc-text">8.3.2 Destination Unreachable (ICMPv4 Type 3, ICMPv6 Type 1) and Packet Too Big (ICMPv6 Type 2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redirect-icmpv4-type-5-icmpv6-type-137"><span class="toc-number">8.3.3.</span> <span class="toc-text">8.3.3 Redirect (ICMPv4 Type 5, ICMPv6 Type 137)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmp-time-exceeded-icmpv4-type-11-icmpv6-type-3"><span class="toc-number">8.3.4.</span> <span class="toc-text">8.3.4 ICMP Time Exceeded (ICMPv4 Type 11, ICMPv6 Type 3)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parameter-problem-icmpv4-type-12-icmpv6-type-4"><span class="toc-number">8.3.5.</span> <span class="toc-text">8.3.5 Parameter Problem (ICMPv4 Type 12, ICMPv6 Type 4)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-queryinformational-messages"><span class="toc-number">8.4.</span> <span class="toc-text">8.4 ICMP Query&#x2F;Informational Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#echo-requestreply-ping-icmpv4-types-08-icmpv6-types-129128"><span class="toc-number">8.4.1.</span> <span class="toc-text">8.4.1 Echo Request&#x2F;Reply (ping) (ICMPv4 Types 0&#x2F;8, ICMPv6 Types 129&#x2F;128)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#router-discovery-router-solicitation-and-advertisement-icmpv4-types-9-10"><span class="toc-number">8.4.2.</span> <span class="toc-text">8.4.2 Router Discovery: Router Solicitation and Advertisement (ICMPv4 Types 9, 10)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#home-agent-address-discovery-requestreply-icmpv6-types-144145"><span class="toc-number">8.4.3.</span> <span class="toc-text">8.4.3 Home Agent Address Discovery Request&#x2F;Reply (ICMPv6 Types 144&#x2F;145)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mobile-prefix-solicitationadvertisement-icmpv6-types-146147"><span class="toc-number">8.4.4.</span> <span class="toc-text">8.4.4 Mobile Prefix Solicitation&#x2F;Advertisement (ICMPv6 Types 146&#x2F;147)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mobile-ipv6-fast-handover-messages-icmpv6-type-154"><span class="toc-number">8.4.5.</span> <span class="toc-text">8.4.5 Mobile IPv6 Fast Handover Messages (ICMPv6 Type 154)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast-listener-queryreportdone-icmpv6-types-130131132"><span class="toc-number">8.4.6.</span> <span class="toc-text">8.4.6 Multicast Listener Query&#x2F;Report&#x2F;Done (ICMPv6 Types 130&#x2F;131&#x2F;132)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-2-multicast-listener-discovery-mldv2-icmpv6-type-143"><span class="toc-number">8.4.7.</span> <span class="toc-text">8.4.7 Version 2 Multicast Listener Discovery (MLDv2) (ICMPv6 Type 143)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast-router-discovery-mrd-igmp-types-484950-icmpv6-types-151152153"><span class="toc-number">8.4.8.</span> <span class="toc-text">8.4.8 Multicast Router Discovery (MRD) (IGMP Types 48&#x2F;49&#x2F;50, ICMPv6 Types 151&#x2F;152&#x2F;153)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#neighbor-discovery-in-ipv6"><span class="toc-number">8.5.</span> <span class="toc-text">8.5 Neighbor Discovery in IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv6-router-solicitation-and-advertisement-icmpv6-types-133-134"><span class="toc-number">8.5.1.</span> <span class="toc-text">8.5.1 ICMPv6 Router Solicitation and Advertisement (ICMPv6 Types 133, 134)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv6-neighbor-solicitation-and-advertisement-imcpv6-types-135-136"><span class="toc-number">8.5.2.</span> <span class="toc-text">8.5.2 ICMPv6 Neighbor Solicitation and Advertisement (IMCPv6 Types 135, 136)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv6-inverse-neighbor-discovery-solicitationadvertisement-icmpv6-types-141142"><span class="toc-number">8.5.3.</span> <span class="toc-text">8.5.3 ICMPv6 Inverse Neighbor Discovery Solicitation&#x2F;Advertisement (ICMPv6 Types 141&#x2F;142)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#neighbor-unreachability-detection-nud"><span class="toc-number">8.5.4.</span> <span class="toc-text">8.5.4 Neighbor Unreachability Detection (NUD)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#secure-neighbor-discovery-send"><span class="toc-number">8.5.5.</span> <span class="toc-text">8.5.5 Secure Neighbor Discovery (SEND)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmpv6-neighbor-discovery-nd-options"><span class="toc-number">8.5.6.</span> <span class="toc-text">8.5.6 ICMPv6 Neighbor Discovery (ND) Options</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#translating-icmpv4-and-icmpv6"><span class="toc-number">8.6.</span> <span class="toc-text">8.6 Translating ICMPv4 and ICMPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#translating-icmpv4-to-icmpv6"><span class="toc-number">8.6.1.</span> <span class="toc-text">8.6.1 Translating ICMPv4 to ICMPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#translating-icmpv6-to-icmpv4"><span class="toc-number">8.6.2.</span> <span class="toc-text">8.6.2 Translating ICMPv6 to ICMPv4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-icmp"><span class="toc-number">8.7.</span> <span class="toc-text">8.7 Attacks Involving ICMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-7"><span class="toc-number">8.8.</span> <span class="toc-text">8.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-7"><span class="toc-number">8.9.</span> <span class="toc-text">8.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-9-broadcasting-and-local-multicasting-igmp-and-mld"><span class="toc-number">9.</span> <span class="toc-text">Chapter 9 Broadcasting and Local Multicasting (IGMP and MLD)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-7"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#broadcasting"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 Broadcasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#using-broadcast-addresses"><span class="toc-number">9.2.1.</span> <span class="toc-text">9.2.1 Using Broadcast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sending-broadcast-datagrams"><span class="toc-number">9.2.2.</span> <span class="toc-text">9.2.2 Sending Broadcast Datagrams</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#multicasting"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 Multicasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#converting-ip-multicast-addresses-to-802-macethernet-addresses"><span class="toc-number">9.3.1.</span> <span class="toc-text">9.3.1 Converting IP Multicast Addresses to 802 MAC&#x2F;Ethernet Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#examples-1"><span class="toc-number">9.3.2.</span> <span class="toc-text">9.3.2 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sending-multicast-datagrams"><span class="toc-number">9.3.3.</span> <span class="toc-text">9.3.3 Sending Multicast Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#receiving-multicast-datagrams"><span class="toc-number">9.3.4.</span> <span class="toc-text">9.3.4 Receiving Multicast Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#host-address-filtering"><span class="toc-number">9.3.5.</span> <span class="toc-text">9.3.5 Host Address Filtering</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-internet-group-management-protocol-igmp-and-multicast-listener-discovery-protocol-mld"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 The Internet Group Management Protocol (IGMP) and Multicast Listener Discovery Protocol (MLD)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#igmp-and-mld-processing-by-group-members-group-member-part"><span class="toc-number">9.4.1.</span> <span class="toc-text">9.4.1 IGMP and MLD Processing by Group Members (“Group Member Part”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#igmp-and-mld-processing-by-multicast-routers-multicast-router-part"><span class="toc-number">9.4.2.</span> <span class="toc-text">9.4.2 IGMP and MLD Processing by Multicast Routers (“Multicast Router Part”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#examples-2"><span class="toc-number">9.4.3.</span> <span class="toc-text">9.4.3 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lightweight-igmpv3-and-mldv2"><span class="toc-number">9.4.4.</span> <span class="toc-text">9.4.4 Lightweight IGMPv3 and MLDv2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#igmp-and-mld-robustness"><span class="toc-number">9.4.5.</span> <span class="toc-text">9.4.5 IGMP and MLD Robustness</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#igmp-and-mld-counters-and-variables"><span class="toc-number">9.4.6.</span> <span class="toc-text">9.4.6 IGMP and MLD Counters and Variables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#igmp-and-mld-snooping"><span class="toc-number">9.4.7.</span> <span class="toc-text">9.4.7 IGMP and MLD Snooping</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-igmp-and-mld"><span class="toc-number">9.5.</span> <span class="toc-text">9.5 Attacks Involving IGMP and MLD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-8"><span class="toc-number">9.6.</span> <span class="toc-text">9.6 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-8"><span class="toc-number">9.7.</span> <span class="toc-text">9.7 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-10-user-datagram-protocol-udp-and-ip-fragmentation"><span class="toc-number">10.</span> <span class="toc-text">Chapter 10 User Datagram Protocol (UDP) and IP Fragmentation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-8"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-header"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 UDP Header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-checksum"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 UDP Checksum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#examples-3"><span class="toc-number">10.4.</span> <span class="toc-text">10.4 Examples</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-and-ipv6"><span class="toc-number">10.5.</span> <span class="toc-text">10.5 UDP and IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#teredo-tunneling-ipv6-through-ipv4-networks"><span class="toc-number">10.5.1.</span> <span class="toc-text">10.5.1 Teredo: Tunneling IPv6 through IPv4 Networks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-lite"><span class="toc-number">10.6.</span> <span class="toc-text">10.6 UDP-Lite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip-fragmentation"><span class="toc-number">10.7.</span> <span class="toc-text">10.7 IP Fragmentation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-udpipv4-fragmentation"><span class="toc-number">10.7.1.</span> <span class="toc-text">10.7.1 Example: UDP&#x2F;IPv4 Fragmentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reassembly-timeout"><span class="toc-number">10.7.2.</span> <span class="toc-text">10.7.2 Reassembly Timeout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-mtu-discovery-with-udp"><span class="toc-number">10.8.</span> <span class="toc-text">10.8 Path MTU Discovery with UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-1"><span class="toc-number">10.8.1.</span> <span class="toc-text">10.8.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interaction-between-ip-fragmentation-and-arpnd"><span class="toc-number">10.9.</span> <span class="toc-text">10.9 Interaction between IP Fragmentation and ARP&#x2F;ND</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#maximum-udp-datagram-size"><span class="toc-number">10.10.</span> <span class="toc-text">10.10 Maximum UDP Datagram Size</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#implementation-limitations"><span class="toc-number">10.10.1.</span> <span class="toc-text">10.10.1 Implementation Limitations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#datagram-truncation"><span class="toc-number">10.10.2.</span> <span class="toc-text">10.10.2 Datagram Truncation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-server-design"><span class="toc-number">10.11.</span> <span class="toc-text">10.11 UDP Server Design</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-addresses-and-udp-port-numbers"><span class="toc-number">10.11.1.</span> <span class="toc-text">10.11.1 IP Addresses and UDP Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restricting-local-ip-addresses"><span class="toc-number">10.11.2.</span> <span class="toc-text">10.11.2 Restricting Local IP Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#using-multiple-addresses"><span class="toc-number">10.11.3.</span> <span class="toc-text">10.11.3 Using Multiple Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restricting-foreign-ip-address"><span class="toc-number">10.11.4.</span> <span class="toc-text">10.11.4 Restricting Foreign IP Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#using-multiple-servers-per-port"><span class="toc-number">10.11.5.</span> <span class="toc-text">10.11.5 Using Multiple Servers per Port</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spanning-address-families-ipv4-and-ipv6"><span class="toc-number">10.11.6.</span> <span class="toc-text">10.11.6 Spanning Address Families: IPv4 and IPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lack-of-flow-and-congestion-control"><span class="toc-number">10.11.7.</span> <span class="toc-text">10.11.7 Lack of Flow and Congestion Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#translating-udpipv4-and-udpipv6-datagrams"><span class="toc-number">10.12.</span> <span class="toc-text">10.12 Translating UDP&#x2F;IPv4 and UDP&#x2F;IPv6 Datagrams</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp-in-the-internet"><span class="toc-number">10.13.</span> <span class="toc-text">10.13 UDP in the Internet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-udp-and-ip-fragmentation"><span class="toc-number">10.14.</span> <span class="toc-text">10.14 Attacks Involving UDP and IP Fragmentation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-9"><span class="toc-number">10.15.</span> <span class="toc-text">10.15 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-9"><span class="toc-number">10.16.</span> <span class="toc-text">10.16 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-11-name-resolution-and-the-domain-name-system-dns"><span class="toc-number">11.</span> <span class="toc-text">Chapter 11 Name Resolution and the Domain Name System (DNS)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-9"><span class="toc-number">11.1.</span> <span class="toc-text">11.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-dns-name-space"><span class="toc-number">11.2.</span> <span class="toc-text">11.2 The DNS Name Space</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dns-naming-syntax"><span class="toc-number">11.2.1.</span> <span class="toc-text">11.2.1 DNS Naming Syntax</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#name-servers-and-zones"><span class="toc-number">11.3.</span> <span class="toc-text">11.3 Name Servers and Zones</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#caching"><span class="toc-number">11.4.</span> <span class="toc-text">11.4 Caching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-dns-protocol"><span class="toc-number">11.5.</span> <span class="toc-text">11.5 The DNS Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dns-message-format"><span class="toc-number">11.5.1.</span> <span class="toc-text">11.5.1 DNS Message Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-dns-extension-format-edns0"><span class="toc-number">11.5.2.</span> <span class="toc-text">11.5.2 The DNS Extension Format (EDNS0)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#udp-or-tcp"><span class="toc-number">11.5.3.</span> <span class="toc-text">11.5.3 UDP or TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#question-query-and-zone-section-format"><span class="toc-number">11.5.4.</span> <span class="toc-text">11.5.4 Question (Query) and Zone Section Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#answer-authority-and-additional-information-section-formats"><span class="toc-number">11.5.5.</span> <span class="toc-text">11.5.5 Answer, Authority, and Additional Information Section Formats</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resource-record-types"><span class="toc-number">11.5.6.</span> <span class="toc-text">11.5.6 Resource Record Types</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dynamic-updates-dns-update"><span class="toc-number">11.5.7.</span> <span class="toc-text">11.5.7 Dynamic Updates (DNS UPDATE)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zone-transfers-and-dns-notify"><span class="toc-number">11.5.8.</span> <span class="toc-text">11.5.8 Zone Transfers and DNS NOTIFY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sort-lists-round-robin-and-split-dns"><span class="toc-number">11.6.</span> <span class="toc-text">11.6 Sort Lists, Round-Robin, and Split DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#open-dns-servers-and-dyndns"><span class="toc-number">11.7.</span> <span class="toc-text">11.7 Open DNS Servers and DynDNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transparency-and-extensibility"><span class="toc-number">11.8.</span> <span class="toc-text">11.8 Transparency and Extensibility</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#translating-dns-from-ipv4-to-ipv6-dns64"><span class="toc-number">11.9.</span> <span class="toc-text">11.9 Translating DNS from IPv4 to IPv6 (DNS64)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#llmnr-and-mdns"><span class="toc-number">11.10.</span> <span class="toc-text">11.10 LLMNR and mDNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ldap"><span class="toc-number">11.11.</span> <span class="toc-text">11.11 LDAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-on-the-dns"><span class="toc-number">11.12.</span> <span class="toc-text">11.12 Attacks on the DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-10"><span class="toc-number">11.13.</span> <span class="toc-text">11.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-10"><span class="toc-number">11.14.</span> <span class="toc-text">11.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-12-tcp-the-transmission-control-protocol-preliminaries"><span class="toc-number">12.</span> <span class="toc-text">Chapter 12 TCP: The Transmission Control Protocol (Preliminaries)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-10"><span class="toc-number">12.1.</span> <span class="toc-text">12.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#arq-and-retransmission"><span class="toc-number">12.1.1.</span> <span class="toc-text">12.1.1 ARQ and Retransmission</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows-of-packets-and-sliding-windows"><span class="toc-number">12.1.2.</span> <span class="toc-text">12.1.2 Windows of Packets and Sliding Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#variable-windows-flow-control-and-congestion-control"><span class="toc-number">12.1.3.</span> <span class="toc-text">12.1.3 Variable Windows: Flow Control and Congestion Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setting-the-retransmission-timeout"><span class="toc-number">12.1.4.</span> <span class="toc-text">12.1.4 Setting the Retransmission Timeout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-to-tcp"><span class="toc-number">12.2.</span> <span class="toc-text">12.2 Introduction to TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-tcp-service-model"><span class="toc-number">12.2.1.</span> <span class="toc-text">12.2.1 The TCP Service Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reliability-in-tcp"><span class="toc-number">12.2.2.</span> <span class="toc-text">12.2.2 Reliability in TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-header-and-encapsulation"><span class="toc-number">12.3.</span> <span class="toc-text">12.3 TCP Header and Encapsulation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-11"><span class="toc-number">12.4.</span> <span class="toc-text">12.4 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-11"><span class="toc-number">12.5.</span> <span class="toc-text">12.5 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-13-tcp-connection-management"><span class="toc-number">13.</span> <span class="toc-text">Chapter 13 TCP Connection Management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-11"><span class="toc-number">13.1.</span> <span class="toc-text">13.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-connection-establishment-and-termination"><span class="toc-number">13.2.</span> <span class="toc-text">13.2 TCP Connection Establishment and Termination</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-half-close"><span class="toc-number">13.2.1.</span> <span class="toc-text">13.2.1 TCP Half-Close</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simultaneous-open-and-close"><span class="toc-number">13.2.2.</span> <span class="toc-text">13.2.2 Simultaneous Open and Close</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#initial-sequence-number-isn"><span class="toc-number">13.2.3.</span> <span class="toc-text">13.2.3 Initial Sequence Number (ISN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2"><span class="toc-number">13.2.4.</span> <span class="toc-text">13.2.4 Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timeout-of-connection-establishment"><span class="toc-number">13.2.5.</span> <span class="toc-text">13.2.5 Timeout of Connection Establishment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#connections-and-translators"><span class="toc-number">13.2.6.</span> <span class="toc-text">13.2.6 Connections and Translators</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-options"><span class="toc-number">13.3.</span> <span class="toc-text">13.3 TCP Options</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#maximum-segment-size-mss-option"><span class="toc-number">13.3.1.</span> <span class="toc-text">13.3.1 Maximum Segment Size (MSS) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#selective-acknowledgment-sack-options"><span class="toc-number">13.3.2.</span> <span class="toc-text">13.3.2 Selective Acknowledgment (SACK) Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#window-scale-wscale-or-wsopt-option"><span class="toc-number">13.3.3.</span> <span class="toc-text">13.3.3 Window Scale (WSCALE or WSOPT) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timestamps-option-and-protection-against-wrapped-sequence-numbers-paws"><span class="toc-number">13.3.4.</span> <span class="toc-text">13.3.4 Timestamps Option and Protection against Wrapped Sequence Numbers (PAWS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#user-timeout-uto-option"><span class="toc-number">13.3.5.</span> <span class="toc-text">13.3.5 User Timeout (UTO) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#authentication-option-tcp-ao"><span class="toc-number">13.3.6.</span> <span class="toc-text">13.3.6 Authentication Option (TCP-AO)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-mtu-discovery-with-tcp"><span class="toc-number">13.4.</span> <span class="toc-text">13.4 Path MTU Discovery with TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-3"><span class="toc-number">13.4.1.</span> <span class="toc-text">13.4.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-state-transitions"><span class="toc-number">13.5.</span> <span class="toc-text">13.5 TCP State Transitions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-state-transition-diagram"><span class="toc-number">13.5.1.</span> <span class="toc-text">13.5.1 TCP State Transition Diagram</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#time_wait-2msl-wait-state"><span class="toc-number">13.5.2.</span> <span class="toc-text">13.5.2 TIME_WAIT (2MSL Wait) State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#quiet-time-concept"><span class="toc-number">13.5.3.</span> <span class="toc-text">13.5.3 Quiet Time Concept</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fin_wait_2-state"><span class="toc-number">13.5.4.</span> <span class="toc-text">13.5.4 FIN_WAIT_2 State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simultaneous-open-and-close-transitions"><span class="toc-number">13.5.5.</span> <span class="toc-text">13.5.5 Simultaneous Open and Close Transitions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reset-segments"><span class="toc-number">13.6.</span> <span class="toc-text">13.6 Reset Segments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#connection-request-to-nonexistent-port"><span class="toc-number">13.6.1.</span> <span class="toc-text">13.6.1 Connection Request to Nonexistent Port</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aborting-a-connection"><span class="toc-number">13.6.2.</span> <span class="toc-text">13.6.2 Aborting a Connection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#half-open-connections"><span class="toc-number">13.6.3.</span> <span class="toc-text">13.6.3 Half-Open Connections</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#time-wait-assassination-twa"><span class="toc-number">13.6.4.</span> <span class="toc-text">13.6.4 TIME-WAIT Assassination (TWA)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-server-operation"><span class="toc-number">13.7.</span> <span class="toc-text">13.7 TCP Server Operation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-port-numbers"><span class="toc-number">13.7.1.</span> <span class="toc-text">13.7.1 TCP Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restricting-local-ip-addresses-1"><span class="toc-number">13.7.2.</span> <span class="toc-text">13.7.2 Restricting Local IP Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restricting-foreign-endpoints"><span class="toc-number">13.7.3.</span> <span class="toc-text">13.7.3 Restricting Foreign Endpoints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#incoming-connection-queue"><span class="toc-number">13.7.4.</span> <span class="toc-text">13.7.4 Incoming Connection Queue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-tcp-connection-management"><span class="toc-number">13.8.</span> <span class="toc-text">13.8 Attacks Involving TCP Connection Management</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-12"><span class="toc-number">13.9.</span> <span class="toc-text">13.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-12"><span class="toc-number">13.10.</span> <span class="toc-text">13.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-14-tcp-timeout-and-retransmission"><span class="toc-number">14.</span> <span class="toc-text">Chapter 14 TCP Timeout and Retransmission</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-12"><span class="toc-number">14.1.</span> <span class="toc-text">14.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simple-timeout-and-retransmission-example"><span class="toc-number">14.2.</span> <span class="toc-text">14.2 Simple Timeout and Retransmission Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setting-the-retransmission-timeout-rto"><span class="toc-number">14.3.</span> <span class="toc-text">14.3 Setting the Retransmission Timeout (RTO)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-classic-method"><span class="toc-number">14.3.1.</span> <span class="toc-text">14.3.1 The Classic Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-standard-method"><span class="toc-number">14.3.2.</span> <span class="toc-text">14.3.2 The Standard Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-linux-method"><span class="toc-number">14.3.3.</span> <span class="toc-text">14.3.3 The Linux Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rtt-estimator-behaviors"><span class="toc-number">14.3.4.</span> <span class="toc-text">14.3.4 RTT Estimator Behaviors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rttm-robustness-to-loss-and-reordering"><span class="toc-number">14.3.5.</span> <span class="toc-text">14.3.5 RTTM Robustness to Loss and Reordering</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#timer-based-retransmission"><span class="toc-number">14.4.</span> <span class="toc-text">14.4 Timer-Based Retransmission</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-4"><span class="toc-number">14.4.1.</span> <span class="toc-text">14.4.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fast-retransmit"><span class="toc-number">14.5.</span> <span class="toc-text">14.5 Fast Retransmit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-5"><span class="toc-number">14.5.1.</span> <span class="toc-text">14.5.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#retransmission-with-selective-acknowledgments"><span class="toc-number">14.6.</span> <span class="toc-text">14.6 Retransmission with Selective Acknowledgments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sack-receiver-behavior"><span class="toc-number">14.6.1.</span> <span class="toc-text">14.6.1 SACK Receiver Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sack-sender-behavior"><span class="toc-number">14.6.2.</span> <span class="toc-text">14.6.2 SACK Sender Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-6"><span class="toc-number">14.6.3.</span> <span class="toc-text">14.6.3 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spurious-timeouts-and-retransmissions"><span class="toc-number">14.7.</span> <span class="toc-text">14.7 Spurious Timeouts and Retransmissions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#duplicate-sack-dsack-extension"><span class="toc-number">14.7.1.</span> <span class="toc-text">14.7.1 Duplicate SACK (DSACK) Extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-eifel-detection-algorithm"><span class="toc-number">14.7.2.</span> <span class="toc-text">14.7.2 The Eifel Detection Algorithm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forward-rto-recovery-f-rto"><span class="toc-number">14.7.3.</span> <span class="toc-text">14.7.3 Forward-RTO Recovery (F-RTO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-eifel-response-algorithm"><span class="toc-number">14.7.4.</span> <span class="toc-text">14.7.4 The Eifel Response Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#packet-reordering-and-duplication"><span class="toc-number">14.8.</span> <span class="toc-text">14.8 Packet Reordering and Duplication</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reordering"><span class="toc-number">14.8.1.</span> <span class="toc-text">14.8.1 Reordering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#duplication"><span class="toc-number">14.8.2.</span> <span class="toc-text">14.8.2 Duplication</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#destination-metrics"><span class="toc-number">14.9.</span> <span class="toc-text">14.9 Destination Metrics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#repacketization"><span class="toc-number">14.10.</span> <span class="toc-text">14.10 Repacketization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-tcp-retransmission"><span class="toc-number">14.11.</span> <span class="toc-text">14.11 Attacks Involving TCP Retransmission</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-13"><span class="toc-number">14.12.</span> <span class="toc-text">14.12 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-13"><span class="toc-number">14.13.</span> <span class="toc-text">14.13 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-15-tcp-data-flow-and-window-management"><span class="toc-number">15.</span> <span class="toc-text">Chapter 15 TCP Data Flow and Window Management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-13"><span class="toc-number">15.1.</span> <span class="toc-text">15.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interactive-communication"><span class="toc-number">15.2.</span> <span class="toc-text">15.2 Interactive Communication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delayed-acknowledgments"><span class="toc-number">15.3.</span> <span class="toc-text">15.3 Delayed Acknowledgments</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nagle-algorithm"><span class="toc-number">15.4.</span> <span class="toc-text">15.4 Nagle Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#delayed-ack-and-nagle-algorithm-interaction"><span class="toc-number">15.4.1.</span> <span class="toc-text">15.4.1 Delayed ACK and Nagle Algorithm Interaction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#disabling-the-nagle-algorithm"><span class="toc-number">15.4.2.</span> <span class="toc-text">15.4.2 Disabling the Nagle Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flow-control-and-window-management"><span class="toc-number">15.5.</span> <span class="toc-text">15.5 Flow Control and Window Management</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sliding-windows"><span class="toc-number">15.5.1.</span> <span class="toc-text">15.5.1 Sliding Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zero-windows-and-the-tcp-persist-timer"><span class="toc-number">15.5.2.</span> <span class="toc-text">15.5.2 Zero Windows and the TCP Persist Timer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#silly-window-syndrome-sws"><span class="toc-number">15.5.3.</span> <span class="toc-text">15.5.3 Silly Window Syndrome (SWS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#large-buffers-and-auto-tuning"><span class="toc-number">15.5.4.</span> <span class="toc-text">15.5.4 Large Buffers and Auto-Tuning</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urgent-mechanism"><span class="toc-number">15.6.</span> <span class="toc-text">15.6 Urgent Mechanism</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-7"><span class="toc-number">15.6.1.</span> <span class="toc-text">15.6.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-window-management"><span class="toc-number">15.7.</span> <span class="toc-text">15.7 Attacks Involving Window Management</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-14"><span class="toc-number">15.8.</span> <span class="toc-text">15.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-14"><span class="toc-number">15.9.</span> <span class="toc-text">15.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-16-tcp-congestion-control"><span class="toc-number">16.</span> <span class="toc-text">Chapter 16 TCP Congestion Control</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-14"><span class="toc-number">16.1.</span> <span class="toc-text">16.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#detection-of-congestion-in-tcp"><span class="toc-number">16.1.1.</span> <span class="toc-text">16.1.1 Detection of Congestion in TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slowing-down-a-tcp-sender"><span class="toc-number">16.1.2.</span> <span class="toc-text">16.1.2 Slowing Down a TCP Sender</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-classic-algorithms"><span class="toc-number">16.2.</span> <span class="toc-text">16.2 The Classic Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#slow-start"><span class="toc-number">16.2.1.</span> <span class="toc-text">16.2.1 Slow Start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#congestion-avoidance"><span class="toc-number">16.2.2.</span> <span class="toc-text">16.2.2 Congestion Avoidance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#selecting-between-slow-start-and-congestion-avoidance"><span class="toc-number">16.2.3.</span> <span class="toc-text">16.2.3 Selecting between Slow Start and Congestion Avoidance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tahoe-reno-and-fast-recovery"><span class="toc-number">16.2.4.</span> <span class="toc-text">16.2.4 Tahoe, Reno, and Fast Recovery</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#standard-tcp"><span class="toc-number">16.2.5.</span> <span class="toc-text">16.2.5 Standard TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#evolution-of-the-standard-algorithms"><span class="toc-number">16.3.</span> <span class="toc-text">16.3 Evolution of the Standard Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#newreno"><span class="toc-number">16.3.1.</span> <span class="toc-text">16.3.1 NewReno</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-congestion-control-with-sack"><span class="toc-number">16.3.2.</span> <span class="toc-text">16.3.2 TCP Congestion Control with SACK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forward-acknowledgment-fack-and-rate-halving"><span class="toc-number">16.3.3.</span> <span class="toc-text">16.3.3 Forward Acknowledgment (FACK) and Rate Halving</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limited-transmit"><span class="toc-number">16.3.4.</span> <span class="toc-text">16.3.4 Limited Transmit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#congestion-window-validation-cwv"><span class="toc-number">16.3.5.</span> <span class="toc-text">16.3.5 Congestion Window Validation (CWV)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#handling-spurious-rtosthe-eifel-response-algorithm"><span class="toc-number">16.4.</span> <span class="toc-text">16.4 Handling Spurious RTOs—the Eifel Response Algorithm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#an-extended-example"><span class="toc-number">16.5.</span> <span class="toc-text">16.5 An Extended Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#slow-start-behavior"><span class="toc-number">16.5.1.</span> <span class="toc-text">16.5.1 Slow Start Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sender-pause-and-local-congestion-event-1"><span class="toc-number">16.5.2.</span> <span class="toc-text">16.5.2 Sender Pause and Local Congestion (Event 1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stretch-acks-and-recovery-from-local-congestion"><span class="toc-number">16.5.3.</span> <span class="toc-text">16.5.3 Stretch ACKs and Recovery from Local Congestion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fast-retransmission-and-sack-recovery-event-2"><span class="toc-number">16.5.4.</span> <span class="toc-text">16.5.4 Fast Retransmission and SACK Recovery (Event 2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#additional-local-congestion-and-fast-retransmit-events"><span class="toc-number">16.5.5.</span> <span class="toc-text">16.5.5 Additional Local Congestion and Fast Retransmit Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timeouts-retransmissions-and-undoing-cwnd-changes"><span class="toc-number">16.5.6.</span> <span class="toc-text">16.5.6 Timeouts, Retransmissions, and Undoing cwnd Changes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#connection-completion"><span class="toc-number">16.5.7.</span> <span class="toc-text">16.5.7 Connection Completion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sharing-congestion-state"><span class="toc-number">16.6.</span> <span class="toc-text">16.6 Sharing Congestion State</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-friendliness"><span class="toc-number">16.7.</span> <span class="toc-text">16.7 TCP Friendliness</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-in-high-speed-environments"><span class="toc-number">16.8.</span> <span class="toc-text">16.8 TCP in High-Speed Environments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#highspeed-tcp-hstcp-and-limited-slow-start"><span class="toc-number">16.8.1.</span> <span class="toc-text">16.8.1 HighSpeed TCP (HSTCP) and Limited Slow Start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#binary-increase-congestion-control-bic-and-cubic"><span class="toc-number">16.8.2.</span> <span class="toc-text">16.8.2 Binary Increase Congestion Control (BIC and CUBIC)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delay-based-congestion-control"><span class="toc-number">16.9.</span> <span class="toc-text">16.9 Delay-Based Congestion Control</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vegas"><span class="toc-number">16.9.1.</span> <span class="toc-text">16.9.1 Vegas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fast"><span class="toc-number">16.9.2.</span> <span class="toc-text">16.9.2 FAST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-westwood-and-westwood"><span class="toc-number">16.9.3.</span> <span class="toc-text">16.9.3 TCP Westwood and Westwood+</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#compound-tcp"><span class="toc-number">16.9.4.</span> <span class="toc-text">16.9.4 Compound TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#buffer-bloat"><span class="toc-number">16.10.</span> <span class="toc-text">16.10 Buffer Bloat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#active-queue-management-and-ecn"><span class="toc-number">16.11.</span> <span class="toc-text">16.11 Active Queue Management and ECN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-tcp-congestion-control"><span class="toc-number">16.12.</span> <span class="toc-text">16.12 Attacks Involving TCP Congestion Control</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-15"><span class="toc-number">16.13.</span> <span class="toc-text">16.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-15"><span class="toc-number">16.14.</span> <span class="toc-text">16.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-17-tcp-keepalive"><span class="toc-number">17.</span> <span class="toc-text">Chapter 17 TCP Keepalive</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-15"><span class="toc-number">17.1.</span> <span class="toc-text">17.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#description"><span class="toc-number">17.2.</span> <span class="toc-text">17.2 Description</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#keepalive-examples"><span class="toc-number">17.2.1.</span> <span class="toc-text">17.2.1 Keepalive Examples</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-involving-tcp-keepalives"><span class="toc-number">17.3.</span> <span class="toc-text">17.3 Attacks Involving TCP Keepalives</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-16"><span class="toc-number">17.4.</span> <span class="toc-text">17.4 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-16"><span class="toc-number">17.5.</span> <span class="toc-text">17.5 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-18-security-eap-ipsec-tls-dnssec-and-dkim"><span class="toc-number">18.</span> <span class="toc-text">Chapter 18 Security: EAP, IPsec, TLS, DNSSEC, and DKIM</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-16"><span class="toc-number">18.1.</span> <span class="toc-text">18.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-principles-of-information-security"><span class="toc-number">18.2.</span> <span class="toc-text">18.2 Basic Principles of Information Security</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#threats-to-network-communication"><span class="toc-number">18.3.</span> <span class="toc-text">18.3 Threats to Network Communication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-cryptography-and-security-mechanisms"><span class="toc-number">18.4.</span> <span class="toc-text">18.4 Basic Cryptography and Security Mechanisms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cryptosystems"><span class="toc-number">18.4.1.</span> <span class="toc-text">18.4.1 Cryptosystems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rivest-shamir-and-adleman-rsa-public-key-cryptography"><span class="toc-number">18.4.2.</span> <span class="toc-text">18.4.2 Rivest, Shamir, and Adleman (RSA) Public Key Cryptography</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#diffie-hellman-merkle-key-agreement-aka-diffie-hellman-or-dh"><span class="toc-number">18.4.3.</span> <span class="toc-text">18.4.3 Diffie-Hellman-Merkle Key Agreement (aka Diffie-Hellman or DH)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signcryption-and-elliptic-curve-cryptography-ecc"><span class="toc-number">18.4.4.</span> <span class="toc-text">18.4.4 Signcryption and Elliptic Curve Cryptography (ECC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#key-derivation-and-perfect-forward-secrecy-pfs"><span class="toc-number">18.4.5.</span> <span class="toc-text">18.4.5 Key Derivation and Perfect Forward Secrecy (PFS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pseudorandom-numbers-generators-and-function-families"><span class="toc-number">18.4.6.</span> <span class="toc-text">18.4.6 Pseudorandom Numbers, Generators, and Function Families</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nonces-and-salt"><span class="toc-number">18.4.7.</span> <span class="toc-text">18.4.7 Nonces and Salt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cryptographic-hash-functions-and-message-digests"><span class="toc-number">18.4.8.</span> <span class="toc-text">18.4.8 Cryptographic Hash Functions and Message Digests</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#message-authentication-codes-macs-hmac-cmac-and-gmac"><span class="toc-number">18.4.9.</span> <span class="toc-text">18.4.9 Message Authentication Codes (MACs, HMAC, CMAC, and GMAC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cryptographic-suites-and-cipher-suites"><span class="toc-number">18.4.10.</span> <span class="toc-text">18.4.10 Cryptographic Suites and Cipher Suites</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#certificates-certificate-authorities-cas-and-pkis"><span class="toc-number">18.5.</span> <span class="toc-text">18.5 Certificates, Certificate Authorities (CAs), and PKIs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#public-key-certificates-certificate-authorities-and-x.509"><span class="toc-number">18.5.0.1.</span> <span class="toc-text">18.5.1 Public Key Certificates, Certificate Authorities, and X.509</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#validating-and-revoking-certificates"><span class="toc-number">18.5.1.</span> <span class="toc-text">18.5.2 Validating and Revoking Certificates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#attribute-certificates"><span class="toc-number">18.5.2.</span> <span class="toc-text">18.5.3 Attribute Certificates</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tcpip-security-protocols-and-layering"><span class="toc-number">18.6.</span> <span class="toc-text">18.6 TCP&#x2F;IP Security Protocols and Layering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#network-access-control-802.1x-802.1ae-eap-and-pana"><span class="toc-number">18.6.0.1.</span> <span class="toc-text">18.7 Network Access Control: 802.1X, 802.1AE, EAP, and PANA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eap-methods-and-key-derivation"><span class="toc-number">18.6.1.</span> <span class="toc-text">18.7.1 EAP Methods and Key Derivation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-eap-re-authentication-protocol-erp"><span class="toc-number">18.6.2.</span> <span class="toc-text">18.7.2 The EAP Re-authentication Protocol (ERP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#protocol-for-carrying-authentication-for-network-access-pana"><span class="toc-number">18.6.3.</span> <span class="toc-text">18.7.3 Protocol for Carrying Authentication for Network Access (PANA)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#layer-3-ip-security-ipsec"><span class="toc-number">18.7.</span> <span class="toc-text">18.8 Layer 3 IP Security (IPsec)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#internet-key-exchange-ikev2-protocol"><span class="toc-number">18.7.1.</span> <span class="toc-text">18.8.1 Internet Key Exchange (IKEv2) Protocol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#authentication-header-ah"><span class="toc-number">18.7.2.</span> <span class="toc-text">18.8.2 Authentication Header (AH)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encapsulating-security-payload-esp"><span class="toc-number">18.7.3.</span> <span class="toc-text">18.8.3 Encapsulating Security Payload (ESP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast-1"><span class="toc-number">18.7.4.</span> <span class="toc-text">18.8.4 Multicast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#l2tpipsec"><span class="toc-number">18.7.5.</span> <span class="toc-text">18.8.5 L2TP&#x2F;IPsec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipsec-nat-traversal"><span class="toc-number">18.7.6.</span> <span class="toc-text">18.8.6 IPsec NAT Traversal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-8"><span class="toc-number">18.7.7.</span> <span class="toc-text">18.8.7 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transport-layer-security-tls-and-dtls"><span class="toc-number">18.8.</span> <span class="toc-text">18.9 Transport Layer Security (TLS and DTLS)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#tls-1.2"><span class="toc-number">18.8.0.1.</span> <span class="toc-text">18.9.1 TLS 1.2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tls-with-datagrams-dtls"><span class="toc-number">18.8.1.</span> <span class="toc-text">18.9.2 TLS with Datagrams (DTLS)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dns-security-dnssec"><span class="toc-number">18.9.</span> <span class="toc-text">18.10 DNS Security (DNSSEC)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dnssec-resource-records"><span class="toc-number">18.9.1.</span> <span class="toc-text">18.10.1 DNSSEC Resource Records</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dnssec-operation"><span class="toc-number">18.9.2.</span> <span class="toc-text">18.10.2 DNSSEC Operation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#transaction-authentication-tsig-tkey-and-sig0"><span class="toc-number">18.9.3.</span> <span class="toc-text">18.10.3 Transaction Authentication (TSIG, TKEY, and SIG(0))</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dnssec-with-dns64"><span class="toc-number">18.9.4.</span> <span class="toc-text">18.10.4 DNSSEC with DNS64</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#domainkeys-identified-mail-dkim"><span class="toc-number">18.10.</span> <span class="toc-text">18.11 DomainKeys Identified Mail (DKIM)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dkim-signatures"><span class="toc-number">18.10.1.</span> <span class="toc-text">18.11.1 DKIM Signatures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-9"><span class="toc-number">18.10.2.</span> <span class="toc-text">18.11.2 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attacks-on-security-protocols"><span class="toc-number">18.11.</span> <span class="toc-text">18.12 Attacks on Security Protocols</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-17"><span class="toc-number">18.12.</span> <span class="toc-text">18.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references-17"><span class="toc-number">18.13.</span> <span class="toc-text">18.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">19.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#internet-www-difference"><span class="toc-number">20.</span> <span class="toc-text">internet www difference</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/07/dd0ba91b15ab.html" title="code-review"><img src="/img/cover/IMG_3540.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="code-review"/></a><div class="content"><a class="title" href="/2023/07/dd0ba91b15ab.html" title="code-review">code-review</a><time datetime="2023-07-30T08:35:44.805Z" title="Updated 2023-07-30 16:35:44">2023-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/ebd254564c58.html" title="js_interview"><img src="/img/cover/IMG_2502.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js_interview"/></a><div class="content"><a class="title" href="/2023/07/ebd254564c58.html" title="js_interview">js_interview</a><time datetime="2023-07-26T07:39:44.940Z" title="Updated 2023-07-26 15:39:44">2023-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/a6f2ba33bf73.html" title="ts js html"><img src="/img/cover/980fc83b6l8ac6c52817c35e43c0cb4e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ts js html"/></a><div class="content"><a class="title" href="/2023/07/a6f2ba33bf73.html" title="ts js html">ts js html</a><time datetime="2023-07-25T13:22:58.791Z" title="Updated 2023-07-25 21:22:58">2023-07-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/724d57ab8c34.html" title="操作系统"><img src="/img/cover/IMG_2502.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2023/05/724d57ab8c34.html" title="操作系统">操作系统</a><time datetime="2023-07-12T06:22:45.264Z" title="Updated 2023-07-12 14:22:45">2023-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/cd35e6945182.html" title="408目录"><img src="/img/cover/IMG_8780.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="408目录"/></a><div class="content"><a class="title" href="/2023/05/cd35e6945182.html" title="408目录">408目录</a><time datetime="2023-07-12T06:01:12.159Z" title="Updated 2023-07-12 14:01:12">2023-07-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>