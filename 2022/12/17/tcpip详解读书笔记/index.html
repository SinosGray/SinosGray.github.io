<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>tcpip详解读书笔记 | Sinos_wei's blog</title><meta name="author" content="Sinos"><meta name="copyright" content="Sinos"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="tcpip详解读书笔记">
<meta property="og:url" content="https://sinos_wei.gitee.io/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Sinos_wei&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://sinos_wei.gitee.io/img/cover/IMG_3302.JPG">
<meta property="article:published_time" content="2022-12-17T07:59:07.000Z">
<meta property="article:modified_time" content="2022-12-30T03:02:34.287Z">
<meta property="article:author" content="Sinos">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sinos_wei.gitee.io/img/cover/IMG_3302.JPG"><link rel="shortcut icon" href="/img/icon.JPG"><link rel="canonical" href="https://sinos_wei.gitee.io/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?aeddd8219bc5c1e1efdcf5d9cc3218e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'tcpip详解读书笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-30 11:02:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.PNG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/IMG_3302.JPG')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Sinos_wei's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">tcpip详解读书笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-12-17T07:59:07.000Z" title="Created 2022-12-17 15:59:07">2022-12-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-12-30T03:02:34.287Z" title="Updated 2022-12-30 11:02:34">2022-12-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="tcpip详解读书笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
</blockquote>
<span id="more"></span>

<h1 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction" class="headerlink" title="Chapter 1 Introduction"></a>Chapter 1 Introduction</h1><h2 id="1-1-Architectural-Principles"><a href="#1-1-Architectural-Principles" class="headerlink" title="1.1 Architectural Principles"></a>1.1 Architectural Principles</h2><h3 id="1-1-1-Packets-Connections-and-Datagrams"><a href="#1-1-1-Packets-Connections-and-Datagrams" class="headerlink" title="1.1.1 Packets, Connections, and Datagrams"></a>1.1.1 Packets, Connections, and Datagrams</h3><p>分组交换-&gt;多路复用</p>
<p>FIFO-&gt;统计复用</p>
<p>数据报: 所有识别信息都位于分组中而不是交换机中</p>
<p>消息边界: 大部分数据报协议是保留消息边界的(UDP), 但是在电路交换和虚电路网络中, 不会保留消息边界(TCP)</p>
<h3 id="1-1-2-The-End-to-End-Argument-and-Fate-Sharing"><a href="#1-1-2-The-End-to-End-Argument-and-Fate-Sharing" class="headerlink" title="1.1.2 The End-to-End Argument and Fate Sharing"></a>1.1.2 The End-to-End Argument and Fate Sharing</h3><p>端到端论点: 只有在通信系统端角度的应用知识的帮助下，才能完全和正确地实现问题中提到的功能。因此，作为通信自身的一个特点，不可能提供有疑问的功能。（有时， 通信系统提供的一个功能不完整的版本可能用于提高性能。）</p>
<p>命运共享: 建议所有必要的状态放在通信端点</p>
<h3 id="1-1-3-Error-Control-and-Flow-Control"><a href="#1-1-3-Error-Control-and-Flow-Control" class="headerlink" title="1.1.3 Error Control and Flow Control"></a>1.1.3 Error Control and Flow Control</h3><p>差错控制: 网络中, 尽力而为</p>
<p>流量控制: 端</p>
<h2 id="1-2-Design-and-Implementation"><a href="#1-2-Design-and-Implementation" class="headerlink" title="1.2 Design and Implementation"></a>1.2 Design and Implementation</h2><h3 id="1-2-1-Layering"><a href="#1-2-1-Layering" class="headerlink" title="1.2.1 Layering"></a>1.2.1 Layering</h3><p>从底层到高层数字递增</p>
<p>5 层 TCP&#x2F;IP</p>
<p>7 层 OSI</p>
<h3 id="1-2-2-Multiplexing-Demultiplexing-and-Encapsulation-in-Layered-Implementations"><a href="#1-2-2-Multiplexing-Demultiplexing-and-Encapsulation-in-Layered-Implementations" class="headerlink" title="1.2.2 Multiplexing, Demultiplexing, and Encapsulation in Layered Implementations"></a>1.2.2 Multiplexing, Demultiplexing, and Encapsulation in Layered Implementations</h3><p>PDU 协议数据单元</p>
<p>switch, bridge 对网络层透明</p>
<h2 id="1-3-The-Architecture-and-Protocols-of-the-TCP-x2F-IP-Suite"><a href="#1-3-The-Architecture-and-Protocols-of-the-TCP-x2F-IP-Suite" class="headerlink" title="1.3 The Architecture and Protocols of the TCP&#x2F;IP Suite"></a>1.3 The Architecture and Protocols of the TCP&#x2F;IP Suite</h2><h3 id="1-3-1-The-ARPANET-Reference-Model"><a href="#1-3-1-The-ARPANET-Reference-Model" class="headerlink" title="1.3.1 The ARPANET Reference Model"></a>1.3.1 The ARPANET Reference Model</h3><p>三种类型 ip 地址: </p>
<p>单播, 广播, 组播</p>
<p>ICMP, IGMP</p>
<p>DCCP, SCTP</p>
<h3 id="1-3-2-Multiplexing-Demultiplexing-and-Encapsulation-in-TCP-x2F-IP"><a href="#1-3-2-Multiplexing-Demultiplexing-and-Encapsulation-in-TCP-x2F-IP" class="headerlink" title="1.3.2 Multiplexing, Demultiplexing, and Encapsulation in TCP&#x2F;IP"></a>1.3.2 Multiplexing, Demultiplexing, and Encapsulation in TCP&#x2F;IP</h3><p>每层都有一个标识符</p>
<h3 id="1-3-3-Port-Numbers"><a href="#1-3-3-Port-Numbers" class="headerlink" title="1.3.3 Port Numbers"></a>1.3.3 Port Numbers</h3><p>熟知端口号: 0~1023</p>
<p>注册端口号: 1024~49151, 它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。</p>
<p>私有端口号: 49152~65535, 理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p>
<p>奇数端口号</p>
<h3 id="1-3-4-Names-Addresses-and-the-DNS"><a href="#1-3-4-Names-Addresses-and-the-DNS" class="headerlink" title="1.3.4 Names, Addresses, and the DNS"></a>1.3.4 Names, Addresses, and the DNS</h3><h2 id="1-4-Internets-Intranets-and-Extranets"><a href="#1-4-Internets-Intranets-and-Extranets" class="headerlink" title="1.4 Internets, Intranets, and Extranets"></a>1.4 Internets, Intranets, and Extranets</h2><h2 id="1-5-Designing-Applications"><a href="#1-5-Designing-Applications" class="headerlink" title="1.5 Designing Applications"></a>1.5 Designing Applications</h2><h3 id="1-5-1-Client-x2F-Server"><a href="#1-5-1-Client-x2F-Server" class="headerlink" title="1.5.1 Client&#x2F;Server"></a>1.5.1 Client&#x2F;Server</h3><h3 id="1-5-2-Peer-to-Peer"><a href="#1-5-2-Peer-to-Peer" class="headerlink" title="1.5.2 Peer-to-Peer"></a>1.5.2 Peer-to-Peer</h3><h3 id="1-5-3-Application-Programming-Interfaces-APIs"><a href="#1-5-3-Application-Programming-Interfaces-APIs" class="headerlink" title="1.5.3 Application Programming Interfaces (APIs)"></a>1.5.3 Application Programming Interfaces (APIs)</h3><h2 id="1-6-Standardization-Process"><a href="#1-6-Standardization-Process" class="headerlink" title="1.6 Standardization Process"></a>1.6 Standardization Process</h2><h3 id="1-6-1-Request-for-Comments-RFC"><a href="#1-6-1-Request-for-Comments-RFC" class="headerlink" title="1.6.1 Request for Comments (RFC)"></a>1.6.1 Request for Comments (RFC)</h3><h3 id="1-6-2-Other-Standards"><a href="#1-6-2-Other-Standards" class="headerlink" title="1.6.2 Other Standards"></a>1.6.2 Other Standards</h3><h2 id="1-7-Implementations-and-Software-Distributions"><a href="#1-7-Implementations-and-Software-Distributions" class="headerlink" title="1.7 Implementations and Software Distributions"></a>1.7 Implementations and Software Distributions</h2><h2 id="1-8-Attacks-Involving-the-Internet-Architecture"><a href="#1-8-Attacks-Involving-the-Internet-Architecture" class="headerlink" title="1.8 Attacks Involving the Internet Architecture"></a>1.8 Attacks Involving the Internet Architecture</h2><h2 id="1-9-Summary"><a href="#1-9-Summary" class="headerlink" title="1.9 Summary"></a>1.9 Summary</h2><h2 id="1-10-References"><a href="#1-10-References" class="headerlink" title="1.10 References"></a>1.10 References</h2><h1 id="Chapter-2-The-Internet-Address-Architecture"><a href="#Chapter-2-The-Internet-Address-Architecture" class="headerlink" title="Chapter 2 The Internet Address Architecture"></a>Chapter 2 The Internet Address Architecture</h1><h2 id="2-1-Introduction"><a href="#2-1-Introduction" class="headerlink" title="2.1 Introduction"></a>2.1 Introduction</h2><h2 id="2-2-Expressing-IP-Addresses"><a href="#2-2-Expressing-IP-Addresses" class="headerlink" title="2.2 Expressing IP Addresses"></a>2.2 Expressing IP Addresses</h2><p>ipv4: 4*8 &#x3D; 32</p>
<p>ipv6: 8*16 &#x3D; 128</p>
<p>ipv6 写法标准:</p>
<ol>
<li>一个块中前导的零不必书写。在前面的例子中，地址可写为 5f05:2000:80ad:5800:58:800:2023:1d71。 </li>
<li>全零的块可以省略，并用符号：代替。例如，IPv6 地址0:0:0:0:0:0:0:1可简写为 ::1.  同样，地址 2001:0db8:0:0:0:0:0:2可简写为 2001:db8::2。为了避免出现歧义，一个 IPv6 地址 中符号 :: 只能使用一次。 </li>
<li>在IPv6 格式中嵌入IPv4 地址可使用混合符号形式，紧接着 IPv4 部分的地址块的值为ffff，地址的其余部分使用点分四组格式。例如，IPv6 地址 ::ffff:10.0.0.1可表示 IPv4 地址 10.0.0.1。它被称为IPv4 映射的 IPv6 地址。 </li>
<li>IPv6 地址的低 32 位通常采用点分四组表示法。因此，IPv6 地址 ::0102:f001 相当于地址：::1.2.240.1。它被称为IPv4 兼容的 IPv6 地址。需要注意，IPv4 兼容地址与IPv4 映射地址不同；它们只是在能用类似 IPv4 地址的方式书写或由软件处理方面给人以兼容的感觉。这种地 址最初用于 IPv4 和 IPv6 之间的过渡计划，但现在不再需要 [RFC4291]。</li>
<li>前导的零必须压缩（例如，2001:0db8::0022变成 2001:db8::22)</li>
<li>:: 只能用于影响最大的地方（压缩最多的零)，但并不只是针对16位的块。如果多个块中包含等长度的零，顺序靠前的块将被替换为 ::</li>
<li>a 到 f 的十六进制数字应该用小写表示。</li>
</ol>
<p>在大多数情况下，我们会遵守这些规则。</p>
<h2 id="2-3-Basic-IP-Address-Structure"><a href="#2-3-Basic-IP-Address-Structure" class="headerlink" title="2.3 Basic IP Address Structure"></a>2.3 Basic IP Address Structure</h2><h3 id="2-3-1-Classful-Addressing"><a href="#2-3-1-Classful-Addressing" class="headerlink" title="2.3.1 Classful Addressing"></a>2.3.1 Classful Addressing</h3><p>(192 是 C 类地址)</p>
<p>ABC 用于单播地址</p>
<p>有几个地址通常不作为单播地址使用, 特别是第一个和最后一个, 一般要-2</p>
<p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h9ib4d26ecj30v00i2wfz.jpg" alt="截屏2022-12-27 13.32.26"></p>
<h3 id="2-3-2-Subnet-Addressing"><a href="#2-3-2-Subnet-Addressing" class="headerlink" title="2.3.2 Subnet Addressing"></a>2.3.2 Subnet Addressing</h3><p>将主机号划分为子网 id 和主机 id</p>
<h3 id="2-3-3-Subnet-Masks"><a href="#2-3-3-Subnet-Masks" class="headerlink" title="2.3.3 Subnet Masks"></a>2.3.3 Subnet Masks</h3><p>子网掩码用来划分子网id和主机id</p>
<p>外部 router 不关心子网掩码</p>
<h3 id="2-3-4-Variable-Length-Subnet-Masks-VLSM"><a href="#2-3-4-Variable-Length-Subnet-Masks-VLSM" class="headerlink" title="2.3.4 Variable-Length Subnet Masks (VLSM)"></a>2.3.4 Variable-Length Subnet Masks (VLSM)</h3><p>每个子网可以使用不同长度的子网掩码</p>
<h3 id="2-3-5-Broadcast-Addresses"><a href="#2-3-5-Broadcast-Addresses" class="headerlink" title="2.3.5 Broadcast Addresses"></a>2.3.5 Broadcast Addresses</h3><p>(子网广播地址)</p>
<p>即网络id 子网 id 不变, 将主机 id 全部设置为 1</p>
<p>但是这种定向广播是又问同样的, 在 internet 中被禁用</p>
<p>本地网络广播; 255.255.255.255, 不会被路由器转发, 但是同一网络中的其他主机会收到</p>
<h3 id="2-3-6-IPv6-Addresses-and-Interface-Identifiers"><a href="#2-3-6-IPv6-Addresses-and-Interface-Identifiers" class="headerlink" title="2.3.6 IPv6 Addresses and Interface Identifiers"></a>2.3.6 IPv6 Addresses and Interface Identifiers</h3><h2 id="2-4-CIDR-Classless-Inter-Domain-Routing-and-Aggregation"><a href="#2-4-CIDR-Classless-Inter-Domain-Routing-and-Aggregation" class="headerlink" title="2.4 CIDR(Classless Inter-Domain Routing) and Aggregation"></a>2.4 CIDR(Classless Inter-Domain Routing) and Aggregation</h2><p>为了解决两个问题: ip 不足, 以及路由表过大</p>
<h3 id="2-4-1-Prefixes"><a href="#2-4-1-Prefixes" class="headerlink" title="2.4.1 Prefixes"></a>2.4.1 Prefixes</h3><p>类似 VLSM, CIDR掩码可以采用任意长度,  这个掩码是全球路由系统可见的, 这个又叫网络前缀</p>
<h3 id="2-4-2-Aggregation-聚合"><a href="#2-4-2-Aggregation-聚合" class="headerlink" title="2.4.2 Aggregation 聚合"></a>2.4.2 Aggregation 聚合</h3><p>分层路由: ip 地址与路由器的拓扑位置有关</p>
<p>在 internet 中, 通过将相邻的多个 ip 前缀合并为一个短前缀的过程叫做聚合</p>
<h2 id="2-5-Special-Use-Addresses"><a href="#2-5-Special-Use-Addresses" class="headerlink" title="2.5 Special-Use Addresses"></a>2.5 Special-Use Addresses</h2><p>0.0.0.0&#x2F;8 本地主机</p>
<p>127.0.0.1 主机回送地址</p>
<p>172.16.0.0&#x2F;12, 192.168.0.0&#x2F;16专用网络, 内联网地址, 不会出现在公共网中</p>
<p>255.255.255.255&#x2F;32 本地网络广播地址</p>
<h3 id="2-5-1-Addressing-IPv4-x2F-IPv6-Translators"><a href="#2-5-1-Addressing-IPv4-x2F-IPv6-Translators" class="headerlink" title="2.5.1 Addressing IPv4&#x2F;IPv6 Translators"></a>2.5.1 Addressing IPv4&#x2F;IPv6 Translators</h3><p>嵌入 ipv4 的 ipv6 地址</p>
<h3 id="2-5-2-Multicast-Addresses"><a href="#2-5-2-Multicast-Addresses" class="headerlink" title="2.5.2 Multicast Addresses"></a>2.5.2 Multicast Addresses</h3><p>ASM 任意源组播</p>
<p>SSM 特定组播, 每个组只使用一个方发送方</p>
<h3 id="2-5-3-IPv4-Multicast-Addresses"><a href="#2-5-3-IPv4-Multicast-Addresses" class="headerlink" title="2.5.3 IPv4 Multicast Addresses"></a>2.5.3 IPv4 Multicast Addresses</h3><h3 id="2-5-4-IPv6-Multicast-Addresses"><a href="#2-5-4-IPv6-Multicast-Addresses" class="headerlink" title="2.5.4 IPv6 Multicast Addresses"></a>2.5.4 IPv6 Multicast Addresses</h3><h3 id="2-5-5-Anycast-Addresses"><a href="#2-5-5-Anycast-Addresses" class="headerlink" title="2.5.5 Anycast Addresses"></a>2.5.5 Anycast Addresses</h3><h2 id="2-6-Allocation"><a href="#2-6-Allocation" class="headerlink" title="2.6 Allocation"></a>2.6 Allocation</h2><h3 id="2-6-1-Unicast"><a href="#2-6-1-Unicast" class="headerlink" title="2.6.1 Unicast"></a>2.6.1 Unicast</h3><p>RIR(Regional Internet Registry) -&gt; ISP -&gt; 客户</p>
<ul>
<li>PA 供应商聚合</li>
<li>PI 供应商独立</li>
</ul>
<p>供应商倾向使用 PA, 因为可以进行聚合减小路由表, PI 一般需要额外收费</p>
<h3 id="2-6-2-Multicast"><a href="#2-6-2-Multicast" class="headerlink" title="2.6.2 Multicast"></a>2.6.2 Multicast</h3><h2 id="2-7-Unicast-Address-Assignment"><a href="#2-7-Unicast-Address-Assignment" class="headerlink" title="2.7 Unicast Address Assignment"></a>2.7 Unicast Address Assignment</h2><h3 id="2-7-1-Single-Provider-x2F-No-Network-x2F-Single-Address"><a href="#2-7-1-Single-Provider-x2F-No-Network-x2F-Single-Address" class="headerlink" title="2.7.1 Single Provider&#x2F;No Network&#x2F;Single Address"></a>2.7.1 Single Provider&#x2F;No Network&#x2F;Single Address</h3><p>单设备</p>
<h3 id="2-7-2-Single-Provider-x2F-Single-Network-x2F-Single-Address"><a href="#2-7-2-Single-Provider-x2F-Single-Network-x2F-Single-Address" class="headerlink" title="2.7.2 Single Provider&#x2F;Single Network&#x2F;Single Address"></a>2.7.2 Single Provider&#x2F;Single Network&#x2F;Single Address</h3><p>LAN: 路由器</p>
<h3 id="2-7-3-Single-Provider-x2F-Multiple-Networks-x2F-Multiple-Addresses"><a href="#2-7-3-Single-Provider-x2F-Multiple-Networks-x2F-Multiple-Addresses" class="headerlink" title="2.7.3 Single Provider&#x2F;Multiple Networks&#x2F;Multiple Addresses"></a>2.7.3 Single Provider&#x2F;Multiple Networks&#x2F;Multiple Addresses</h3><p>DMZ(demilitarized zone)</p>
<h3 id="2-7-4-Multiple-Providers-x2F-Multiple-Networks-x2F-Multiple-Addresses-Multihoming"><a href="#2-7-4-Multiple-Providers-x2F-Multiple-Networks-x2F-Multiple-Addresses-Multihoming" class="headerlink" title="2.7.4 Multiple Providers&#x2F;Multiple Networks&#x2F;Multiple Addresses (Multihoming)"></a>2.7.4 Multiple Providers&#x2F;Multiple Networks&#x2F;Multiple Addresses (Multihoming)</h3><h2 id="2-8-Attacks-Involving-IP-Addresses"><a href="#2-8-Attacks-Involving-IP-Addresses" class="headerlink" title="2.8 Attacks Involving IP Addresses"></a>2.8 Attacks Involving IP Addresses</h2><h2 id="2-9-Summary"><a href="#2-9-Summary" class="headerlink" title="2.9 Summary"></a>2.9 Summary</h2><h2 id="2-10-References"><a href="#2-10-References" class="headerlink" title="2.10 References"></a>2.10 References</h2><h1 id="Chapter-3-Link-Layer"><a href="#Chapter-3-Link-Layer" class="headerlink" title="Chapter 3 Link Layer"></a>Chapter 3 Link Layer</h1><h2 id="3-1-Introduction"><a href="#3-1-Introduction" class="headerlink" title="3.1 Introduction"></a>3.1 Introduction</h2><h2 id="3-2-Ethernet-and-the-IEEE-802-LAN-x2F-MAN-Standards"><a href="#3-2-Ethernet-and-the-IEEE-802-LAN-x2F-MAN-Standards" class="headerlink" title="3.2 Ethernet and the IEEE 802 LAN&#x2F;MAN Standards"></a>3.2 Ethernet and the IEEE 802 LAN&#x2F;MAN Standards</h2><h3 id="3-2-1-The-IEEE-802-LAN-x2F-MAN-Standards"><a href="#3-2-1-The-IEEE-802-LAN-x2F-MAN-Standards" class="headerlink" title="3.2.1 The IEEE 802 LAN&#x2F;MAN Standards"></a>3.2.1 The IEEE 802 LAN&#x2F;MAN Standards</h3><h3 id="3-2-2-The-Ethernet-Frame-Format"><a href="#3-2-2-The-Ethernet-Frame-Format" class="headerlink" title="3.2.2 The Ethernet Frame Format"></a>3.2.2 The Ethernet Frame Format</h3><h4 id="3-2-3-802-1p-x2F-q-Virtual-LANs-and-QoS-Tagging"><a href="#3-2-3-802-1p-x2F-q-Virtual-LANs-and-QoS-Tagging" class="headerlink" title="3.2.3 802.1p&#x2F;q: Virtual LANs and QoS Tagging"></a>3.2.3 802.1p&#x2F;q: Virtual LANs and QoS Tagging</h4><h5 id="3-2-4-802-1AX-Link-Aggregation-Formerly-802-3ad"><a href="#3-2-4-802-1AX-Link-Aggregation-Formerly-802-3ad" class="headerlink" title="3.2.4 802.1AX: Link Aggregation (Formerly 802.3ad)"></a>3.2.4 802.1AX: Link Aggregation (Formerly 802.3ad)</h5><h3 id="3-3-Full-Duplex-Power-Save-Autonegotiation-and-802-1X-Flow-Control"><a href="#3-3-Full-Duplex-Power-Save-Autonegotiation-and-802-1X-Flow-Control" class="headerlink" title="3.3 Full Duplex, Power Save, Autonegotiation, and 802.1X Flow Control"></a>3.3 Full Duplex, Power Save, Autonegotiation, and 802.1X Flow Control</h3><h3 id="3-3-1-Duplex-Mismatch"><a href="#3-3-1-Duplex-Mismatch" class="headerlink" title="3.3.1 Duplex Mismatch"></a>3.3.1 Duplex Mismatch</h3><h3 id="3-3-2-Wake-on-LAN-WoL-Power-Saving-and-Magic-Packets"><a href="#3-3-2-Wake-on-LAN-WoL-Power-Saving-and-Magic-Packets" class="headerlink" title="3.3.2 Wake-on LAN (WoL), Power Saving, and Magic Packets"></a>3.3.2 Wake-on LAN (WoL), Power Saving, and Magic Packets</h3><h3 id="3-3-3-Link-Layer-Flow-Control"><a href="#3-3-3-Link-Layer-Flow-Control" class="headerlink" title="3.3.3 Link-Layer Flow Control"></a>3.3.3 Link-Layer Flow Control</h3><h2 id="3-4-Bridges-and-Switches"><a href="#3-4-Bridges-and-Switches" class="headerlink" title="3.4 Bridges and Switches"></a>3.4 Bridges and Switches</h2><h3 id="3-4-1-Spanning-Tree-Protocol-STP"><a href="#3-4-1-Spanning-Tree-Protocol-STP" class="headerlink" title="3.4.1 Spanning Tree Protocol (STP)"></a>3.4.1 Spanning Tree Protocol (STP)</h3><h4 id="3-4-2-802-1ak-Multiple-Registration-Protocol-MRP"><a href="#3-4-2-802-1ak-Multiple-Registration-Protocol-MRP" class="headerlink" title="3.4.2 802.1ak: Multiple Registration Protocol (MRP)"></a>3.4.2 802.1ak: Multiple Registration Protocol (MRP)</h4><h3 id="3-5-Wireless-LANs—IEEE-802-11-Wi-Fi"><a href="#3-5-Wireless-LANs—IEEE-802-11-Wi-Fi" class="headerlink" title="3.5 Wireless LANs—IEEE 802.11(Wi-Fi)"></a>3.5 Wireless LANs—IEEE 802.11(Wi-Fi)</h3><h4 id="3-5-1-802-11-Frames"><a href="#3-5-1-802-11-Frames" class="headerlink" title="3.5.1 802.11 Frames"></a>3.5.1 802.11 Frames</h4><h3 id="3-5-2-Power-Save-Mode-and-the-Time-Sync-Function-TSF"><a href="#3-5-2-Power-Save-Mode-and-the-Time-Sync-Function-TSF" class="headerlink" title="3.5.2 Power Save Mode and the Time Sync Function (TSF)"></a>3.5.2 Power Save Mode and the Time Sync Function (TSF)</h3><h4 id="3-5-3-802-11-Media-Access-Control"><a href="#3-5-3-802-11-Media-Access-Control" class="headerlink" title="3.5.3 802.11 Media Access Control"></a>3.5.3 802.11 Media Access Control</h4><h3 id="3-5-4-Physical-Layer-Details-Rates-Channels-and-Frequencies"><a href="#3-5-4-Physical-Layer-Details-Rates-Channels-and-Frequencies" class="headerlink" title="3.5.4 Physical-Layer Details: Rates, Channels, and Frequencies"></a>3.5.4 Physical-Layer Details: Rates, Channels, and Frequencies</h3><h3 id="3-5-5-Wi-Fi-Security"><a href="#3-5-5-Wi-Fi-Security" class="headerlink" title="3.5.5 Wi-Fi Security"></a>3.5.5 Wi-Fi Security</h3><h4 id="3-5-6-Wi-Fi-Mesh-802-11s"><a href="#3-5-6-Wi-Fi-Mesh-802-11s" class="headerlink" title="3.5.6 Wi-Fi Mesh (802.11s)"></a>3.5.6 Wi-Fi Mesh (802.11s)</h4><h2 id="3-6-Point-to-Point-Protocol-PPP"><a href="#3-6-Point-to-Point-Protocol-PPP" class="headerlink" title="3.6 Point-to-Point Protocol (PPP)"></a>3.6 Point-to-Point Protocol (PPP)</h2><h3 id="3-6-1-Link-Control-Protocol-LCP"><a href="#3-6-1-Link-Control-Protocol-LCP" class="headerlink" title="3.6.1 Link Control Protocol (LCP)"></a>3.6.1 Link Control Protocol (LCP)</h3><h3 id="3-6-2-Multilink-PPP-MP"><a href="#3-6-2-Multilink-PPP-MP" class="headerlink" title="3.6.2 Multilink PPP (MP)"></a>3.6.2 Multilink PPP (MP)</h3><h3 id="3-6-3-Compression-Control-Protocol-CCP"><a href="#3-6-3-Compression-Control-Protocol-CCP" class="headerlink" title="3.6.3 Compression Control Protocol (CCP)"></a>3.6.3 Compression Control Protocol (CCP)</h3><h3 id="3-6-4-PPP-Authentication"><a href="#3-6-4-PPP-Authentication" class="headerlink" title="3.6.4 PPP Authentication"></a>3.6.4 PPP Authentication</h3><h3 id="3-6-5-Network-Control-Protocols-NCPs"><a href="#3-6-5-Network-Control-Protocols-NCPs" class="headerlink" title="3.6.5 Network Control Protocols (NCPs)"></a>3.6.5 Network Control Protocols (NCPs)</h3><h3 id="3-6-6-Header-Compression"><a href="#3-6-6-Header-Compression" class="headerlink" title="3.6.6 Header Compression"></a>3.6.6 Header Compression</h3><h3 id="3-6-7-Example"><a href="#3-6-7-Example" class="headerlink" title="3.6.7 Example"></a>3.6.7 Example</h3><h2 id="3-7-Loopback"><a href="#3-7-Loopback" class="headerlink" title="3.7 Loopback"></a>3.7 Loopback</h2><h2 id="3-8-MTU-and-Path-MTU"><a href="#3-8-MTU-and-Path-MTU" class="headerlink" title="3.8 MTU and Path MTU"></a>3.8 MTU and Path MTU</h2><h2 id="3-9-Tunneling-Basics"><a href="#3-9-Tunneling-Basics" class="headerlink" title="3.9 Tunneling Basics"></a>3.9 Tunneling Basics</h2><h3 id="3-9-1-Unidirectional-Links"><a href="#3-9-1-Unidirectional-Links" class="headerlink" title="3.9.1 Unidirectional Links"></a>3.9.1 Unidirectional Links</h3><h2 id="3-10-Attacks-on-the-Link-Layer"><a href="#3-10-Attacks-on-the-Link-Layer" class="headerlink" title="3.10 Attacks on the Link Layer"></a>3.10 Attacks on the Link Layer</h2><h2 id="3-11-Summary"><a href="#3-11-Summary" class="headerlink" title="3.11 Summary"></a>3.11 Summary</h2><h2 id="3-12-References"><a href="#3-12-References" class="headerlink" title="3.12 References"></a>3.12 References</h2><h1 id="Chapter-4-ARP-Address-Resolution-Protocol"><a href="#Chapter-4-ARP-Address-Resolution-Protocol" class="headerlink" title="Chapter 4 ARP: Address Resolution Protocol"></a>Chapter 4 ARP: Address Resolution Protocol</h1><h2 id="4-1-Introduction"><a href="#4-1-Introduction" class="headerlink" title="4.1 Introduction"></a>4.1 Introduction</h2><h2 id="4-2-An-Example"><a href="#4-2-An-Example" class="headerlink" title="4.2 An Example"></a>4.2 An Example</h2><h3 id="4-2-1-Direct-Delivery-and-ARP"><a href="#4-2-1-Direct-Delivery-and-ARP" class="headerlink" title="4.2.1 Direct Delivery and ARP"></a>4.2.1 Direct Delivery and ARP</h3><h2 id="4-3-ARP-Cache"><a href="#4-3-ARP-Cache" class="headerlink" title="4.3 ARP Cache"></a>4.3 ARP Cache</h2><h2 id="4-4-ARP-Frame-Format"><a href="#4-4-ARP-Frame-Format" class="headerlink" title="4.4 ARP Frame Format"></a>4.4 ARP Frame Format</h2><h2 id="4-5-ARP-Examples"><a href="#4-5-ARP-Examples" class="headerlink" title="4.5 ARP Examples"></a>4.5 ARP Examples</h2><h3 id="4-5-1-Normal-Example"><a href="#4-5-1-Normal-Example" class="headerlink" title="4.5.1 Normal Example"></a>4.5.1 Normal Example</h3><h3 id="4-5-2-ARP-Request-to-a-Nonexistent-Host"><a href="#4-5-2-ARP-Request-to-a-Nonexistent-Host" class="headerlink" title="4.5.2 ARP Request to a Nonexistent Host"></a>4.5.2 ARP Request to a Nonexistent Host</h3><h2 id="4-6-ARP-Cache-Timeout"><a href="#4-6-ARP-Cache-Timeout" class="headerlink" title="4.6 ARP Cache Timeout"></a>4.6 ARP Cache Timeout</h2><h2 id="4-7-Proxy-ARP"><a href="#4-7-Proxy-ARP" class="headerlink" title="4.7 Proxy ARP"></a>4.7 Proxy ARP</h2><h2 id="4-8-Gratuitous-ARP-and-Address-Conflict-Detection-ACD"><a href="#4-8-Gratuitous-ARP-and-Address-Conflict-Detection-ACD" class="headerlink" title="4.8 Gratuitous ARP and Address Conflict Detection (ACD)"></a>4.8 Gratuitous ARP and Address Conflict Detection (ACD)</h2><h2 id="4-9-The-arp-Command"><a href="#4-9-The-arp-Command" class="headerlink" title="4.9 The arp Command"></a>4.9 The arp Command</h2><h2 id="4-10-Using-ARP-to-Set-an-Embedded-Device’s-IPv4-Address"><a href="#4-10-Using-ARP-to-Set-an-Embedded-Device’s-IPv4-Address" class="headerlink" title="4.10 Using ARP to Set an Embedded Device’s IPv4 Address"></a>4.10 Using ARP to Set an Embedded Device’s IPv4 Address</h2><h2 id="4-11-Attacks-Involving-ARP"><a href="#4-11-Attacks-Involving-ARP" class="headerlink" title="4.11 Attacks Involving ARP"></a>4.11 Attacks Involving ARP</h2><h2 id="4-12-Summary"><a href="#4-12-Summary" class="headerlink" title="4.12 Summary"></a>4.12 Summary</h2><h2 id="4-13-References"><a href="#4-13-References" class="headerlink" title="4.13 References"></a>4.13 References</h2><h1 id="Chapter-5-The-Internet-Protocol-IP"><a href="#Chapter-5-The-Internet-Protocol-IP" class="headerlink" title="Chapter 5 The Internet Protocol (IP)"></a>Chapter 5 The Internet Protocol (IP)</h1><h2 id="5-1-Introduction"><a href="#5-1-Introduction" class="headerlink" title="5.1 Introduction"></a>5.1 Introduction</h2><h2 id="5-2-IPv4-and-IPv6-Headers"><a href="#5-2-IPv4-and-IPv6-Headers" class="headerlink" title="5.2 IPv4 and IPv6 Headers"></a>5.2 IPv4 and IPv6 Headers</h2><h3 id="5-2-1-IP-Header-Fields"><a href="#5-2-1-IP-Header-Fields" class="headerlink" title="5.2.1 IP Header Fields"></a>5.2.1 IP Header Fields</h3><h3 id="5-2-2-The-Internet-Checksum"><a href="#5-2-2-The-Internet-Checksum" class="headerlink" title="5.2.2 The Internet Checksum"></a>5.2.2 The Internet Checksum</h3><h3 id="5-2-3-DS-Field-and-ECN-Formerly-Called-the-ToS-Byte-or-IPv6-Traffic-Class"><a href="#5-2-3-DS-Field-and-ECN-Formerly-Called-the-ToS-Byte-or-IPv6-Traffic-Class" class="headerlink" title="5.2.3 DS Field and ECN (Formerly Called the ToS Byte or IPv6 Traffic Class)"></a>5.2.3 DS Field and ECN (Formerly Called the ToS Byte or IPv6 Traffic Class)</h3><h3 id="5-2-4-IP-Options"><a href="#5-2-4-IP-Options" class="headerlink" title="5.2.4 IP Options"></a>5.2.4 IP Options</h3><h2 id="5-3-IPv6-Extension-Headers"><a href="#5-3-IPv6-Extension-Headers" class="headerlink" title="5.3 IPv6 Extension Headers"></a>5.3 IPv6 Extension Headers</h2><h3 id="5-3-1-IPv6-Options"><a href="#5-3-1-IPv6-Options" class="headerlink" title="5.3.1 IPv6 Options"></a>5.3.1 IPv6 Options</h3><h3 id="5-3-2-Routing-Header"><a href="#5-3-2-Routing-Header" class="headerlink" title="5.3.2 Routing Header"></a>5.3.2 Routing Header</h3><h3 id="5-3-3-Fragment-Header"><a href="#5-3-3-Fragment-Header" class="headerlink" title="5.3.3 Fragment Header"></a>5.3.3 Fragment Header</h3><h2 id="5-4-IP-Forwarding"><a href="#5-4-IP-Forwarding" class="headerlink" title="5.4 IP Forwarding"></a>5.4 IP Forwarding</h2><h3 id="5-4-1-Forwarding-Table"><a href="#5-4-1-Forwarding-Table" class="headerlink" title="5.4.1 Forwarding Table"></a>5.4.1 Forwarding Table</h3><h3 id="5-4-2-IP-Forwarding-Actions"><a href="#5-4-2-IP-Forwarding-Actions" class="headerlink" title="5.4.2 IP Forwarding Actions"></a>5.4.2 IP Forwarding Actions</h3><h3 id="5-4-3-Examples"><a href="#5-4-3-Examples" class="headerlink" title="5.4.3 Examples"></a>5.4.3 Examples</h3><h3 id="5-4-4-Discussion"><a href="#5-4-4-Discussion" class="headerlink" title="5.4.4 Discussion"></a>5.4.4 Discussion</h3><h2 id="5-5-Mobile-IP"><a href="#5-5-Mobile-IP" class="headerlink" title="5.5 Mobile IP"></a>5.5 Mobile IP</h2><h3 id="5-5-1-The-Basic-Model-Bidirectional-Tunneling"><a href="#5-5-1-The-Basic-Model-Bidirectional-Tunneling" class="headerlink" title="5.5.1 The Basic Model: Bidirectional Tunneling"></a>5.5.1 The Basic Model: Bidirectional Tunneling</h3><h3 id="5-5-2-Route-Optimization-RO"><a href="#5-5-2-Route-Optimization-RO" class="headerlink" title="5.5.2 Route Optimization (RO)"></a>5.5.2 Route Optimization (RO)</h3><h3 id="5-5-3-Discussion"><a href="#5-5-3-Discussion" class="headerlink" title="5.5.3 Discussion"></a>5.5.3 Discussion</h3><h2 id="5-6-Host-Processing-of-IP-Datagrams"><a href="#5-6-Host-Processing-of-IP-Datagrams" class="headerlink" title="5.6 Host Processing of IP Datagrams"></a>5.6 Host Processing of IP Datagrams</h2><h3 id="5-6-1-Host-Models"><a href="#5-6-1-Host-Models" class="headerlink" title="5.6.1 Host Models"></a>5.6.1 Host Models</h3><h3 id="5-6-2-Address-Selection"><a href="#5-6-2-Address-Selection" class="headerlink" title="5.6.2 Address Selection"></a>5.6.2 Address Selection</h3><h2 id="5-7-Attacks-Involving-IP"><a href="#5-7-Attacks-Involving-IP" class="headerlink" title="5.7 Attacks Involving IP"></a>5.7 Attacks Involving IP</h2><h2 id="5-8-Summary"><a href="#5-8-Summary" class="headerlink" title="5.8 Summary"></a>5.8 Summary</h2><h2 id="5-9-References"><a href="#5-9-References" class="headerlink" title="5.9 References"></a>5.9 References</h2><h1 id="Chapter-6-System-Configuration-DHCP-and-Autoconfiguration"><a href="#Chapter-6-System-Configuration-DHCP-and-Autoconfiguration" class="headerlink" title="Chapter 6 System Configuration: DHCP and Autoconfiguration"></a>Chapter 6 System Configuration: DHCP and Autoconfiguration</h1><h2 id="6-1-Introduction"><a href="#6-1-Introduction" class="headerlink" title="6.1 Introduction"></a>6.1 Introduction</h2><h2 id="6-2-Dynamic-Host-Configuration-Protocol-DHCP"><a href="#6-2-Dynamic-Host-Configuration-Protocol-DHCP" class="headerlink" title="6.2 Dynamic Host Configuration Protocol (DHCP)"></a>6.2 Dynamic Host Configuration Protocol (DHCP)</h2><h3 id="6-2-1-Address-Pools-and-Leases"><a href="#6-2-1-Address-Pools-and-Leases" class="headerlink" title="6.2.1 Address Pools and Leases"></a>6.2.1 Address Pools and Leases</h3><h3 id="6-2-2-DHCP-and-BOOTP-Message-Format"><a href="#6-2-2-DHCP-and-BOOTP-Message-Format" class="headerlink" title="6.2.2 DHCP and BOOTP Message Format"></a>6.2.2 DHCP and BOOTP Message Format</h3><h3 id="6-2-3-DHCP-and-BOOTP-Options"><a href="#6-2-3-DHCP-and-BOOTP-Options" class="headerlink" title="6.2.3 DHCP and BOOTP Options"></a>6.2.3 DHCP and BOOTP Options</h3><h3 id="6-2-4-DHCP-Protocol-Operation"><a href="#6-2-4-DHCP-Protocol-Operation" class="headerlink" title="6.2.4 DHCP Protocol Operation"></a>6.2.4 DHCP Protocol Operation</h3><h3 id="6-2-5-DHCPv6"><a href="#6-2-5-DHCPv6" class="headerlink" title="6.2.5 DHCPv6"></a>6.2.5 DHCPv6</h3><h3 id="6-2-6-Using-DHCP-with-Relays"><a href="#6-2-6-Using-DHCP-with-Relays" class="headerlink" title="6.2.6 Using DHCP with Relays"></a>6.2.6 Using DHCP with Relays</h3><h3 id="6-2-7-DHCP-Authentication"><a href="#6-2-7-DHCP-Authentication" class="headerlink" title="6.2.7 DHCP Authentication"></a>6.2.7 DHCP Authentication</h3><h3 id="6-2-8-Reconfigure-Extension"><a href="#6-2-8-Reconfigure-Extension" class="headerlink" title="6.2.8 Reconfigure Extension"></a>6.2.8 Reconfigure Extension</h3><h3 id="6-2-9-Rapid-Commit"><a href="#6-2-9-Rapid-Commit" class="headerlink" title="6.2.9 Rapid Commit"></a>6.2.9 Rapid Commit</h3><h3 id="6-2-10-Location-Information-LCI-and-LoST"><a href="#6-2-10-Location-Information-LCI-and-LoST" class="headerlink" title="6.2.10 Location Information (LCI and LoST)"></a>6.2.10 Location Information (LCI and LoST)</h3><h3 id="6-2-11-Mobility-and-Handoff-Information-MoS-and-ANDSF"><a href="#6-2-11-Mobility-and-Handoff-Information-MoS-and-ANDSF" class="headerlink" title="6.2.11 Mobility and Handoff Information (MoS and ANDSF)"></a>6.2.11 Mobility and Handoff Information (MoS and ANDSF)</h3><h3 id="6-2-12-DHCP-Snooping"><a href="#6-2-12-DHCP-Snooping" class="headerlink" title="6.2.12 DHCP Snooping"></a>6.2.12 DHCP Snooping</h3><h2 id="6-3-Stateless-Address-Autoconfiguration-SLAAC"><a href="#6-3-Stateless-Address-Autoconfiguration-SLAAC" class="headerlink" title="6.3 Stateless Address Autoconfiguration (SLAAC)"></a>6.3 Stateless Address Autoconfiguration (SLAAC)</h2><h3 id="6-3-1-Dynamic-Configuration-of-IPv4-Link-Local-Addresses"><a href="#6-3-1-Dynamic-Configuration-of-IPv4-Link-Local-Addresses" class="headerlink" title="6.3.1 Dynamic Configuration of IPv4 Link-Local Addresses"></a>6.3.1 Dynamic Configuration of IPv4 Link-Local Addresses</h3><h3 id="6-3-2-IPv6-SLAAC-for-Link-Local-Addresses"><a href="#6-3-2-IPv6-SLAAC-for-Link-Local-Addresses" class="headerlink" title="6.3.2 IPv6 SLAAC for Link-Local Addresses"></a>6.3.2 IPv6 SLAAC for Link-Local Addresses</h3><h2 id="6-4-DHCP-and-DNS-Interaction"><a href="#6-4-DHCP-and-DNS-Interaction" class="headerlink" title="6.4 DHCP and DNS Interaction"></a>6.4 DHCP and DNS Interaction</h2><h2 id="6-5-PPP-over-Ethernet-PPPoE"><a href="#6-5-PPP-over-Ethernet-PPPoE" class="headerlink" title="6.5 PPP over Ethernet (PPPoE)"></a>6.5 PPP over Ethernet (PPPoE)</h2><h2 id="6-6-Attacks-Involving-System-Configuration"><a href="#6-6-Attacks-Involving-System-Configuration" class="headerlink" title="6.6 Attacks Involving System Configuration"></a>6.6 Attacks Involving System Configuration</h2><h2 id="6-7-Summary"><a href="#6-7-Summary" class="headerlink" title="6.7 Summary"></a>6.7 Summary</h2><h2 id="6-8-References"><a href="#6-8-References" class="headerlink" title="6.8 References"></a>6.8 References</h2><h1 id="Chapter-7-Firewalls-and-Network-Address-Translation-NAT"><a href="#Chapter-7-Firewalls-and-Network-Address-Translation-NAT" class="headerlink" title="Chapter 7 Firewalls and Network Address Translation (NAT)"></a>Chapter 7 Firewalls and Network Address Translation (NAT)</h1><h2 id="7-1-Introduction"><a href="#7-1-Introduction" class="headerlink" title="7.1 Introduction"></a>7.1 Introduction</h2><h2 id="7-2-Firewalls"><a href="#7-2-Firewalls" class="headerlink" title="7.2 Firewalls"></a>7.2 Firewalls</h2><h3 id="7-2-1-Packet-Filtering-Firewalls"><a href="#7-2-1-Packet-Filtering-Firewalls" class="headerlink" title="7.2.1 Packet-Filtering Firewalls"></a>7.2.1 Packet-Filtering Firewalls</h3><h3 id="7-2-2-Proxy-Firewalls"><a href="#7-2-2-Proxy-Firewalls" class="headerlink" title="7.2.2 Proxy Firewalls"></a>7.2.2 Proxy Firewalls</h3><h2 id="7-3-Network-Address-Translation-NAT"><a href="#7-3-Network-Address-Translation-NAT" class="headerlink" title="7.3 Network Address Translation (NAT)"></a>7.3 Network Address Translation (NAT)</h2><h3 id="7-3-1-Traditional-NAT-Basic-NAT-and-NAPT"><a href="#7-3-1-Traditional-NAT-Basic-NAT-and-NAPT" class="headerlink" title="7.3.1 Traditional NAT: Basic NAT and NAPT"></a>7.3.1 Traditional NAT: Basic NAT and NAPT</h3><h3 id="7-3-2-Address-and-Port-Translation-Behavior"><a href="#7-3-2-Address-and-Port-Translation-Behavior" class="headerlink" title="7.3.2 Address and Port Translation Behavior"></a>7.3.2 Address and Port Translation Behavior</h3><h3 id="7-3-3-Filtering-Behavior"><a href="#7-3-3-Filtering-Behavior" class="headerlink" title="7.3.3 Filtering Behavior"></a>7.3.3 Filtering Behavior</h3><h3 id="7-3-4-Servers-behind-NATs"><a href="#7-3-4-Servers-behind-NATs" class="headerlink" title="7.3.4 Servers behind NATs"></a>7.3.4 Servers behind NATs</h3><h3 id="7-3-5-Hairpinning-and-NAT-Loopback"><a href="#7-3-5-Hairpinning-and-NAT-Loopback" class="headerlink" title="7.3.5 Hairpinning and NAT Loopback"></a>7.3.5 Hairpinning and NAT Loopback</h3><h3 id="7-3-6-NAT-Editors"><a href="#7-3-6-NAT-Editors" class="headerlink" title="7.3.6 NAT Editors"></a>7.3.6 NAT Editors</h3><h3 id="7-3-7-Service-Provider-NAT-SPNAT-and-Service-Provider-IPv6-Transition"><a href="#7-3-7-Service-Provider-NAT-SPNAT-and-Service-Provider-IPv6-Transition" class="headerlink" title="7.3.7 Service Provider NAT (SPNAT) and Service Provider IPv6 Transition"></a>7.3.7 Service Provider NAT (SPNAT) and Service Provider IPv6 Transition</h3><h2 id="7-4-NAT-Traversal"><a href="#7-4-NAT-Traversal" class="headerlink" title="7.4 NAT Traversal"></a>7.4 NAT Traversal</h2><h3 id="7-4-1-Pinholes-and-Hole-Punching"><a href="#7-4-1-Pinholes-and-Hole-Punching" class="headerlink" title="7.4.1 Pinholes and Hole Punching"></a>7.4.1 Pinholes and Hole Punching</h3><h3 id="7-4-2-UNilateral-Self-Address-Fixing-UNSAF"><a href="#7-4-2-UNilateral-Self-Address-Fixing-UNSAF" class="headerlink" title="7.4.2 UNilateral Self-Address Fixing (UNSAF)"></a>7.4.2 UNilateral Self-Address Fixing (UNSAF)</h3><h3 id="7-4-3-Session-Traversal-Utilities-for-NAT-STUN"><a href="#7-4-3-Session-Traversal-Utilities-for-NAT-STUN" class="headerlink" title="7.4.3 Session Traversal Utilities for NAT (STUN)"></a>7.4.3 Session Traversal Utilities for NAT (STUN)</h3><h3 id="7-4-4-Traversal-Using-Relays-around-NAT-TURN"><a href="#7-4-4-Traversal-Using-Relays-around-NAT-TURN" class="headerlink" title="7.4.4 Traversal Using Relays around NAT (TURN)"></a>7.4.4 Traversal Using Relays around NAT (TURN)</h3><h3 id="7-4-5-Interactive-Connectivity-Establishment-ICE"><a href="#7-4-5-Interactive-Connectivity-Establishment-ICE" class="headerlink" title="7.4.5 Interactive Connectivity Establishment (ICE)"></a>7.4.5 Interactive Connectivity Establishment (ICE)</h3><h2 id="7-5-Configuring-Packet-Filtering-Firewalls-and-NATs"><a href="#7-5-Configuring-Packet-Filtering-Firewalls-and-NATs" class="headerlink" title="7.5 Configuring Packet-Filtering Firewalls and NATs"></a>7.5 Configuring Packet-Filtering Firewalls and NATs</h2><h3 id="7-5-1-Firewall-Rules"><a href="#7-5-1-Firewall-Rules" class="headerlink" title="7.5.1 Firewall Rules"></a>7.5.1 Firewall Rules</h3><h3 id="7-5-2-NAT-Rules"><a href="#7-5-2-NAT-Rules" class="headerlink" title="7.5.2 NAT Rules"></a>7.5.2 NAT Rules</h3><h3 id="7-5-3-Direct-Interaction-with-NATs-and-Firewalls-UPnP-NAT-PMP-and-PCP"><a href="#7-5-3-Direct-Interaction-with-NATs-and-Firewalls-UPnP-NAT-PMP-and-PCP" class="headerlink" title="7.5.3 Direct Interaction with NATs and Firewalls: UPnP, NAT-PMP, and PCP"></a>7.5.3 Direct Interaction with NATs and Firewalls: UPnP, NAT-PMP, and PCP</h3><h2 id="7-6-NAT-for-IPv4-x2F-IPv6-Coexistence-and-Transition"><a href="#7-6-NAT-for-IPv4-x2F-IPv6-Coexistence-and-Transition" class="headerlink" title="7.6 NAT for IPv4&#x2F;IPv6 Coexistence and Transition"></a>7.6 NAT for IPv4&#x2F;IPv6 Coexistence and Transition</h2><h3 id="7-6-1-Dual-Stack-Lite-DS-Lite"><a href="#7-6-1-Dual-Stack-Lite-DS-Lite" class="headerlink" title="7.6.1 Dual-Stack Lite (DS-Lite)"></a>7.6.1 Dual-Stack Lite (DS-Lite)</h3><h3 id="7-6-2-IPv4-x2F-IPv6-Translation-Using-NATs-and-ALGs"><a href="#7-6-2-IPv4-x2F-IPv6-Translation-Using-NATs-and-ALGs" class="headerlink" title="7.6.2 IPv4&#x2F;IPv6 Translation Using NATs and ALGs"></a>7.6.2 IPv4&#x2F;IPv6 Translation Using NATs and ALGs</h3><h2 id="7-7-Attacks-Involving-Firewalls-and-NATs"><a href="#7-7-Attacks-Involving-Firewalls-and-NATs" class="headerlink" title="7.7 Attacks Involving Firewalls and NATs"></a>7.7 Attacks Involving Firewalls and NATs</h2><h2 id="7-8-Summary"><a href="#7-8-Summary" class="headerlink" title="7.8 Summary"></a>7.8 Summary</h2><h2 id="7-9-References"><a href="#7-9-References" class="headerlink" title="7.9 References"></a>7.9 References</h2><h1 id="Chapter-8-ICMPv4-and-ICMPv6-Internet-Control-Message-Protocol"><a href="#Chapter-8-ICMPv4-and-ICMPv6-Internet-Control-Message-Protocol" class="headerlink" title="Chapter 8 ICMPv4 and ICMPv6: Internet Control Message Protocol"></a>Chapter 8 ICMPv4 and ICMPv6: Internet Control Message Protocol</h1><h2 id="8-1-Introduction"><a href="#8-1-Introduction" class="headerlink" title="8.1 Introduction"></a>8.1 Introduction</h2><h3 id="8-1-1-Encapsulation-in-IPv4-and-IPv6"><a href="#8-1-1-Encapsulation-in-IPv4-and-IPv6" class="headerlink" title="8.1.1 Encapsulation in IPv4 and IPv6"></a>8.1.1 Encapsulation in IPv4 and IPv6</h3><h2 id="8-2-ICMP-Messages"><a href="#8-2-ICMP-Messages" class="headerlink" title="8.2 ICMP Messages"></a>8.2 ICMP Messages</h2><h3 id="8-2-1-ICMPv4-Messages"><a href="#8-2-1-ICMPv4-Messages" class="headerlink" title="8.2.1 ICMPv4 Messages"></a>8.2.1 ICMPv4 Messages</h3><h3 id="8-2-2-ICMPv6-Messages"><a href="#8-2-2-ICMPv6-Messages" class="headerlink" title="8.2.2 ICMPv6 Messages"></a>8.2.2 ICMPv6 Messages</h3><h3 id="8-2-3-Processing-of-ICMP-Messages"><a href="#8-2-3-Processing-of-ICMP-Messages" class="headerlink" title="8.2.3 Processing of ICMP Messages"></a>8.2.3 Processing of ICMP Messages</h3><h2 id="8-3-ICMP-Error-Messages"><a href="#8-3-ICMP-Error-Messages" class="headerlink" title="8.3 ICMP Error Messages"></a>8.3 ICMP Error Messages</h2><h3 id="8-3-1-Extended-ICMP-and-Multipart-Messages"><a href="#8-3-1-Extended-ICMP-and-Multipart-Messages" class="headerlink" title="8.3.1 Extended ICMP and Multipart Messages"></a>8.3.1 Extended ICMP and Multipart Messages</h3><h3 id="8-3-2-Destination-Unreachable-ICMPv4-Type-3-ICMPv6-Type-1-and-Packet-Too-Big-ICMPv6-Type-2"><a href="#8-3-2-Destination-Unreachable-ICMPv4-Type-3-ICMPv6-Type-1-and-Packet-Too-Big-ICMPv6-Type-2" class="headerlink" title="8.3.2 Destination Unreachable (ICMPv4 Type 3, ICMPv6 Type 1) and Packet Too Big (ICMPv6 Type 2)"></a>8.3.2 Destination Unreachable (ICMPv4 Type 3, ICMPv6 Type 1) and Packet Too Big (ICMPv6 Type 2)</h3><h3 id="8-3-3-Redirect-ICMPv4-Type-5-ICMPv6-Type-137"><a href="#8-3-3-Redirect-ICMPv4-Type-5-ICMPv6-Type-137" class="headerlink" title="8.3.3 Redirect (ICMPv4 Type 5, ICMPv6 Type 137)"></a>8.3.3 Redirect (ICMPv4 Type 5, ICMPv6 Type 137)</h3><h3 id="8-3-4-ICMP-Time-Exceeded-ICMPv4-Type-11-ICMPv6-Type-3"><a href="#8-3-4-ICMP-Time-Exceeded-ICMPv4-Type-11-ICMPv6-Type-3" class="headerlink" title="8.3.4 ICMP Time Exceeded (ICMPv4 Type 11, ICMPv6 Type 3)"></a>8.3.4 ICMP Time Exceeded (ICMPv4 Type 11, ICMPv6 Type 3)</h3><h3 id="8-3-5-Parameter-Problem-ICMPv4-Type-12-ICMPv6-Type-4"><a href="#8-3-5-Parameter-Problem-ICMPv4-Type-12-ICMPv6-Type-4" class="headerlink" title="8.3.5 Parameter Problem (ICMPv4 Type 12, ICMPv6 Type 4)"></a>8.3.5 Parameter Problem (ICMPv4 Type 12, ICMPv6 Type 4)</h3><h2 id="8-4-ICMP-Query-x2F-Informational-Messages"><a href="#8-4-ICMP-Query-x2F-Informational-Messages" class="headerlink" title="8.4 ICMP Query&#x2F;Informational Messages"></a>8.4 ICMP Query&#x2F;Informational Messages</h2><h3 id="8-4-1-Echo-Request-x2F-Reply-ping-ICMPv4-Types-0-x2F-8-ICMPv6-Types-129-x2F-128"><a href="#8-4-1-Echo-Request-x2F-Reply-ping-ICMPv4-Types-0-x2F-8-ICMPv6-Types-129-x2F-128" class="headerlink" title="8.4.1 Echo Request&#x2F;Reply (ping) (ICMPv4 Types 0&#x2F;8, ICMPv6 Types 129&#x2F;128)"></a>8.4.1 Echo Request&#x2F;Reply (ping) (ICMPv4 Types 0&#x2F;8, ICMPv6 Types 129&#x2F;128)</h3><h3 id="8-4-2-Router-Discovery-Router-Solicitation-and-Advertisement-ICMPv4-Types-9-10"><a href="#8-4-2-Router-Discovery-Router-Solicitation-and-Advertisement-ICMPv4-Types-9-10" class="headerlink" title="8.4.2 Router Discovery: Router Solicitation and Advertisement (ICMPv4 Types 9, 10)"></a>8.4.2 Router Discovery: Router Solicitation and Advertisement (ICMPv4 Types 9, 10)</h3><h3 id="8-4-3-Home-Agent-Address-Discovery-Request-x2F-Reply-ICMPv6-Types-144-x2F-145"><a href="#8-4-3-Home-Agent-Address-Discovery-Request-x2F-Reply-ICMPv6-Types-144-x2F-145" class="headerlink" title="8.4.3 Home Agent Address Discovery Request&#x2F;Reply (ICMPv6 Types 144&#x2F;145)"></a>8.4.3 Home Agent Address Discovery Request&#x2F;Reply (ICMPv6 Types 144&#x2F;145)</h3><h3 id="8-4-4-Mobile-Prefix-Solicitation-x2F-Advertisement-ICMPv6-Types-146-x2F-147"><a href="#8-4-4-Mobile-Prefix-Solicitation-x2F-Advertisement-ICMPv6-Types-146-x2F-147" class="headerlink" title="8.4.4 Mobile Prefix Solicitation&#x2F;Advertisement (ICMPv6 Types 146&#x2F;147)"></a>8.4.4 Mobile Prefix Solicitation&#x2F;Advertisement (ICMPv6 Types 146&#x2F;147)</h3><h3 id="8-4-5-Mobile-IPv6-Fast-Handover-Messages-ICMPv6-Type-154"><a href="#8-4-5-Mobile-IPv6-Fast-Handover-Messages-ICMPv6-Type-154" class="headerlink" title="8.4.5 Mobile IPv6 Fast Handover Messages (ICMPv6 Type 154)"></a>8.4.5 Mobile IPv6 Fast Handover Messages (ICMPv6 Type 154)</h3><h3 id="8-4-6-Multicast-Listener-Query-x2F-Report-x2F-Done-ICMPv6-Types-130-x2F-131-x2F-132"><a href="#8-4-6-Multicast-Listener-Query-x2F-Report-x2F-Done-ICMPv6-Types-130-x2F-131-x2F-132" class="headerlink" title="8.4.6 Multicast Listener Query&#x2F;Report&#x2F;Done (ICMPv6 Types 130&#x2F;131&#x2F;132)"></a>8.4.6 Multicast Listener Query&#x2F;Report&#x2F;Done (ICMPv6 Types 130&#x2F;131&#x2F;132)</h3><h3 id="8-4-7-Version-2-Multicast-Listener-Discovery-MLDv2-ICMPv6-Type-143"><a href="#8-4-7-Version-2-Multicast-Listener-Discovery-MLDv2-ICMPv6-Type-143" class="headerlink" title="8.4.7 Version 2 Multicast Listener Discovery (MLDv2) (ICMPv6 Type 143)"></a>8.4.7 Version 2 Multicast Listener Discovery (MLDv2) (ICMPv6 Type 143)</h3><h3 id="8-4-8-Multicast-Router-Discovery-MRD-IGMP-Types-48-x2F-49-x2F-50-ICMPv6-Types-151-x2F-152-x2F-153"><a href="#8-4-8-Multicast-Router-Discovery-MRD-IGMP-Types-48-x2F-49-x2F-50-ICMPv6-Types-151-x2F-152-x2F-153" class="headerlink" title="8.4.8 Multicast Router Discovery (MRD) (IGMP Types 48&#x2F;49&#x2F;50, ICMPv6 Types 151&#x2F;152&#x2F;153)"></a>8.4.8 Multicast Router Discovery (MRD) (IGMP Types 48&#x2F;49&#x2F;50, ICMPv6 Types 151&#x2F;152&#x2F;153)</h3><h2 id="8-5-Neighbor-Discovery-in-IPv6"><a href="#8-5-Neighbor-Discovery-in-IPv6" class="headerlink" title="8.5 Neighbor Discovery in IPv6"></a>8.5 Neighbor Discovery in IPv6</h2><h3 id="8-5-1-ICMPv6-Router-Solicitation-and-Advertisement-ICMPv6-Types-133-134"><a href="#8-5-1-ICMPv6-Router-Solicitation-and-Advertisement-ICMPv6-Types-133-134" class="headerlink" title="8.5.1 ICMPv6 Router Solicitation and Advertisement (ICMPv6 Types 133, 134)"></a>8.5.1 ICMPv6 Router Solicitation and Advertisement (ICMPv6 Types 133, 134)</h3><h3 id="8-5-2-ICMPv6-Neighbor-Solicitation-and-Advertisement-IMCPv6-Types-135-136"><a href="#8-5-2-ICMPv6-Neighbor-Solicitation-and-Advertisement-IMCPv6-Types-135-136" class="headerlink" title="8.5.2 ICMPv6 Neighbor Solicitation and Advertisement (IMCPv6 Types 135, 136)"></a>8.5.2 ICMPv6 Neighbor Solicitation and Advertisement (IMCPv6 Types 135, 136)</h3><h3 id="8-5-3-ICMPv6-Inverse-Neighbor-Discovery-Solicitation-x2F-Advertisement-ICMPv6-Types-141-x2F-142"><a href="#8-5-3-ICMPv6-Inverse-Neighbor-Discovery-Solicitation-x2F-Advertisement-ICMPv6-Types-141-x2F-142" class="headerlink" title="8.5.3 ICMPv6 Inverse Neighbor Discovery Solicitation&#x2F;Advertisement (ICMPv6 Types 141&#x2F;142)"></a>8.5.3 ICMPv6 Inverse Neighbor Discovery Solicitation&#x2F;Advertisement (ICMPv6 Types 141&#x2F;142)</h3><h3 id="8-5-4-Neighbor-Unreachability-Detection-NUD"><a href="#8-5-4-Neighbor-Unreachability-Detection-NUD" class="headerlink" title="8.5.4 Neighbor Unreachability Detection (NUD)"></a>8.5.4 Neighbor Unreachability Detection (NUD)</h3><h3 id="8-5-5-Secure-Neighbor-Discovery-SEND"><a href="#8-5-5-Secure-Neighbor-Discovery-SEND" class="headerlink" title="8.5.5 Secure Neighbor Discovery (SEND)"></a>8.5.5 Secure Neighbor Discovery (SEND)</h3><h3 id="8-5-6-ICMPv6-Neighbor-Discovery-ND-Options"><a href="#8-5-6-ICMPv6-Neighbor-Discovery-ND-Options" class="headerlink" title="8.5.6 ICMPv6 Neighbor Discovery (ND) Options"></a>8.5.6 ICMPv6 Neighbor Discovery (ND) Options</h3><h2 id="8-6-Translating-ICMPv4-and-ICMPv6"><a href="#8-6-Translating-ICMPv4-and-ICMPv6" class="headerlink" title="8.6 Translating ICMPv4 and ICMPv6"></a>8.6 Translating ICMPv4 and ICMPv6</h2><h3 id="8-6-1-Translating-ICMPv4-to-ICMPv6"><a href="#8-6-1-Translating-ICMPv4-to-ICMPv6" class="headerlink" title="8.6.1 Translating ICMPv4 to ICMPv6"></a>8.6.1 Translating ICMPv4 to ICMPv6</h3><h3 id="8-6-2-Translating-ICMPv6-to-ICMPv4"><a href="#8-6-2-Translating-ICMPv6-to-ICMPv4" class="headerlink" title="8.6.2 Translating ICMPv6 to ICMPv4"></a>8.6.2 Translating ICMPv6 to ICMPv4</h3><h2 id="8-7-Attacks-Involving-ICMP"><a href="#8-7-Attacks-Involving-ICMP" class="headerlink" title="8.7 Attacks Involving ICMP"></a>8.7 Attacks Involving ICMP</h2><h2 id="8-8-Summary"><a href="#8-8-Summary" class="headerlink" title="8.8 Summary"></a>8.8 Summary</h2><h2 id="8-9-References"><a href="#8-9-References" class="headerlink" title="8.9 References"></a>8.9 References</h2><h1 id="Chapter-9-Broadcasting-and-Local-Multicasting-IGMP-and-MLD"><a href="#Chapter-9-Broadcasting-and-Local-Multicasting-IGMP-and-MLD" class="headerlink" title="Chapter 9 Broadcasting and Local Multicasting (IGMP and MLD)"></a>Chapter 9 Broadcasting and Local Multicasting (IGMP and MLD)</h1><h2 id="9-1-Introduction"><a href="#9-1-Introduction" class="headerlink" title="9.1 Introduction"></a>9.1 Introduction</h2><h2 id="9-2-Broadcasting"><a href="#9-2-Broadcasting" class="headerlink" title="9.2 Broadcasting"></a>9.2 Broadcasting</h2><h3 id="9-2-1-Using-Broadcast-Addresses"><a href="#9-2-1-Using-Broadcast-Addresses" class="headerlink" title="9.2.1 Using Broadcast Addresses"></a>9.2.1 Using Broadcast Addresses</h3><h3 id="9-2-2-Sending-Broadcast-Datagrams"><a href="#9-2-2-Sending-Broadcast-Datagrams" class="headerlink" title="9.2.2 Sending Broadcast Datagrams"></a>9.2.2 Sending Broadcast Datagrams</h3><h2 id="9-3-Multicasting"><a href="#9-3-Multicasting" class="headerlink" title="9.3 Multicasting"></a>9.3 Multicasting</h2><h3 id="9-3-1-Converting-IP-Multicast-Addresses-to-802-MAC-x2F-Ethernet-Addresses"><a href="#9-3-1-Converting-IP-Multicast-Addresses-to-802-MAC-x2F-Ethernet-Addresses" class="headerlink" title="9.3.1 Converting IP Multicast Addresses to 802 MAC&#x2F;Ethernet Addresses"></a>9.3.1 Converting IP Multicast Addresses to 802 MAC&#x2F;Ethernet Addresses</h3><h3 id="9-3-2-Examples"><a href="#9-3-2-Examples" class="headerlink" title="9.3.2 Examples"></a>9.3.2 Examples</h3><h3 id="9-3-3-Sending-Multicast-Datagrams"><a href="#9-3-3-Sending-Multicast-Datagrams" class="headerlink" title="9.3.3 Sending Multicast Datagrams"></a>9.3.3 Sending Multicast Datagrams</h3><h3 id="9-3-4-Receiving-Multicast-Datagrams"><a href="#9-3-4-Receiving-Multicast-Datagrams" class="headerlink" title="9.3.4 Receiving Multicast Datagrams"></a>9.3.4 Receiving Multicast Datagrams</h3><h3 id="9-3-5-Host-Address-Filtering"><a href="#9-3-5-Host-Address-Filtering" class="headerlink" title="9.3.5 Host Address Filtering"></a>9.3.5 Host Address Filtering</h3><h2 id="9-4-The-Internet-Group-Management-Protocol-IGMP-and-Multicast-Listener-Discovery-Protocol-MLD"><a href="#9-4-The-Internet-Group-Management-Protocol-IGMP-and-Multicast-Listener-Discovery-Protocol-MLD" class="headerlink" title="9.4 The Internet Group Management Protocol (IGMP) and Multicast Listener Discovery Protocol (MLD)"></a>9.4 The Internet Group Management Protocol (IGMP) and Multicast Listener Discovery Protocol (MLD)</h2><h3 id="9-4-1-IGMP-and-MLD-Processing-by-Group-Members-“Group-Member-Part”"><a href="#9-4-1-IGMP-and-MLD-Processing-by-Group-Members-“Group-Member-Part”" class="headerlink" title="9.4.1 IGMP and MLD Processing by Group Members (“Group Member Part”)"></a>9.4.1 IGMP and MLD Processing by Group Members (“Group Member Part”)</h3><h3 id="9-4-2-IGMP-and-MLD-Processing-by-Multicast-Routers-“Multicast-Router-Part”"><a href="#9-4-2-IGMP-and-MLD-Processing-by-Multicast-Routers-“Multicast-Router-Part”" class="headerlink" title="9.4.2 IGMP and MLD Processing by Multicast Routers (“Multicast Router Part”)"></a>9.4.2 IGMP and MLD Processing by Multicast Routers (“Multicast Router Part”)</h3><h3 id="9-4-3-Examples"><a href="#9-4-3-Examples" class="headerlink" title="9.4.3 Examples"></a>9.4.3 Examples</h3><h3 id="9-4-4-Lightweight-IGMPv3-and-MLDv2"><a href="#9-4-4-Lightweight-IGMPv3-and-MLDv2" class="headerlink" title="9.4.4 Lightweight IGMPv3 and MLDv2"></a>9.4.4 Lightweight IGMPv3 and MLDv2</h3><h3 id="9-4-5-IGMP-and-MLD-Robustness"><a href="#9-4-5-IGMP-and-MLD-Robustness" class="headerlink" title="9.4.5 IGMP and MLD Robustness"></a>9.4.5 IGMP and MLD Robustness</h3><h3 id="9-4-6-IGMP-and-MLD-Counters-and-Variables"><a href="#9-4-6-IGMP-and-MLD-Counters-and-Variables" class="headerlink" title="9.4.6 IGMP and MLD Counters and Variables"></a>9.4.6 IGMP and MLD Counters and Variables</h3><h3 id="9-4-7-IGMP-and-MLD-Snooping"><a href="#9-4-7-IGMP-and-MLD-Snooping" class="headerlink" title="9.4.7 IGMP and MLD Snooping"></a>9.4.7 IGMP and MLD Snooping</h3><h2 id="9-5-Attacks-Involving-IGMP-and-MLD"><a href="#9-5-Attacks-Involving-IGMP-and-MLD" class="headerlink" title="9.5 Attacks Involving IGMP and MLD"></a>9.5 Attacks Involving IGMP and MLD</h2><h2 id="9-6-Summary"><a href="#9-6-Summary" class="headerlink" title="9.6 Summary"></a>9.6 Summary</h2><h2 id="9-7-References"><a href="#9-7-References" class="headerlink" title="9.7 References"></a>9.7 References</h2><h1 id="Chapter-10-User-Datagram-Protocol-UDP-and-IP-Fragmentation"><a href="#Chapter-10-User-Datagram-Protocol-UDP-and-IP-Fragmentation" class="headerlink" title="Chapter 10 User Datagram Protocol (UDP) and IP Fragmentation"></a>Chapter 10 User Datagram Protocol (UDP) and IP Fragmentation</h1><h2 id="10-1-Introduction"><a href="#10-1-Introduction" class="headerlink" title="10.1 Introduction"></a>10.1 Introduction</h2><h2 id="10-2-UDP-Header"><a href="#10-2-UDP-Header" class="headerlink" title="10.2 UDP Header"></a>10.2 UDP Header</h2><h2 id="10-3-UDP-Checksum"><a href="#10-3-UDP-Checksum" class="headerlink" title="10.3 UDP Checksum"></a>10.3 UDP Checksum</h2><h2 id="10-4-Examples"><a href="#10-4-Examples" class="headerlink" title="10.4 Examples"></a>10.4 Examples</h2><h2 id="10-5-UDP-and-IPv6"><a href="#10-5-UDP-and-IPv6" class="headerlink" title="10.5 UDP and IPv6"></a>10.5 UDP and IPv6</h2><h3 id="10-5-1-Teredo-Tunneling-IPv6-through-IPv4-Networks"><a href="#10-5-1-Teredo-Tunneling-IPv6-through-IPv4-Networks" class="headerlink" title="10.5.1 Teredo: Tunneling IPv6 through IPv4 Networks"></a>10.5.1 Teredo: Tunneling IPv6 through IPv4 Networks</h3><h2 id="10-6-UDP-Lite"><a href="#10-6-UDP-Lite" class="headerlink" title="10.6 UDP-Lite"></a>10.6 UDP-Lite</h2><h2 id="10-7-IP-Fragmentation"><a href="#10-7-IP-Fragmentation" class="headerlink" title="10.7 IP Fragmentation"></a>10.7 IP Fragmentation</h2><h3 id="10-7-1-Example-UDP-x2F-IPv4-Fragmentation"><a href="#10-7-1-Example-UDP-x2F-IPv4-Fragmentation" class="headerlink" title="10.7.1 Example: UDP&#x2F;IPv4 Fragmentation"></a>10.7.1 Example: UDP&#x2F;IPv4 Fragmentation</h3><h3 id="10-7-2-Reassembly-Timeout"><a href="#10-7-2-Reassembly-Timeout" class="headerlink" title="10.7.2 Reassembly Timeout"></a>10.7.2 Reassembly Timeout</h3><h2 id="10-8-Path-MTU-Discovery-with-UDP"><a href="#10-8-Path-MTU-Discovery-with-UDP" class="headerlink" title="10.8 Path MTU Discovery with UDP"></a>10.8 Path MTU Discovery with UDP</h2><h3 id="10-8-1-Example"><a href="#10-8-1-Example" class="headerlink" title="10.8.1 Example"></a>10.8.1 Example</h3><h2 id="10-9-Interaction-between-IP-Fragmentation-and-ARP-x2F-ND"><a href="#10-9-Interaction-between-IP-Fragmentation-and-ARP-x2F-ND" class="headerlink" title="10.9 Interaction between IP Fragmentation and ARP&#x2F;ND"></a>10.9 Interaction between IP Fragmentation and ARP&#x2F;ND</h2><h2 id="10-10-Maximum-UDP-Datagram-Size"><a href="#10-10-Maximum-UDP-Datagram-Size" class="headerlink" title="10.10 Maximum UDP Datagram Size"></a>10.10 Maximum UDP Datagram Size</h2><h3 id="10-10-1-Implementation-Limitations"><a href="#10-10-1-Implementation-Limitations" class="headerlink" title="10.10.1 Implementation Limitations"></a>10.10.1 Implementation Limitations</h3><h3 id="10-10-2-Datagram-Truncation"><a href="#10-10-2-Datagram-Truncation" class="headerlink" title="10.10.2 Datagram Truncation"></a>10.10.2 Datagram Truncation</h3><h2 id="10-11-UDP-Server-Design"><a href="#10-11-UDP-Server-Design" class="headerlink" title="10.11 UDP Server Design"></a>10.11 UDP Server Design</h2><h3 id="10-11-1-IP-Addresses-and-UDP-Port-Numbers"><a href="#10-11-1-IP-Addresses-and-UDP-Port-Numbers" class="headerlink" title="10.11.1 IP Addresses and UDP Port Numbers"></a>10.11.1 IP Addresses and UDP Port Numbers</h3><h3 id="10-11-2-Restricting-Local-IP-Addresses"><a href="#10-11-2-Restricting-Local-IP-Addresses" class="headerlink" title="10.11.2 Restricting Local IP Addresses"></a>10.11.2 Restricting Local IP Addresses</h3><h3 id="10-11-3-Using-Multiple-Addresses"><a href="#10-11-3-Using-Multiple-Addresses" class="headerlink" title="10.11.3 Using Multiple Addresses"></a>10.11.3 Using Multiple Addresses</h3><h3 id="10-11-4-Restricting-Foreign-IP-Address"><a href="#10-11-4-Restricting-Foreign-IP-Address" class="headerlink" title="10.11.4 Restricting Foreign IP Address"></a>10.11.4 Restricting Foreign IP Address</h3><h3 id="10-11-5-Using-Multiple-Servers-per-Port"><a href="#10-11-5-Using-Multiple-Servers-per-Port" class="headerlink" title="10.11.5 Using Multiple Servers per Port"></a>10.11.5 Using Multiple Servers per Port</h3><h3 id="10-11-6-Spanning-Address-Families-IPv4-and-IPv6"><a href="#10-11-6-Spanning-Address-Families-IPv4-and-IPv6" class="headerlink" title="10.11.6 Spanning Address Families: IPv4 and IPv6"></a>10.11.6 Spanning Address Families: IPv4 and IPv6</h3><h3 id="10-11-7-Lack-of-Flow-and-Congestion-Control"><a href="#10-11-7-Lack-of-Flow-and-Congestion-Control" class="headerlink" title="10.11.7 Lack of Flow and Congestion Control"></a>10.11.7 Lack of Flow and Congestion Control</h3><h2 id="10-12-Translating-UDP-x2F-IPv4-and-UDP-x2F-IPv6-Datagrams"><a href="#10-12-Translating-UDP-x2F-IPv4-and-UDP-x2F-IPv6-Datagrams" class="headerlink" title="10.12 Translating UDP&#x2F;IPv4 and UDP&#x2F;IPv6 Datagrams"></a>10.12 Translating UDP&#x2F;IPv4 and UDP&#x2F;IPv6 Datagrams</h2><h2 id="10-13-UDP-in-the-Internet"><a href="#10-13-UDP-in-the-Internet" class="headerlink" title="10.13 UDP in the Internet"></a>10.13 UDP in the Internet</h2><h2 id="10-14-Attacks-Involving-UDP-and-IP-Fragmentation"><a href="#10-14-Attacks-Involving-UDP-and-IP-Fragmentation" class="headerlink" title="10.14 Attacks Involving UDP and IP Fragmentation"></a>10.14 Attacks Involving UDP and IP Fragmentation</h2><h2 id="10-15-Summary"><a href="#10-15-Summary" class="headerlink" title="10.15 Summary"></a>10.15 Summary</h2><h2 id="10-16-References"><a href="#10-16-References" class="headerlink" title="10.16 References"></a>10.16 References</h2><h1 id="Chapter-11-Name-Resolution-and-the-Domain-Name-System-DNS"><a href="#Chapter-11-Name-Resolution-and-the-Domain-Name-System-DNS" class="headerlink" title="Chapter 11 Name Resolution and the Domain Name System (DNS)"></a>Chapter 11 Name Resolution and the Domain Name System (DNS)</h1><h2 id="11-1-Introduction"><a href="#11-1-Introduction" class="headerlink" title="11.1 Introduction"></a>11.1 Introduction</h2><h2 id="11-2-The-DNS-Name-Space"><a href="#11-2-The-DNS-Name-Space" class="headerlink" title="11.2 The DNS Name Space"></a>11.2 The DNS Name Space</h2><h3 id="11-2-1-DNS-Naming-Syntax"><a href="#11-2-1-DNS-Naming-Syntax" class="headerlink" title="11.2.1 DNS Naming Syntax"></a>11.2.1 DNS Naming Syntax</h3><h2 id="11-3-Name-Servers-and-Zones"><a href="#11-3-Name-Servers-and-Zones" class="headerlink" title="11.3 Name Servers and Zones"></a>11.3 Name Servers and Zones</h2><h2 id="11-4-Caching"><a href="#11-4-Caching" class="headerlink" title="11.4 Caching"></a>11.4 Caching</h2><h2 id="11-5-The-DNS-Protocol"><a href="#11-5-The-DNS-Protocol" class="headerlink" title="11.5 The DNS Protocol"></a>11.5 The DNS Protocol</h2><h3 id="11-5-1-DNS-Message-Format"><a href="#11-5-1-DNS-Message-Format" class="headerlink" title="11.5.1 DNS Message Format"></a>11.5.1 DNS Message Format</h3><h3 id="11-5-2-The-DNS-Extension-Format-EDNS0"><a href="#11-5-2-The-DNS-Extension-Format-EDNS0" class="headerlink" title="11.5.2 The DNS Extension Format (EDNS0)"></a>11.5.2 The DNS Extension Format (EDNS0)</h3><h3 id="11-5-3-UDP-or-TCP"><a href="#11-5-3-UDP-or-TCP" class="headerlink" title="11.5.3 UDP or TCP"></a>11.5.3 UDP or TCP</h3><h3 id="11-5-4-Question-Query-and-Zone-Section-Format"><a href="#11-5-4-Question-Query-and-Zone-Section-Format" class="headerlink" title="11.5.4 Question (Query) and Zone Section Format"></a>11.5.4 Question (Query) and Zone Section Format</h3><h3 id="11-5-5-Answer-Authority-and-Additional-Information-Section-Formats"><a href="#11-5-5-Answer-Authority-and-Additional-Information-Section-Formats" class="headerlink" title="11.5.5 Answer, Authority, and Additional Information Section Formats"></a>11.5.5 Answer, Authority, and Additional Information Section Formats</h3><h3 id="11-5-6-Resource-Record-Types"><a href="#11-5-6-Resource-Record-Types" class="headerlink" title="11.5.6 Resource Record Types"></a>11.5.6 Resource Record Types</h3><h3 id="11-5-7-Dynamic-Updates-DNS-UPDATE"><a href="#11-5-7-Dynamic-Updates-DNS-UPDATE" class="headerlink" title="11.5.7 Dynamic Updates (DNS UPDATE)"></a>11.5.7 Dynamic Updates (DNS UPDATE)</h3><h3 id="11-5-8-Zone-Transfers-and-DNS-NOTIFY"><a href="#11-5-8-Zone-Transfers-and-DNS-NOTIFY" class="headerlink" title="11.5.8 Zone Transfers and DNS NOTIFY"></a>11.5.8 Zone Transfers and DNS NOTIFY</h3><h2 id="11-6-Sort-Lists-Round-Robin-and-Split-DNS"><a href="#11-6-Sort-Lists-Round-Robin-and-Split-DNS" class="headerlink" title="11.6 Sort Lists, Round-Robin, and Split DNS"></a>11.6 Sort Lists, Round-Robin, and Split DNS</h2><h2 id="11-7-Open-DNS-Servers-and-DynDNS"><a href="#11-7-Open-DNS-Servers-and-DynDNS" class="headerlink" title="11.7 Open DNS Servers and DynDNS"></a>11.7 Open DNS Servers and DynDNS</h2><h2 id="11-8-Transparency-and-Extensibility"><a href="#11-8-Transparency-and-Extensibility" class="headerlink" title="11.8 Transparency and Extensibility"></a>11.8 Transparency and Extensibility</h2><h2 id="11-9-Translating-DNS-from-IPv4-to-IPv6-DNS64"><a href="#11-9-Translating-DNS-from-IPv4-to-IPv6-DNS64" class="headerlink" title="11.9 Translating DNS from IPv4 to IPv6 (DNS64)"></a>11.9 Translating DNS from IPv4 to IPv6 (DNS64)</h2><h2 id="11-10-LLMNR-and-mDNS"><a href="#11-10-LLMNR-and-mDNS" class="headerlink" title="11.10 LLMNR and mDNS"></a>11.10 LLMNR and mDNS</h2><h2 id="11-11-LDAP"><a href="#11-11-LDAP" class="headerlink" title="11.11 LDAP"></a>11.11 LDAP</h2><h2 id="11-12-Attacks-on-the-DNS"><a href="#11-12-Attacks-on-the-DNS" class="headerlink" title="11.12 Attacks on the DNS"></a>11.12 Attacks on the DNS</h2><h2 id="11-13-Summary"><a href="#11-13-Summary" class="headerlink" title="11.13 Summary"></a>11.13 Summary</h2><h2 id="11-14-References"><a href="#11-14-References" class="headerlink" title="11.14 References"></a>11.14 References</h2><h1 id="Chapter-12-TCP-The-Transmission-Control-Protocol-Preliminaries"><a href="#Chapter-12-TCP-The-Transmission-Control-Protocol-Preliminaries" class="headerlink" title="Chapter 12 TCP: The Transmission Control Protocol (Preliminaries)"></a>Chapter 12 TCP: The Transmission Control Protocol (Preliminaries)</h1><h2 id="12-1-Introduction"><a href="#12-1-Introduction" class="headerlink" title="12.1 Introduction"></a>12.1 Introduction</h2><h3 id="12-1-1-ARQ-and-Retransmission"><a href="#12-1-1-ARQ-and-Retransmission" class="headerlink" title="12.1.1 ARQ and Retransmission"></a>12.1.1 ARQ and Retransmission</h3><h3 id="12-1-2-Windows-of-Packets-and-Sliding-Windows"><a href="#12-1-2-Windows-of-Packets-and-Sliding-Windows" class="headerlink" title="12.1.2 Windows of Packets and Sliding Windows"></a>12.1.2 Windows of Packets and Sliding Windows</h3><h3 id="12-1-3-Variable-Windows-Flow-Control-and-Congestion-Control"><a href="#12-1-3-Variable-Windows-Flow-Control-and-Congestion-Control" class="headerlink" title="12.1.3 Variable Windows: Flow Control and Congestion Control"></a>12.1.3 Variable Windows: Flow Control and Congestion Control</h3><h3 id="12-1-4-Setting-the-Retransmission-Timeout"><a href="#12-1-4-Setting-the-Retransmission-Timeout" class="headerlink" title="12.1.4 Setting the Retransmission Timeout"></a>12.1.4 Setting the Retransmission Timeout</h3><h2 id="12-2-Introduction-to-TCP"><a href="#12-2-Introduction-to-TCP" class="headerlink" title="12.2 Introduction to TCP"></a>12.2 Introduction to TCP</h2><h3 id="12-2-1-The-TCP-Service-Model"><a href="#12-2-1-The-TCP-Service-Model" class="headerlink" title="12.2.1 The TCP Service Model"></a>12.2.1 The TCP Service Model</h3><h3 id="12-2-2-Reliability-in-TCP"><a href="#12-2-2-Reliability-in-TCP" class="headerlink" title="12.2.2 Reliability in TCP"></a>12.2.2 Reliability in TCP</h3><h2 id="12-3-TCP-Header-and-Encapsulation"><a href="#12-3-TCP-Header-and-Encapsulation" class="headerlink" title="12.3 TCP Header and Encapsulation"></a>12.3 TCP Header and Encapsulation</h2><h2 id="12-4-Summary"><a href="#12-4-Summary" class="headerlink" title="12.4 Summary"></a>12.4 Summary</h2><h2 id="12-5-References"><a href="#12-5-References" class="headerlink" title="12.5 References"></a>12.5 References</h2><h1 id="Chapter-13-TCP-Connection-Management"><a href="#Chapter-13-TCP-Connection-Management" class="headerlink" title="Chapter 13 TCP Connection Management"></a>Chapter 13 TCP Connection Management</h1><h2 id="13-1-Introduction"><a href="#13-1-Introduction" class="headerlink" title="13.1 Introduction"></a>13.1 Introduction</h2><h2 id="13-2-TCP-Connection-Establishment-and-Termination"><a href="#13-2-TCP-Connection-Establishment-and-Termination" class="headerlink" title="13.2 TCP Connection Establishment and Termination"></a>13.2 TCP Connection Establishment and Termination</h2><h3 id="13-2-1-TCP-Half-Close"><a href="#13-2-1-TCP-Half-Close" class="headerlink" title="13.2.1 TCP Half-Close"></a>13.2.1 TCP Half-Close</h3><h3 id="13-2-2-Simultaneous-Open-and-Close"><a href="#13-2-2-Simultaneous-Open-and-Close" class="headerlink" title="13.2.2 Simultaneous Open and Close"></a>13.2.2 Simultaneous Open and Close</h3><h3 id="13-2-3-Initial-Sequence-Number-ISN"><a href="#13-2-3-Initial-Sequence-Number-ISN" class="headerlink" title="13.2.3 Initial Sequence Number (ISN)"></a>13.2.3 Initial Sequence Number (ISN)</h3><h3 id="13-2-4-Example"><a href="#13-2-4-Example" class="headerlink" title="13.2.4 Example"></a>13.2.4 Example</h3><h3 id="13-2-5-Timeout-of-Connection-Establishment"><a href="#13-2-5-Timeout-of-Connection-Establishment" class="headerlink" title="13.2.5 Timeout of Connection Establishment"></a>13.2.5 Timeout of Connection Establishment</h3><h3 id="13-2-6-Connections-and-Translators"><a href="#13-2-6-Connections-and-Translators" class="headerlink" title="13.2.6 Connections and Translators"></a>13.2.6 Connections and Translators</h3><h2 id="13-3-TCP-Options"><a href="#13-3-TCP-Options" class="headerlink" title="13.3 TCP Options"></a>13.3 TCP Options</h2><h3 id="13-3-1-Maximum-Segment-Size-MSS-Option"><a href="#13-3-1-Maximum-Segment-Size-MSS-Option" class="headerlink" title="13.3.1 Maximum Segment Size (MSS) Option"></a>13.3.1 Maximum Segment Size (MSS) Option</h3><h3 id="13-3-2-Selective-Acknowledgment-SACK-Options"><a href="#13-3-2-Selective-Acknowledgment-SACK-Options" class="headerlink" title="13.3.2 Selective Acknowledgment (SACK) Options"></a>13.3.2 Selective Acknowledgment (SACK) Options</h3><h3 id="13-3-3-Window-Scale-WSCALE-or-WSOPT-Option"><a href="#13-3-3-Window-Scale-WSCALE-or-WSOPT-Option" class="headerlink" title="13.3.3 Window Scale (WSCALE or WSOPT) Option"></a>13.3.3 Window Scale (WSCALE or WSOPT) Option</h3><h3 id="13-3-4-Timestamps-Option-and-Protection-against-Wrapped-Sequence-Numbers-PAWS"><a href="#13-3-4-Timestamps-Option-and-Protection-against-Wrapped-Sequence-Numbers-PAWS" class="headerlink" title="13.3.4 Timestamps Option and Protection against Wrapped Sequence Numbers (PAWS)"></a>13.3.4 Timestamps Option and Protection against Wrapped Sequence Numbers (PAWS)</h3><h3 id="13-3-5-User-Timeout-UTO-Option"><a href="#13-3-5-User-Timeout-UTO-Option" class="headerlink" title="13.3.5 User Timeout (UTO) Option"></a>13.3.5 User Timeout (UTO) Option</h3><h3 id="13-3-6-Authentication-Option-TCP-AO"><a href="#13-3-6-Authentication-Option-TCP-AO" class="headerlink" title="13.3.6 Authentication Option (TCP-AO)"></a>13.3.6 Authentication Option (TCP-AO)</h3><h2 id="13-4-Path-MTU-Discovery-with-TCP"><a href="#13-4-Path-MTU-Discovery-with-TCP" class="headerlink" title="13.4 Path MTU Discovery with TCP"></a>13.4 Path MTU Discovery with TCP</h2><h3 id="13-4-1-Example"><a href="#13-4-1-Example" class="headerlink" title="13.4.1 Example"></a>13.4.1 Example</h3><h2 id="13-5-TCP-State-Transitions"><a href="#13-5-TCP-State-Transitions" class="headerlink" title="13.5 TCP State Transitions"></a>13.5 TCP State Transitions</h2><h3 id="13-5-1-TCP-State-Transition-Diagram"><a href="#13-5-1-TCP-State-Transition-Diagram" class="headerlink" title="13.5.1 TCP State Transition Diagram"></a>13.5.1 TCP State Transition Diagram</h3><h3 id="13-5-2-TIME-WAIT-2MSL-Wait-State"><a href="#13-5-2-TIME-WAIT-2MSL-Wait-State" class="headerlink" title="13.5.2 TIME_WAIT (2MSL Wait) State"></a>13.5.2 TIME_WAIT (2MSL Wait) State</h3><h3 id="13-5-3-Quiet-Time-Concept"><a href="#13-5-3-Quiet-Time-Concept" class="headerlink" title="13.5.3 Quiet Time Concept"></a>13.5.3 Quiet Time Concept</h3><h3 id="13-5-4-FIN-WAIT-2-State"><a href="#13-5-4-FIN-WAIT-2-State" class="headerlink" title="13.5.4 FIN_WAIT_2 State"></a>13.5.4 FIN_WAIT_2 State</h3><h3 id="13-5-5-Simultaneous-Open-and-Close-Transitions"><a href="#13-5-5-Simultaneous-Open-and-Close-Transitions" class="headerlink" title="13.5.5 Simultaneous Open and Close Transitions"></a>13.5.5 Simultaneous Open and Close Transitions</h3><h2 id="13-6-Reset-Segments"><a href="#13-6-Reset-Segments" class="headerlink" title="13.6 Reset Segments"></a>13.6 Reset Segments</h2><h3 id="13-6-1-Connection-Request-to-Nonexistent-Port"><a href="#13-6-1-Connection-Request-to-Nonexistent-Port" class="headerlink" title="13.6.1 Connection Request to Nonexistent Port"></a>13.6.1 Connection Request to Nonexistent Port</h3><h3 id="13-6-2-Aborting-a-Connection"><a href="#13-6-2-Aborting-a-Connection" class="headerlink" title="13.6.2 Aborting a Connection"></a>13.6.2 Aborting a Connection</h3><h3 id="13-6-3-Half-Open-Connections"><a href="#13-6-3-Half-Open-Connections" class="headerlink" title="13.6.3 Half-Open Connections"></a>13.6.3 Half-Open Connections</h3><h3 id="13-6-4-TIME-WAIT-Assassination-TWA"><a href="#13-6-4-TIME-WAIT-Assassination-TWA" class="headerlink" title="13.6.4 TIME-WAIT Assassination (TWA)"></a>13.6.4 TIME-WAIT Assassination (TWA)</h3><h2 id="13-7-TCP-Server-Operation"><a href="#13-7-TCP-Server-Operation" class="headerlink" title="13.7 TCP Server Operation"></a>13.7 TCP Server Operation</h2><h3 id="13-7-1-TCP-Port-Numbers"><a href="#13-7-1-TCP-Port-Numbers" class="headerlink" title="13.7.1 TCP Port Numbers"></a>13.7.1 TCP Port Numbers</h3><h3 id="13-7-2-Restricting-Local-IP-Addresses"><a href="#13-7-2-Restricting-Local-IP-Addresses" class="headerlink" title="13.7.2 Restricting Local IP Addresses"></a>13.7.2 Restricting Local IP Addresses</h3><h3 id="13-7-3-Restricting-Foreign-Endpoints"><a href="#13-7-3-Restricting-Foreign-Endpoints" class="headerlink" title="13.7.3 Restricting Foreign Endpoints"></a>13.7.3 Restricting Foreign Endpoints</h3><h3 id="13-7-4-Incoming-Connection-Queue"><a href="#13-7-4-Incoming-Connection-Queue" class="headerlink" title="13.7.4 Incoming Connection Queue"></a>13.7.4 Incoming Connection Queue</h3><h2 id="13-8-Attacks-Involving-TCP-Connection-Management"><a href="#13-8-Attacks-Involving-TCP-Connection-Management" class="headerlink" title="13.8 Attacks Involving TCP Connection Management"></a>13.8 Attacks Involving TCP Connection Management</h2><h2 id="13-9-Summary"><a href="#13-9-Summary" class="headerlink" title="13.9 Summary"></a>13.9 Summary</h2><h2 id="13-10-References"><a href="#13-10-References" class="headerlink" title="13.10 References"></a>13.10 References</h2><h1 id="Chapter-14-TCP-Timeout-and-Retransmission"><a href="#Chapter-14-TCP-Timeout-and-Retransmission" class="headerlink" title="Chapter 14 TCP Timeout and Retransmission"></a>Chapter 14 TCP Timeout and Retransmission</h1><h2 id="14-1-Introduction"><a href="#14-1-Introduction" class="headerlink" title="14.1 Introduction"></a>14.1 Introduction</h2><h2 id="14-2-Simple-Timeout-and-Retransmission-Example"><a href="#14-2-Simple-Timeout-and-Retransmission-Example" class="headerlink" title="14.2 Simple Timeout and Retransmission Example"></a>14.2 Simple Timeout and Retransmission Example</h2><h2 id="14-3-Setting-the-Retransmission-Timeout-RTO"><a href="#14-3-Setting-the-Retransmission-Timeout-RTO" class="headerlink" title="14.3 Setting the Retransmission Timeout (RTO)"></a>14.3 Setting the Retransmission Timeout (RTO)</h2><h3 id="14-3-1-The-Classic-Method"><a href="#14-3-1-The-Classic-Method" class="headerlink" title="14.3.1 The Classic Method"></a>14.3.1 The Classic Method</h3><h3 id="14-3-2-The-Standard-Method"><a href="#14-3-2-The-Standard-Method" class="headerlink" title="14.3.2 The Standard Method"></a>14.3.2 The Standard Method</h3><h3 id="14-3-3-The-Linux-Method"><a href="#14-3-3-The-Linux-Method" class="headerlink" title="14.3.3 The Linux Method"></a>14.3.3 The Linux Method</h3><h3 id="14-3-4-RTT-Estimator-Behaviors"><a href="#14-3-4-RTT-Estimator-Behaviors" class="headerlink" title="14.3.4 RTT Estimator Behaviors"></a>14.3.4 RTT Estimator Behaviors</h3><h3 id="14-3-5-RTTM-Robustness-to-Loss-and-Reordering"><a href="#14-3-5-RTTM-Robustness-to-Loss-and-Reordering" class="headerlink" title="14.3.5 RTTM Robustness to Loss and Reordering"></a>14.3.5 RTTM Robustness to Loss and Reordering</h3><h2 id="14-4-Timer-Based-Retransmission"><a href="#14-4-Timer-Based-Retransmission" class="headerlink" title="14.4 Timer-Based Retransmission"></a>14.4 Timer-Based Retransmission</h2><h3 id="14-4-1-Example"><a href="#14-4-1-Example" class="headerlink" title="14.4.1 Example"></a>14.4.1 Example</h3><h2 id="14-5-Fast-Retransmit"><a href="#14-5-Fast-Retransmit" class="headerlink" title="14.5 Fast Retransmit"></a>14.5 Fast Retransmit</h2><h3 id="14-5-1-Example"><a href="#14-5-1-Example" class="headerlink" title="14.5.1 Example"></a>14.5.1 Example</h3><h2 id="14-6-Retransmission-with-Selective-Acknowledgments"><a href="#14-6-Retransmission-with-Selective-Acknowledgments" class="headerlink" title="14.6 Retransmission with Selective Acknowledgments"></a>14.6 Retransmission with Selective Acknowledgments</h2><h3 id="14-6-1-SACK-Receiver-Behavior"><a href="#14-6-1-SACK-Receiver-Behavior" class="headerlink" title="14.6.1 SACK Receiver Behavior"></a>14.6.1 SACK Receiver Behavior</h3><h3 id="14-6-2-SACK-Sender-Behavior"><a href="#14-6-2-SACK-Sender-Behavior" class="headerlink" title="14.6.2 SACK Sender Behavior"></a>14.6.2 SACK Sender Behavior</h3><h3 id="14-6-3-Example"><a href="#14-6-3-Example" class="headerlink" title="14.6.3 Example"></a>14.6.3 Example</h3><h2 id="14-7-Spurious-Timeouts-and-Retransmissions"><a href="#14-7-Spurious-Timeouts-and-Retransmissions" class="headerlink" title="14.7 Spurious Timeouts and Retransmissions"></a>14.7 Spurious Timeouts and Retransmissions</h2><h3 id="14-7-1-Duplicate-SACK-DSACK-Extension"><a href="#14-7-1-Duplicate-SACK-DSACK-Extension" class="headerlink" title="14.7.1 Duplicate SACK (DSACK) Extension"></a>14.7.1 Duplicate SACK (DSACK) Extension</h3><h3 id="14-7-2-The-Eifel-Detection-Algorithm"><a href="#14-7-2-The-Eifel-Detection-Algorithm" class="headerlink" title="14.7.2 The Eifel Detection Algorithm"></a>14.7.2 The Eifel Detection Algorithm</h3><h3 id="14-7-3-Forward-RTO-Recovery-F-RTO"><a href="#14-7-3-Forward-RTO-Recovery-F-RTO" class="headerlink" title="14.7.3 Forward-RTO Recovery (F-RTO)"></a>14.7.3 Forward-RTO Recovery (F-RTO)</h3><h3 id="14-7-4-The-Eifel-Response-Algorithm"><a href="#14-7-4-The-Eifel-Response-Algorithm" class="headerlink" title="14.7.4 The Eifel Response Algorithm"></a>14.7.4 The Eifel Response Algorithm</h3><h2 id="14-8-Packet-Reordering-and-Duplication"><a href="#14-8-Packet-Reordering-and-Duplication" class="headerlink" title="14.8 Packet Reordering and Duplication"></a>14.8 Packet Reordering and Duplication</h2><h3 id="14-8-1-Reordering"><a href="#14-8-1-Reordering" class="headerlink" title="14.8.1 Reordering"></a>14.8.1 Reordering</h3><h3 id="14-8-2-Duplication"><a href="#14-8-2-Duplication" class="headerlink" title="14.8.2 Duplication"></a>14.8.2 Duplication</h3><h2 id="14-9-Destination-Metrics"><a href="#14-9-Destination-Metrics" class="headerlink" title="14.9 Destination Metrics"></a>14.9 Destination Metrics</h2><h2 id="14-10-Repacketization"><a href="#14-10-Repacketization" class="headerlink" title="14.10 Repacketization"></a>14.10 Repacketization</h2><h2 id="14-11-Attacks-Involving-TCP-Retransmission"><a href="#14-11-Attacks-Involving-TCP-Retransmission" class="headerlink" title="14.11 Attacks Involving TCP Retransmission"></a>14.11 Attacks Involving TCP Retransmission</h2><h2 id="14-12-Summary"><a href="#14-12-Summary" class="headerlink" title="14.12 Summary"></a>14.12 Summary</h2><h2 id="14-13-References"><a href="#14-13-References" class="headerlink" title="14.13 References"></a>14.13 References</h2><h1 id="Chapter-15-TCP-Data-Flow-and-Window-Management"><a href="#Chapter-15-TCP-Data-Flow-and-Window-Management" class="headerlink" title="Chapter 15 TCP Data Flow and Window Management"></a>Chapter 15 TCP Data Flow and Window Management</h1><h2 id="15-1-Introduction"><a href="#15-1-Introduction" class="headerlink" title="15.1 Introduction"></a>15.1 Introduction</h2><h2 id="15-2-Interactive-Communication"><a href="#15-2-Interactive-Communication" class="headerlink" title="15.2 Interactive Communication"></a>15.2 Interactive Communication</h2><h2 id="15-3-Delayed-Acknowledgments"><a href="#15-3-Delayed-Acknowledgments" class="headerlink" title="15.3 Delayed Acknowledgments"></a>15.3 Delayed Acknowledgments</h2><h2 id="15-4-Nagle-Algorithm"><a href="#15-4-Nagle-Algorithm" class="headerlink" title="15.4 Nagle Algorithm"></a>15.4 Nagle Algorithm</h2><h3 id="15-4-1-Delayed-ACK-and-Nagle-Algorithm-Interaction"><a href="#15-4-1-Delayed-ACK-and-Nagle-Algorithm-Interaction" class="headerlink" title="15.4.1 Delayed ACK and Nagle Algorithm Interaction"></a>15.4.1 Delayed ACK and Nagle Algorithm Interaction</h3><h3 id="15-4-2-Disabling-the-Nagle-Algorithm"><a href="#15-4-2-Disabling-the-Nagle-Algorithm" class="headerlink" title="15.4.2 Disabling the Nagle Algorithm"></a>15.4.2 Disabling the Nagle Algorithm</h3><h2 id="15-5-Flow-Control-and-Window-Management"><a href="#15-5-Flow-Control-and-Window-Management" class="headerlink" title="15.5 Flow Control and Window Management"></a>15.5 Flow Control and Window Management</h2><h3 id="15-5-1-Sliding-Windows"><a href="#15-5-1-Sliding-Windows" class="headerlink" title="15.5.1 Sliding Windows"></a>15.5.1 Sliding Windows</h3><h3 id="15-5-2-Zero-Windows-and-the-TCP-Persist-Timer"><a href="#15-5-2-Zero-Windows-and-the-TCP-Persist-Timer" class="headerlink" title="15.5.2 Zero Windows and the TCP Persist Timer"></a>15.5.2 Zero Windows and the TCP Persist Timer</h3><h3 id="15-5-3-Silly-Window-Syndrome-SWS"><a href="#15-5-3-Silly-Window-Syndrome-SWS" class="headerlink" title="15.5.3 Silly Window Syndrome (SWS)"></a>15.5.3 Silly Window Syndrome (SWS)</h3><h3 id="15-5-4-Large-Buffers-and-Auto-Tuning"><a href="#15-5-4-Large-Buffers-and-Auto-Tuning" class="headerlink" title="15.5.4 Large Buffers and Auto-Tuning"></a>15.5.4 Large Buffers and Auto-Tuning</h3><h2 id="15-6-Urgent-Mechanism"><a href="#15-6-Urgent-Mechanism" class="headerlink" title="15.6 Urgent Mechanism"></a>15.6 Urgent Mechanism</h2><h3 id="15-6-1-Example"><a href="#15-6-1-Example" class="headerlink" title="15.6.1 Example"></a>15.6.1 Example</h3><h2 id="15-7-Attacks-Involving-Window-Management"><a href="#15-7-Attacks-Involving-Window-Management" class="headerlink" title="15.7 Attacks Involving Window Management"></a>15.7 Attacks Involving Window Management</h2><h2 id="15-8-Summary"><a href="#15-8-Summary" class="headerlink" title="15.8 Summary"></a>15.8 Summary</h2><h2 id="15-9-References"><a href="#15-9-References" class="headerlink" title="15.9 References"></a>15.9 References</h2><h1 id="Chapter-16-TCP-Congestion-Control"><a href="#Chapter-16-TCP-Congestion-Control" class="headerlink" title="Chapter 16 TCP Congestion Control"></a>Chapter 16 TCP Congestion Control</h1><h2 id="16-1-Introduction"><a href="#16-1-Introduction" class="headerlink" title="16.1 Introduction"></a>16.1 Introduction</h2><h3 id="16-1-1-Detection-of-Congestion-in-TCP"><a href="#16-1-1-Detection-of-Congestion-in-TCP" class="headerlink" title="16.1.1 Detection of Congestion in TCP"></a>16.1.1 Detection of Congestion in TCP</h3><h3 id="16-1-2-Slowing-Down-a-TCP-Sender"><a href="#16-1-2-Slowing-Down-a-TCP-Sender" class="headerlink" title="16.1.2 Slowing Down a TCP Sender"></a>16.1.2 Slowing Down a TCP Sender</h3><h2 id="16-2-The-Classic-Algorithms"><a href="#16-2-The-Classic-Algorithms" class="headerlink" title="16.2 The Classic Algorithms"></a>16.2 The Classic Algorithms</h2><h3 id="16-2-1-Slow-Start"><a href="#16-2-1-Slow-Start" class="headerlink" title="16.2.1 Slow Start"></a>16.2.1 Slow Start</h3><h3 id="16-2-2-Congestion-Avoidance"><a href="#16-2-2-Congestion-Avoidance" class="headerlink" title="16.2.2 Congestion Avoidance"></a>16.2.2 Congestion Avoidance</h3><h3 id="16-2-3-Selecting-between-Slow-Start-and-Congestion-Avoidance"><a href="#16-2-3-Selecting-between-Slow-Start-and-Congestion-Avoidance" class="headerlink" title="16.2.3 Selecting between Slow Start and Congestion Avoidance"></a>16.2.3 Selecting between Slow Start and Congestion Avoidance</h3><h3 id="16-2-4-Tahoe-Reno-and-Fast-Recovery"><a href="#16-2-4-Tahoe-Reno-and-Fast-Recovery" class="headerlink" title="16.2.4 Tahoe, Reno, and Fast Recovery"></a>16.2.4 Tahoe, Reno, and Fast Recovery</h3><h3 id="16-2-5-Standard-TCP"><a href="#16-2-5-Standard-TCP" class="headerlink" title="16.2.5 Standard TCP"></a>16.2.5 Standard TCP</h3><h2 id="16-3-Evolution-of-the-Standard-Algorithms"><a href="#16-3-Evolution-of-the-Standard-Algorithms" class="headerlink" title="16.3 Evolution of the Standard Algorithms"></a>16.3 Evolution of the Standard Algorithms</h2><h3 id="16-3-1-NewReno"><a href="#16-3-1-NewReno" class="headerlink" title="16.3.1 NewReno"></a>16.3.1 NewReno</h3><h3 id="16-3-2-TCP-Congestion-Control-with-SACK"><a href="#16-3-2-TCP-Congestion-Control-with-SACK" class="headerlink" title="16.3.2 TCP Congestion Control with SACK"></a>16.3.2 TCP Congestion Control with SACK</h3><h3 id="16-3-3-Forward-Acknowledgment-FACK-and-Rate-Halving"><a href="#16-3-3-Forward-Acknowledgment-FACK-and-Rate-Halving" class="headerlink" title="16.3.3 Forward Acknowledgment (FACK) and Rate Halving"></a>16.3.3 Forward Acknowledgment (FACK) and Rate Halving</h3><h3 id="16-3-4-Limited-Transmit"><a href="#16-3-4-Limited-Transmit" class="headerlink" title="16.3.4 Limited Transmit"></a>16.3.4 Limited Transmit</h3><h3 id="16-3-5-Congestion-Window-Validation-CWV"><a href="#16-3-5-Congestion-Window-Validation-CWV" class="headerlink" title="16.3.5 Congestion Window Validation (CWV)"></a>16.3.5 Congestion Window Validation (CWV)</h3><h2 id="16-4-Handling-Spurious-RTOs—the-Eifel-Response-Algorithm"><a href="#16-4-Handling-Spurious-RTOs—the-Eifel-Response-Algorithm" class="headerlink" title="16.4 Handling Spurious RTOs—the Eifel Response Algorithm"></a>16.4 Handling Spurious RTOs—the Eifel Response Algorithm</h2><h2 id="16-5-An-Extended-Example"><a href="#16-5-An-Extended-Example" class="headerlink" title="16.5 An Extended Example"></a>16.5 An Extended Example</h2><h3 id="16-5-1-Slow-Start-Behavior"><a href="#16-5-1-Slow-Start-Behavior" class="headerlink" title="16.5.1 Slow Start Behavior"></a>16.5.1 Slow Start Behavior</h3><h3 id="16-5-2-Sender-Pause-and-Local-Congestion-Event-1"><a href="#16-5-2-Sender-Pause-and-Local-Congestion-Event-1" class="headerlink" title="16.5.2 Sender Pause and Local Congestion (Event 1)"></a>16.5.2 Sender Pause and Local Congestion (Event 1)</h3><h3 id="16-5-3-Stretch-ACKs-and-Recovery-from-Local-Congestion"><a href="#16-5-3-Stretch-ACKs-and-Recovery-from-Local-Congestion" class="headerlink" title="16.5.3 Stretch ACKs and Recovery from Local Congestion"></a>16.5.3 Stretch ACKs and Recovery from Local Congestion</h3><h3 id="16-5-4-Fast-Retransmission-and-SACK-Recovery-Event-2"><a href="#16-5-4-Fast-Retransmission-and-SACK-Recovery-Event-2" class="headerlink" title="16.5.4 Fast Retransmission and SACK Recovery (Event 2)"></a>16.5.4 Fast Retransmission and SACK Recovery (Event 2)</h3><h3 id="16-5-5-Additional-Local-Congestion-and-Fast-Retransmit-Events"><a href="#16-5-5-Additional-Local-Congestion-and-Fast-Retransmit-Events" class="headerlink" title="16.5.5 Additional Local Congestion and Fast Retransmit Events"></a>16.5.5 Additional Local Congestion and Fast Retransmit Events</h3><h3 id="16-5-6-Timeouts-Retransmissions-and-Undoing-cwnd-Changes"><a href="#16-5-6-Timeouts-Retransmissions-and-Undoing-cwnd-Changes" class="headerlink" title="16.5.6 Timeouts, Retransmissions, and Undoing cwnd Changes"></a>16.5.6 Timeouts, Retransmissions, and Undoing cwnd Changes</h3><h3 id="16-5-7-Connection-Completion"><a href="#16-5-7-Connection-Completion" class="headerlink" title="16.5.7 Connection Completion"></a>16.5.7 Connection Completion</h3><h2 id="16-6-Sharing-Congestion-State"><a href="#16-6-Sharing-Congestion-State" class="headerlink" title="16.6 Sharing Congestion State"></a>16.6 Sharing Congestion State</h2><h2 id="16-7-TCP-Friendliness"><a href="#16-7-TCP-Friendliness" class="headerlink" title="16.7 TCP Friendliness"></a>16.7 TCP Friendliness</h2><h2 id="16-8-TCP-in-High-Speed-Environments"><a href="#16-8-TCP-in-High-Speed-Environments" class="headerlink" title="16.8 TCP in High-Speed Environments"></a>16.8 TCP in High-Speed Environments</h2><h3 id="16-8-1-HighSpeed-TCP-HSTCP-and-Limited-Slow-Start"><a href="#16-8-1-HighSpeed-TCP-HSTCP-and-Limited-Slow-Start" class="headerlink" title="16.8.1 HighSpeed TCP (HSTCP) and Limited Slow Start"></a>16.8.1 HighSpeed TCP (HSTCP) and Limited Slow Start</h3><h3 id="16-8-2-Binary-Increase-Congestion-Control-BIC-and-CUBIC"><a href="#16-8-2-Binary-Increase-Congestion-Control-BIC-and-CUBIC" class="headerlink" title="16.8.2 Binary Increase Congestion Control (BIC and CUBIC)"></a>16.8.2 Binary Increase Congestion Control (BIC and CUBIC)</h3><h2 id="16-9-Delay-Based-Congestion-Control"><a href="#16-9-Delay-Based-Congestion-Control" class="headerlink" title="16.9 Delay-Based Congestion Control"></a>16.9 Delay-Based Congestion Control</h2><h3 id="16-9-1-Vegas"><a href="#16-9-1-Vegas" class="headerlink" title="16.9.1 Vegas"></a>16.9.1 Vegas</h3><h3 id="16-9-2-FAST"><a href="#16-9-2-FAST" class="headerlink" title="16.9.2 FAST"></a>16.9.2 FAST</h3><h3 id="16-9-3-TCP-Westwood-and-Westwood"><a href="#16-9-3-TCP-Westwood-and-Westwood" class="headerlink" title="16.9.3 TCP Westwood and Westwood+"></a>16.9.3 TCP Westwood and Westwood+</h3><h3 id="16-9-4-Compound-TCP"><a href="#16-9-4-Compound-TCP" class="headerlink" title="16.9.4 Compound TCP"></a>16.9.4 Compound TCP</h3><h2 id="16-10-Buffer-Bloat"><a href="#16-10-Buffer-Bloat" class="headerlink" title="16.10 Buffer Bloat"></a>16.10 Buffer Bloat</h2><h2 id="16-11-Active-Queue-Management-and-ECN"><a href="#16-11-Active-Queue-Management-and-ECN" class="headerlink" title="16.11 Active Queue Management and ECN"></a>16.11 Active Queue Management and ECN</h2><h2 id="16-12-Attacks-Involving-TCP-Congestion-Control"><a href="#16-12-Attacks-Involving-TCP-Congestion-Control" class="headerlink" title="16.12 Attacks Involving TCP Congestion Control"></a>16.12 Attacks Involving TCP Congestion Control</h2><h2 id="16-13-Summary"><a href="#16-13-Summary" class="headerlink" title="16.13 Summary"></a>16.13 Summary</h2><h2 id="16-14-References"><a href="#16-14-References" class="headerlink" title="16.14 References"></a>16.14 References</h2><h1 id="Chapter-17-TCP-Keepalive"><a href="#Chapter-17-TCP-Keepalive" class="headerlink" title="Chapter 17 TCP Keepalive"></a>Chapter 17 TCP Keepalive</h1><h2 id="17-1-Introduction"><a href="#17-1-Introduction" class="headerlink" title="17.1 Introduction"></a>17.1 Introduction</h2><h2 id="17-2-Description"><a href="#17-2-Description" class="headerlink" title="17.2 Description"></a>17.2 Description</h2><h3 id="17-2-1-Keepalive-Examples"><a href="#17-2-1-Keepalive-Examples" class="headerlink" title="17.2.1 Keepalive Examples"></a>17.2.1 Keepalive Examples</h3><h2 id="17-3-Attacks-Involving-TCP-Keepalives"><a href="#17-3-Attacks-Involving-TCP-Keepalives" class="headerlink" title="17.3 Attacks Involving TCP Keepalives"></a>17.3 Attacks Involving TCP Keepalives</h2><h2 id="17-4-Summary"><a href="#17-4-Summary" class="headerlink" title="17.4 Summary"></a>17.4 Summary</h2><h2 id="17-5-References"><a href="#17-5-References" class="headerlink" title="17.5 References"></a>17.5 References</h2><h1 id="Chapter-18-Security-EAP-IPsec-TLS-DNSSEC-and-DKIM"><a href="#Chapter-18-Security-EAP-IPsec-TLS-DNSSEC-and-DKIM" class="headerlink" title="Chapter 18 Security: EAP, IPsec, TLS, DNSSEC, and DKIM"></a>Chapter 18 Security: EAP, IPsec, TLS, DNSSEC, and DKIM</h1><h2 id="18-1-Introduction"><a href="#18-1-Introduction" class="headerlink" title="18.1 Introduction"></a>18.1 Introduction</h2><h2 id="18-2-Basic-Principles-of-Information-Security"><a href="#18-2-Basic-Principles-of-Information-Security" class="headerlink" title="18.2 Basic Principles of Information Security"></a>18.2 Basic Principles of Information Security</h2><h2 id="18-3-Threats-to-Network-Communication"><a href="#18-3-Threats-to-Network-Communication" class="headerlink" title="18.3 Threats to Network Communication"></a>18.3 Threats to Network Communication</h2><h2 id="18-4-Basic-Cryptography-and-Security-Mechanisms"><a href="#18-4-Basic-Cryptography-and-Security-Mechanisms" class="headerlink" title="18.4 Basic Cryptography and Security Mechanisms"></a>18.4 Basic Cryptography and Security Mechanisms</h2><h3 id="18-4-1-Cryptosystems"><a href="#18-4-1-Cryptosystems" class="headerlink" title="18.4.1 Cryptosystems"></a>18.4.1 Cryptosystems</h3><h3 id="18-4-2-Rivest-Shamir-and-Adleman-RSA-Public-Key-Cryptography"><a href="#18-4-2-Rivest-Shamir-and-Adleman-RSA-Public-Key-Cryptography" class="headerlink" title="18.4.2 Rivest, Shamir, and Adleman (RSA) Public Key Cryptography"></a>18.4.2 Rivest, Shamir, and Adleman (RSA) Public Key Cryptography</h3><h3 id="18-4-3-Diffie-Hellman-Merkle-Key-Agreement-aka-Diffie-Hellman-or-DH"><a href="#18-4-3-Diffie-Hellman-Merkle-Key-Agreement-aka-Diffie-Hellman-or-DH" class="headerlink" title="18.4.3 Diffie-Hellman-Merkle Key Agreement (aka Diffie-Hellman or DH)"></a>18.4.3 Diffie-Hellman-Merkle Key Agreement (aka Diffie-Hellman or DH)</h3><h3 id="18-4-4-Signcryption-and-Elliptic-Curve-Cryptography-ECC"><a href="#18-4-4-Signcryption-and-Elliptic-Curve-Cryptography-ECC" class="headerlink" title="18.4.4 Signcryption and Elliptic Curve Cryptography (ECC)"></a>18.4.4 Signcryption and Elliptic Curve Cryptography (ECC)</h3><h3 id="18-4-5-Key-Derivation-and-Perfect-Forward-Secrecy-PFS"><a href="#18-4-5-Key-Derivation-and-Perfect-Forward-Secrecy-PFS" class="headerlink" title="18.4.5 Key Derivation and Perfect Forward Secrecy (PFS)"></a>18.4.5 Key Derivation and Perfect Forward Secrecy (PFS)</h3><h3 id="18-4-6-Pseudorandom-Numbers-Generators-and-Function-Families"><a href="#18-4-6-Pseudorandom-Numbers-Generators-and-Function-Families" class="headerlink" title="18.4.6 Pseudorandom Numbers, Generators, and Function Families"></a>18.4.6 Pseudorandom Numbers, Generators, and Function Families</h3><h3 id="18-4-7-Nonces-and-Salt"><a href="#18-4-7-Nonces-and-Salt" class="headerlink" title="18.4.7 Nonces and Salt"></a>18.4.7 Nonces and Salt</h3><h3 id="18-4-8-Cryptographic-Hash-Functions-and-Message-Digests"><a href="#18-4-8-Cryptographic-Hash-Functions-and-Message-Digests" class="headerlink" title="18.4.8 Cryptographic Hash Functions and Message Digests"></a>18.4.8 Cryptographic Hash Functions and Message Digests</h3><h3 id="18-4-9-Message-Authentication-Codes-MACs-HMAC-CMAC-and-GMAC"><a href="#18-4-9-Message-Authentication-Codes-MACs-HMAC-CMAC-and-GMAC" class="headerlink" title="18.4.9 Message Authentication Codes (MACs, HMAC, CMAC, and GMAC)"></a>18.4.9 Message Authentication Codes (MACs, HMAC, CMAC, and GMAC)</h3><h3 id="18-4-10-Cryptographic-Suites-and-Cipher-Suites"><a href="#18-4-10-Cryptographic-Suites-and-Cipher-Suites" class="headerlink" title="18.4.10 Cryptographic Suites and Cipher Suites"></a>18.4.10 Cryptographic Suites and Cipher Suites</h3><h2 id="18-5-Certificates-Certificate-Authorities-CAs-and-PKIs"><a href="#18-5-Certificates-Certificate-Authorities-CAs-and-PKIs" class="headerlink" title="18.5 Certificates, Certificate Authorities (CAs), and PKIs"></a>18.5 Certificates, Certificate Authorities (CAs), and PKIs</h2><h4 id="18-5-1-Public-Key-Certificates-Certificate-Authorities-and-X-509"><a href="#18-5-1-Public-Key-Certificates-Certificate-Authorities-and-X-509" class="headerlink" title="18.5.1 Public Key Certificates, Certificate Authorities, and X.509"></a>18.5.1 Public Key Certificates, Certificate Authorities, and X.509</h4><h3 id="18-5-2-Validating-and-Revoking-Certificates"><a href="#18-5-2-Validating-and-Revoking-Certificates" class="headerlink" title="18.5.2 Validating and Revoking Certificates"></a>18.5.2 Validating and Revoking Certificates</h3><h3 id="18-5-3-Attribute-Certificates"><a href="#18-5-3-Attribute-Certificates" class="headerlink" title="18.5.3 Attribute Certificates"></a>18.5.3 Attribute Certificates</h3><h2 id="18-6-TCP-x2F-IP-Security-Protocols-and-Layering"><a href="#18-6-TCP-x2F-IP-Security-Protocols-and-Layering" class="headerlink" title="18.6 TCP&#x2F;IP Security Protocols and Layering"></a>18.6 TCP&#x2F;IP Security Protocols and Layering</h2><h4 id="18-7-Network-Access-Control-802-1X-802-1AE-EAP-and-PANA"><a href="#18-7-Network-Access-Control-802-1X-802-1AE-EAP-and-PANA" class="headerlink" title="18.7 Network Access Control: 802.1X, 802.1AE, EAP, and PANA"></a>18.7 Network Access Control: 802.1X, 802.1AE, EAP, and PANA</h4><h3 id="18-7-1-EAP-Methods-and-Key-Derivation"><a href="#18-7-1-EAP-Methods-and-Key-Derivation" class="headerlink" title="18.7.1 EAP Methods and Key Derivation"></a>18.7.1 EAP Methods and Key Derivation</h3><h3 id="18-7-2-The-EAP-Re-authentication-Protocol-ERP"><a href="#18-7-2-The-EAP-Re-authentication-Protocol-ERP" class="headerlink" title="18.7.2 The EAP Re-authentication Protocol (ERP)"></a>18.7.2 The EAP Re-authentication Protocol (ERP)</h3><h3 id="18-7-3-Protocol-for-Carrying-Authentication-for-Network-Access-PANA"><a href="#18-7-3-Protocol-for-Carrying-Authentication-for-Network-Access-PANA" class="headerlink" title="18.7.3 Protocol for Carrying Authentication for Network Access (PANA)"></a>18.7.3 Protocol for Carrying Authentication for Network Access (PANA)</h3><h2 id="18-8-Layer-3-IP-Security-IPsec"><a href="#18-8-Layer-3-IP-Security-IPsec" class="headerlink" title="18.8 Layer 3 IP Security (IPsec)"></a>18.8 Layer 3 IP Security (IPsec)</h2><h3 id="18-8-1-Internet-Key-Exchange-IKEv2-Protocol"><a href="#18-8-1-Internet-Key-Exchange-IKEv2-Protocol" class="headerlink" title="18.8.1 Internet Key Exchange (IKEv2) Protocol"></a>18.8.1 Internet Key Exchange (IKEv2) Protocol</h3><h3 id="18-8-2-Authentication-Header-AH"><a href="#18-8-2-Authentication-Header-AH" class="headerlink" title="18.8.2 Authentication Header (AH)"></a>18.8.2 Authentication Header (AH)</h3><h3 id="18-8-3-Encapsulating-Security-Payload-ESP"><a href="#18-8-3-Encapsulating-Security-Payload-ESP" class="headerlink" title="18.8.3 Encapsulating Security Payload (ESP)"></a>18.8.3 Encapsulating Security Payload (ESP)</h3><h3 id="18-8-4-Multicast"><a href="#18-8-4-Multicast" class="headerlink" title="18.8.4 Multicast"></a>18.8.4 Multicast</h3><h3 id="18-8-5-L2TP-x2F-IPsec"><a href="#18-8-5-L2TP-x2F-IPsec" class="headerlink" title="18.8.5 L2TP&#x2F;IPsec"></a>18.8.5 L2TP&#x2F;IPsec</h3><h3 id="18-8-6-IPsec-NAT-Traversal"><a href="#18-8-6-IPsec-NAT-Traversal" class="headerlink" title="18.8.6 IPsec NAT Traversal"></a>18.8.6 IPsec NAT Traversal</h3><h3 id="18-8-7-Example"><a href="#18-8-7-Example" class="headerlink" title="18.8.7 Example"></a>18.8.7 Example</h3><h2 id="18-9-Transport-Layer-Security-TLS-and-DTLS"><a href="#18-9-Transport-Layer-Security-TLS-and-DTLS" class="headerlink" title="18.9 Transport Layer Security (TLS and DTLS)"></a>18.9 Transport Layer Security (TLS and DTLS)</h2><h4 id="18-9-1-TLS-1-2"><a href="#18-9-1-TLS-1-2" class="headerlink" title="18.9.1 TLS 1.2"></a>18.9.1 TLS 1.2</h4><h3 id="18-9-2-TLS-with-Datagrams-DTLS"><a href="#18-9-2-TLS-with-Datagrams-DTLS" class="headerlink" title="18.9.2 TLS with Datagrams (DTLS)"></a>18.9.2 TLS with Datagrams (DTLS)</h3><h2 id="18-10-DNS-Security-DNSSEC"><a href="#18-10-DNS-Security-DNSSEC" class="headerlink" title="18.10 DNS Security (DNSSEC)"></a>18.10 DNS Security (DNSSEC)</h2><h3 id="18-10-1-DNSSEC-Resource-Records"><a href="#18-10-1-DNSSEC-Resource-Records" class="headerlink" title="18.10.1 DNSSEC Resource Records"></a>18.10.1 DNSSEC Resource Records</h3><h3 id="18-10-2-DNSSEC-Operation"><a href="#18-10-2-DNSSEC-Operation" class="headerlink" title="18.10.2 DNSSEC Operation"></a>18.10.2 DNSSEC Operation</h3><h3 id="18-10-3-Transaction-Authentication-TSIG-TKEY-and-SIG-0"><a href="#18-10-3-Transaction-Authentication-TSIG-TKEY-and-SIG-0" class="headerlink" title="18.10.3 Transaction Authentication (TSIG, TKEY, and SIG(0))"></a>18.10.3 Transaction Authentication (TSIG, TKEY, and SIG(0))</h3><h3 id="18-10-4-DNSSEC-with-DNS64"><a href="#18-10-4-DNSSEC-with-DNS64" class="headerlink" title="18.10.4 DNSSEC with DNS64"></a>18.10.4 DNSSEC with DNS64</h3><h2 id="18-11-DomainKeys-Identified-Mail-DKIM"><a href="#18-11-DomainKeys-Identified-Mail-DKIM" class="headerlink" title="18.11 DomainKeys Identified Mail (DKIM)"></a>18.11 DomainKeys Identified Mail (DKIM)</h2><h3 id="18-11-1-DKIM-Signatures"><a href="#18-11-1-DKIM-Signatures" class="headerlink" title="18.11.1 DKIM Signatures"></a>18.11.1 DKIM Signatures</h3><h3 id="18-11-2-Example"><a href="#18-11-2-Example" class="headerlink" title="18.11.2 Example"></a>18.11.2 Example</h3><h2 id="18-12-Attacks-on-Security-Protocols"><a href="#18-12-Attacks-on-Security-Protocols" class="headerlink" title="18.12 Attacks on Security Protocols"></a>18.12 Attacks on Security Protocols</h2><h2 id="18-13-Summary"><a href="#18-13-Summary" class="headerlink" title="18.13 Summary"></a>18.13 Summary</h2><h2 id="18-14-References"><a href="#18-14-References" class="headerlink" title="18.14 References"></a>18.14 References</h2><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h1 id="internet-www-difference"><a href="#internet-www-difference" class="headerlink" title="internet www difference"></a>internet www difference</h1><table>
<thead>
<tr>
<th align="left">S.No.</th>
<th align="left">INTERNET</th>
<th align="left">WWW</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">Internet is a global network of networks.</td>
<td align="left">WWW stands for World wide Web.</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Internet is a means of connecting a computer to any other computer anywhere in the world.</td>
<td align="left">World Wide Web which is a collection of information which is accessed via the Internet.</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Internet is infrastructure.</td>
<td align="left">WWW is <strong>service</strong> on top of that infrastructure.</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Internet can be viewed as a big book-store.</td>
<td align="left">Web can be viewed as collection of books on that store.</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">At some advanced level, to understand we can think of the Internet as hardware.</td>
<td align="left">At some advanced level, to understand we can think of the WWW as software.</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">Internet is primarily hardware-based.</td>
<td align="left">WWW is more software-oriented as compared to the Internet.</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">It is originated sometimes in late 1960s.</td>
<td align="left">English scientist Tim Berners-Lee invented the World Wide Web in 1989.</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">Internet is superset of WWW.</td>
<td align="left">WWW is a subset of the Internet.</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">The first version of the Internet was known as ARPANET.</td>
<td align="left">In the beginning WWW was known as NSFNET.</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">Internet uses IP address.</td>
<td align="left">WWW uses HTTP.</td>
</tr>
</tbody></table>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io">Sinos</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sinos_wei.gitee.io/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">https://sinos_wei.gitee.io/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/cover/IMG_3302.JPG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/20/js/"><img class="prev-cover" src="/img/cover/IMG_1975.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">js</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/12/http%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><img class="next-cover" src="/img/cover/IMG_2617.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">http权威指南读书笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.PNG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sinos</div><div class="author-info__description">己所不欲, 勿施于人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lightmanwei"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lightmanwei" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1143474942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-1-Introduction"><span class="toc-number">1.</span> <span class="toc-text">Chapter 1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Architectural-Principles"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 Architectural Principles</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-Packets-Connections-and-Datagrams"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 Packets, Connections, and Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-The-End-to-End-Argument-and-Fate-Sharing"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 The End-to-End Argument and Fate Sharing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-Error-Control-and-Flow-Control"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 Error Control and Flow Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Design-and-Implementation"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Design and Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-Layering"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 Layering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-Multiplexing-Demultiplexing-and-Encapsulation-in-Layered-Implementations"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 Multiplexing, Demultiplexing, and Encapsulation in Layered Implementations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-The-Architecture-and-Protocols-of-the-TCP-x2F-IP-Suite"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 The Architecture and Protocols of the TCP&#x2F;IP Suite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-The-ARPANET-Reference-Model"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.3.1 The ARPANET Reference Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-Multiplexing-Demultiplexing-and-Encapsulation-in-TCP-x2F-IP"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.3.2 Multiplexing, Demultiplexing, and Encapsulation in TCP&#x2F;IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-3-Port-Numbers"><span class="toc-number">1.3.3.</span> <span class="toc-text">1.3.3 Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-4-Names-Addresses-and-the-DNS"><span class="toc-number">1.3.4.</span> <span class="toc-text">1.3.4 Names, Addresses, and the DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Internets-Intranets-and-Extranets"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 Internets, Intranets, and Extranets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-Designing-Applications"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 Designing Applications</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-1-Client-x2F-Server"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.5.1 Client&#x2F;Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-2-Peer-to-Peer"><span class="toc-number">1.5.2.</span> <span class="toc-text">1.5.2 Peer-to-Peer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-3-Application-Programming-Interfaces-APIs"><span class="toc-number">1.5.3.</span> <span class="toc-text">1.5.3 Application Programming Interfaces (APIs)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-Standardization-Process"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 Standardization Process</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-1-Request-for-Comments-RFC"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.6.1 Request for Comments (RFC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-2-Other-Standards"><span class="toc-number">1.6.2.</span> <span class="toc-text">1.6.2 Other Standards</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-Implementations-and-Software-Distributions"><span class="toc-number">1.7.</span> <span class="toc-text">1.7 Implementations and Software Distributions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-Attacks-Involving-the-Internet-Architecture"><span class="toc-number">1.8.</span> <span class="toc-text">1.8 Attacks Involving the Internet Architecture</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-Summary"><span class="toc-number">1.9.</span> <span class="toc-text">1.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-10-References"><span class="toc-number">1.10.</span> <span class="toc-text">1.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-2-The-Internet-Address-Architecture"><span class="toc-number">2.</span> <span class="toc-text">Chapter 2 The Internet Address Architecture</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Introduction"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Expressing-IP-Addresses"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Expressing IP Addresses</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-Basic-IP-Address-Structure"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Basic IP Address Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-Classful-Addressing"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 Classful Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-Subnet-Addressing"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 Subnet Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-3-Subnet-Masks"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.3 Subnet Masks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-4-Variable-Length-Subnet-Masks-VLSM"><span class="toc-number">2.3.4.</span> <span class="toc-text">2.3.4 Variable-Length Subnet Masks (VLSM)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-5-Broadcast-Addresses"><span class="toc-number">2.3.5.</span> <span class="toc-text">2.3.5 Broadcast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-6-IPv6-Addresses-and-Interface-Identifiers"><span class="toc-number">2.3.6.</span> <span class="toc-text">2.3.6 IPv6 Addresses and Interface Identifiers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-CIDR-Classless-Inter-Domain-Routing-and-Aggregation"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 CIDR(Classless Inter-Domain Routing) and Aggregation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-Prefixes"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 Prefixes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-Aggregation-%E8%81%9A%E5%90%88"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 Aggregation 聚合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-Special-Use-Addresses"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 Special-Use Addresses</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-Addressing-IPv4-x2F-IPv6-Translators"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 Addressing IPv4&#x2F;IPv6 Translators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-Multicast-Addresses"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-IPv4-Multicast-Addresses"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3 IPv4 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-4-IPv6-Multicast-Addresses"><span class="toc-number">2.5.4.</span> <span class="toc-text">2.5.4 IPv6 Multicast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-5-Anycast-Addresses"><span class="toc-number">2.5.5.</span> <span class="toc-text">2.5.5 Anycast Addresses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-Allocation"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 Allocation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-1-Unicast"><span class="toc-number">2.6.1.</span> <span class="toc-text">2.6.1 Unicast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-2-Multicast"><span class="toc-number">2.6.2.</span> <span class="toc-text">2.6.2 Multicast</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-Unicast-Address-Assignment"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 Unicast Address Assignment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-Single-Provider-x2F-No-Network-x2F-Single-Address"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1 Single Provider&#x2F;No Network&#x2F;Single Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-Single-Provider-x2F-Single-Network-x2F-Single-Address"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2 Single Provider&#x2F;Single Network&#x2F;Single Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-3-Single-Provider-x2F-Multiple-Networks-x2F-Multiple-Addresses"><span class="toc-number">2.7.3.</span> <span class="toc-text">2.7.3 Single Provider&#x2F;Multiple Networks&#x2F;Multiple Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-4-Multiple-Providers-x2F-Multiple-Networks-x2F-Multiple-Addresses-Multihoming"><span class="toc-number">2.7.4.</span> <span class="toc-text">2.7.4 Multiple Providers&#x2F;Multiple Networks&#x2F;Multiple Addresses (Multihoming)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-Attacks-Involving-IP-Addresses"><span class="toc-number">2.8.</span> <span class="toc-text">2.8 Attacks Involving IP Addresses</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-Summary"><span class="toc-number">2.9.</span> <span class="toc-text">2.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-References"><span class="toc-number">2.10.</span> <span class="toc-text">2.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-3-Link-Layer"><span class="toc-number">3.</span> <span class="toc-text">Chapter 3 Link Layer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Introduction"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Ethernet-and-the-IEEE-802-LAN-x2F-MAN-Standards"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 Ethernet and the IEEE 802 LAN&#x2F;MAN Standards</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-The-IEEE-802-LAN-x2F-MAN-Standards"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 The IEEE 802 LAN&#x2F;MAN Standards</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-The-Ethernet-Frame-Format"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 The Ethernet Frame Format</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-802-1p-x2F-q-Virtual-LANs-and-QoS-Tagging"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">3.2.3 802.1p&#x2F;q: Virtual LANs and QoS Tagging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-4-802-1AX-Link-Aggregation-Formerly-802-3ad"><span class="toc-number">3.2.2.1.1.</span> <span class="toc-text">3.2.4 802.1AX: Link Aggregation (Formerly 802.3ad)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Full-Duplex-Power-Save-Autonegotiation-and-802-1X-Flow-Control"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.3 Full Duplex, Power Save, Autonegotiation, and 802.1X Flow Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-Duplex-Mismatch"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.3.1 Duplex Mismatch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-Wake-on-LAN-WoL-Power-Saving-and-Magic-Packets"><span class="toc-number">3.2.5.</span> <span class="toc-text">3.3.2 Wake-on LAN (WoL), Power Saving, and Magic Packets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-Link-Layer-Flow-Control"><span class="toc-number">3.2.6.</span> <span class="toc-text">3.3.3 Link-Layer Flow Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-Bridges-and-Switches"><span class="toc-number">3.3.</span> <span class="toc-text">3.4 Bridges and Switches</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-Spanning-Tree-Protocol-STP"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.4.1 Spanning Tree Protocol (STP)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-802-1ak-Multiple-Registration-Protocol-MRP"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">3.4.2 802.1ak: Multiple Registration Protocol (MRP)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Wireless-LANs%E2%80%94IEEE-802-11-Wi-Fi"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.5 Wireless LANs—IEEE 802.11(Wi-Fi)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-802-11-Frames"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">3.5.1 802.11 Frames</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-2-Power-Save-Mode-and-the-Time-Sync-Function-TSF"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.5.2 Power Save Mode and the Time Sync Function (TSF)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-3-802-11-Media-Access-Control"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">3.5.3 802.11 Media Access Control</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-4-Physical-Layer-Details-Rates-Channels-and-Frequencies"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.5.4 Physical-Layer Details: Rates, Channels, and Frequencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-5-Wi-Fi-Security"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.5.5 Wi-Fi Security</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-6-Wi-Fi-Mesh-802-11s"><span class="toc-number">3.3.5.1.</span> <span class="toc-text">3.5.6 Wi-Fi Mesh (802.11s)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-Point-to-Point-Protocol-PPP"><span class="toc-number">3.4.</span> <span class="toc-text">3.6 Point-to-Point Protocol (PPP)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-1-Link-Control-Protocol-LCP"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.6.1 Link Control Protocol (LCP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-2-Multilink-PPP-MP"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.6.2 Multilink PPP (MP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-3-Compression-Control-Protocol-CCP"><span class="toc-number">3.4.3.</span> <span class="toc-text">3.6.3 Compression Control Protocol (CCP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-4-PPP-Authentication"><span class="toc-number">3.4.4.</span> <span class="toc-text">3.6.4 PPP Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-5-Network-Control-Protocols-NCPs"><span class="toc-number">3.4.5.</span> <span class="toc-text">3.6.5 Network Control Protocols (NCPs)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-6-Header-Compression"><span class="toc-number">3.4.6.</span> <span class="toc-text">3.6.6 Header Compression</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-7-Example"><span class="toc-number">3.4.7.</span> <span class="toc-text">3.6.7 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-Loopback"><span class="toc-number">3.5.</span> <span class="toc-text">3.7 Loopback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-8-MTU-and-Path-MTU"><span class="toc-number">3.6.</span> <span class="toc-text">3.8 MTU and Path MTU</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-9-Tunneling-Basics"><span class="toc-number">3.7.</span> <span class="toc-text">3.9 Tunneling Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-1-Unidirectional-Links"><span class="toc-number">3.7.1.</span> <span class="toc-text">3.9.1 Unidirectional Links</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-10-Attacks-on-the-Link-Layer"><span class="toc-number">3.8.</span> <span class="toc-text">3.10 Attacks on the Link Layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-11-Summary"><span class="toc-number">3.9.</span> <span class="toc-text">3.11 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-12-References"><span class="toc-number">3.10.</span> <span class="toc-text">3.12 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-4-ARP-Address-Resolution-Protocol"><span class="toc-number">4.</span> <span class="toc-text">Chapter 4 ARP: Address Resolution Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-Introduction"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-An-Example"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 An Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-Direct-Delivery-and-ARP"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 Direct Delivery and ARP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-ARP-Cache"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 ARP Cache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-ARP-Frame-Format"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 ARP Frame Format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-ARP-Examples"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 ARP Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1-Normal-Example"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 Normal Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2-ARP-Request-to-a-Nonexistent-Host"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 ARP Request to a Nonexistent Host</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-ARP-Cache-Timeout"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 ARP Cache Timeout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-Proxy-ARP"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 Proxy ARP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-Gratuitous-ARP-and-Address-Conflict-Detection-ACD"><span class="toc-number">4.8.</span> <span class="toc-text">4.8 Gratuitous ARP and Address Conflict Detection (ACD)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-The-arp-Command"><span class="toc-number">4.9.</span> <span class="toc-text">4.9 The arp Command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10-Using-ARP-to-Set-an-Embedded-Device%E2%80%99s-IPv4-Address"><span class="toc-number">4.10.</span> <span class="toc-text">4.10 Using ARP to Set an Embedded Device’s IPv4 Address</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11-Attacks-Involving-ARP"><span class="toc-number">4.11.</span> <span class="toc-text">4.11 Attacks Involving ARP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-12-Summary"><span class="toc-number">4.12.</span> <span class="toc-text">4.12 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-13-References"><span class="toc-number">4.13.</span> <span class="toc-text">4.13 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-5-The-Internet-Protocol-IP"><span class="toc-number">5.</span> <span class="toc-text">Chapter 5 The Internet Protocol (IP)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Introduction"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-IPv4-and-IPv6-Headers"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 IPv4 and IPv6 Headers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-IP-Header-Fields"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 IP Header Fields</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-The-Internet-Checksum"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 The Internet Checksum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-3-DS-Field-and-ECN-Formerly-Called-the-ToS-Byte-or-IPv6-Traffic-Class"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.2.3 DS Field and ECN (Formerly Called the ToS Byte or IPv6 Traffic Class)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-4-IP-Options"><span class="toc-number">5.2.4.</span> <span class="toc-text">5.2.4 IP Options</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-IPv6-Extension-Headers"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 IPv6 Extension Headers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-IPv6-Options"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1 IPv6 Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-Routing-Header"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2 Routing Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-Fragment-Header"><span class="toc-number">5.3.3.</span> <span class="toc-text">5.3.3 Fragment Header</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-IP-Forwarding"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 IP Forwarding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-1-Forwarding-Table"><span class="toc-number">5.4.1.</span> <span class="toc-text">5.4.1 Forwarding Table</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-2-IP-Forwarding-Actions"><span class="toc-number">5.4.2.</span> <span class="toc-text">5.4.2 IP Forwarding Actions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-3-Examples"><span class="toc-number">5.4.3.</span> <span class="toc-text">5.4.3 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-4-Discussion"><span class="toc-number">5.4.4.</span> <span class="toc-text">5.4.4 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-Mobile-IP"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 Mobile IP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-1-The-Basic-Model-Bidirectional-Tunneling"><span class="toc-number">5.5.1.</span> <span class="toc-text">5.5.1 The Basic Model: Bidirectional Tunneling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-2-Route-Optimization-RO"><span class="toc-number">5.5.2.</span> <span class="toc-text">5.5.2 Route Optimization (RO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-3-Discussion"><span class="toc-number">5.5.3.</span> <span class="toc-text">5.5.3 Discussion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-Host-Processing-of-IP-Datagrams"><span class="toc-number">5.6.</span> <span class="toc-text">5.6 Host Processing of IP Datagrams</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-1-Host-Models"><span class="toc-number">5.6.1.</span> <span class="toc-text">5.6.1 Host Models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-2-Address-Selection"><span class="toc-number">5.6.2.</span> <span class="toc-text">5.6.2 Address Selection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-Attacks-Involving-IP"><span class="toc-number">5.7.</span> <span class="toc-text">5.7 Attacks Involving IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8-Summary"><span class="toc-number">5.8.</span> <span class="toc-text">5.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-9-References"><span class="toc-number">5.9.</span> <span class="toc-text">5.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-6-System-Configuration-DHCP-and-Autoconfiguration"><span class="toc-number">6.</span> <span class="toc-text">Chapter 6 System Configuration: DHCP and Autoconfiguration</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-Introduction"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-Dynamic-Host-Configuration-Protocol-DHCP"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 Dynamic Host Configuration Protocol (DHCP)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-Address-Pools-and-Leases"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1 Address Pools and Leases</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-2-DHCP-and-BOOTP-Message-Format"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2 DHCP and BOOTP Message Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-3-DHCP-and-BOOTP-Options"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3 DHCP and BOOTP Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-4-DHCP-Protocol-Operation"><span class="toc-number">6.2.4.</span> <span class="toc-text">6.2.4 DHCP Protocol Operation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-5-DHCPv6"><span class="toc-number">6.2.5.</span> <span class="toc-text">6.2.5 DHCPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-6-Using-DHCP-with-Relays"><span class="toc-number">6.2.6.</span> <span class="toc-text">6.2.6 Using DHCP with Relays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-7-DHCP-Authentication"><span class="toc-number">6.2.7.</span> <span class="toc-text">6.2.7 DHCP Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-8-Reconfigure-Extension"><span class="toc-number">6.2.8.</span> <span class="toc-text">6.2.8 Reconfigure Extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-9-Rapid-Commit"><span class="toc-number">6.2.9.</span> <span class="toc-text">6.2.9 Rapid Commit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-10-Location-Information-LCI-and-LoST"><span class="toc-number">6.2.10.</span> <span class="toc-text">6.2.10 Location Information (LCI and LoST)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-11-Mobility-and-Handoff-Information-MoS-and-ANDSF"><span class="toc-number">6.2.11.</span> <span class="toc-text">6.2.11 Mobility and Handoff Information (MoS and ANDSF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-12-DHCP-Snooping"><span class="toc-number">6.2.12.</span> <span class="toc-text">6.2.12 DHCP Snooping</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-Stateless-Address-Autoconfiguration-SLAAC"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 Stateless Address Autoconfiguration (SLAAC)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-1-Dynamic-Configuration-of-IPv4-Link-Local-Addresses"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1 Dynamic Configuration of IPv4 Link-Local Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-2-IPv6-SLAAC-for-Link-Local-Addresses"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2 IPv6 SLAAC for Link-Local Addresses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-DHCP-and-DNS-Interaction"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 DHCP and DNS Interaction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-PPP-over-Ethernet-PPPoE"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 PPP over Ethernet (PPPoE)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-Attacks-Involving-System-Configuration"><span class="toc-number">6.6.</span> <span class="toc-text">6.6 Attacks Involving System Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-Summary"><span class="toc-number">6.7.</span> <span class="toc-text">6.7 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8-References"><span class="toc-number">6.8.</span> <span class="toc-text">6.8 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-7-Firewalls-and-Network-Address-Translation-NAT"><span class="toc-number">7.</span> <span class="toc-text">Chapter 7 Firewalls and Network Address Translation (NAT)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-Introduction"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-Firewalls"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 Firewalls</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-1-Packet-Filtering-Firewalls"><span class="toc-number">7.2.1.</span> <span class="toc-text">7.2.1 Packet-Filtering Firewalls</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-2-Proxy-Firewalls"><span class="toc-number">7.2.2.</span> <span class="toc-text">7.2.2 Proxy Firewalls</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-Network-Address-Translation-NAT"><span class="toc-number">7.3.</span> <span class="toc-text">7.3 Network Address Translation (NAT)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-1-Traditional-NAT-Basic-NAT-and-NAPT"><span class="toc-number">7.3.1.</span> <span class="toc-text">7.3.1 Traditional NAT: Basic NAT and NAPT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-2-Address-and-Port-Translation-Behavior"><span class="toc-number">7.3.2.</span> <span class="toc-text">7.3.2 Address and Port Translation Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-3-Filtering-Behavior"><span class="toc-number">7.3.3.</span> <span class="toc-text">7.3.3 Filtering Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-4-Servers-behind-NATs"><span class="toc-number">7.3.4.</span> <span class="toc-text">7.3.4 Servers behind NATs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-5-Hairpinning-and-NAT-Loopback"><span class="toc-number">7.3.5.</span> <span class="toc-text">7.3.5 Hairpinning and NAT Loopback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-6-NAT-Editors"><span class="toc-number">7.3.6.</span> <span class="toc-text">7.3.6 NAT Editors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-7-Service-Provider-NAT-SPNAT-and-Service-Provider-IPv6-Transition"><span class="toc-number">7.3.7.</span> <span class="toc-text">7.3.7 Service Provider NAT (SPNAT) and Service Provider IPv6 Transition</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-NAT-Traversal"><span class="toc-number">7.4.</span> <span class="toc-text">7.4 NAT Traversal</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-1-Pinholes-and-Hole-Punching"><span class="toc-number">7.4.1.</span> <span class="toc-text">7.4.1 Pinholes and Hole Punching</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-2-UNilateral-Self-Address-Fixing-UNSAF"><span class="toc-number">7.4.2.</span> <span class="toc-text">7.4.2 UNilateral Self-Address Fixing (UNSAF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-3-Session-Traversal-Utilities-for-NAT-STUN"><span class="toc-number">7.4.3.</span> <span class="toc-text">7.4.3 Session Traversal Utilities for NAT (STUN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-4-Traversal-Using-Relays-around-NAT-TURN"><span class="toc-number">7.4.4.</span> <span class="toc-text">7.4.4 Traversal Using Relays around NAT (TURN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-5-Interactive-Connectivity-Establishment-ICE"><span class="toc-number">7.4.5.</span> <span class="toc-text">7.4.5 Interactive Connectivity Establishment (ICE)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-Configuring-Packet-Filtering-Firewalls-and-NATs"><span class="toc-number">7.5.</span> <span class="toc-text">7.5 Configuring Packet-Filtering Firewalls and NATs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-1-Firewall-Rules"><span class="toc-number">7.5.1.</span> <span class="toc-text">7.5.1 Firewall Rules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-2-NAT-Rules"><span class="toc-number">7.5.2.</span> <span class="toc-text">7.5.2 NAT Rules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-3-Direct-Interaction-with-NATs-and-Firewalls-UPnP-NAT-PMP-and-PCP"><span class="toc-number">7.5.3.</span> <span class="toc-text">7.5.3 Direct Interaction with NATs and Firewalls: UPnP, NAT-PMP, and PCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-6-NAT-for-IPv4-x2F-IPv6-Coexistence-and-Transition"><span class="toc-number">7.6.</span> <span class="toc-text">7.6 NAT for IPv4&#x2F;IPv6 Coexistence and Transition</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-1-Dual-Stack-Lite-DS-Lite"><span class="toc-number">7.6.1.</span> <span class="toc-text">7.6.1 Dual-Stack Lite (DS-Lite)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-2-IPv4-x2F-IPv6-Translation-Using-NATs-and-ALGs"><span class="toc-number">7.6.2.</span> <span class="toc-text">7.6.2 IPv4&#x2F;IPv6 Translation Using NATs and ALGs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-7-Attacks-Involving-Firewalls-and-NATs"><span class="toc-number">7.7.</span> <span class="toc-text">7.7 Attacks Involving Firewalls and NATs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-8-Summary"><span class="toc-number">7.8.</span> <span class="toc-text">7.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-9-References"><span class="toc-number">7.9.</span> <span class="toc-text">7.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-8-ICMPv4-and-ICMPv6-Internet-Control-Message-Protocol"><span class="toc-number">8.</span> <span class="toc-text">Chapter 8 ICMPv4 and ICMPv6: Internet Control Message Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-Introduction"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-Encapsulation-in-IPv4-and-IPv6"><span class="toc-number">8.1.1.</span> <span class="toc-text">8.1.1 Encapsulation in IPv4 and IPv6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-ICMP-Messages"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 ICMP Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-1-ICMPv4-Messages"><span class="toc-number">8.2.1.</span> <span class="toc-text">8.2.1 ICMPv4 Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-2-ICMPv6-Messages"><span class="toc-number">8.2.2.</span> <span class="toc-text">8.2.2 ICMPv6 Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-3-Processing-of-ICMP-Messages"><span class="toc-number">8.2.3.</span> <span class="toc-text">8.2.3 Processing of ICMP Messages</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-ICMP-Error-Messages"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 ICMP Error Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-1-Extended-ICMP-and-Multipart-Messages"><span class="toc-number">8.3.1.</span> <span class="toc-text">8.3.1 Extended ICMP and Multipart Messages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-2-Destination-Unreachable-ICMPv4-Type-3-ICMPv6-Type-1-and-Packet-Too-Big-ICMPv6-Type-2"><span class="toc-number">8.3.2.</span> <span class="toc-text">8.3.2 Destination Unreachable (ICMPv4 Type 3, ICMPv6 Type 1) and Packet Too Big (ICMPv6 Type 2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-3-Redirect-ICMPv4-Type-5-ICMPv6-Type-137"><span class="toc-number">8.3.3.</span> <span class="toc-text">8.3.3 Redirect (ICMPv4 Type 5, ICMPv6 Type 137)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-4-ICMP-Time-Exceeded-ICMPv4-Type-11-ICMPv6-Type-3"><span class="toc-number">8.3.4.</span> <span class="toc-text">8.3.4 ICMP Time Exceeded (ICMPv4 Type 11, ICMPv6 Type 3)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-5-Parameter-Problem-ICMPv4-Type-12-ICMPv6-Type-4"><span class="toc-number">8.3.5.</span> <span class="toc-text">8.3.5 Parameter Problem (ICMPv4 Type 12, ICMPv6 Type 4)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-ICMP-Query-x2F-Informational-Messages"><span class="toc-number">8.4.</span> <span class="toc-text">8.4 ICMP Query&#x2F;Informational Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-1-Echo-Request-x2F-Reply-ping-ICMPv4-Types-0-x2F-8-ICMPv6-Types-129-x2F-128"><span class="toc-number">8.4.1.</span> <span class="toc-text">8.4.1 Echo Request&#x2F;Reply (ping) (ICMPv4 Types 0&#x2F;8, ICMPv6 Types 129&#x2F;128)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-2-Router-Discovery-Router-Solicitation-and-Advertisement-ICMPv4-Types-9-10"><span class="toc-number">8.4.2.</span> <span class="toc-text">8.4.2 Router Discovery: Router Solicitation and Advertisement (ICMPv4 Types 9, 10)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-3-Home-Agent-Address-Discovery-Request-x2F-Reply-ICMPv6-Types-144-x2F-145"><span class="toc-number">8.4.3.</span> <span class="toc-text">8.4.3 Home Agent Address Discovery Request&#x2F;Reply (ICMPv6 Types 144&#x2F;145)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-4-Mobile-Prefix-Solicitation-x2F-Advertisement-ICMPv6-Types-146-x2F-147"><span class="toc-number">8.4.4.</span> <span class="toc-text">8.4.4 Mobile Prefix Solicitation&#x2F;Advertisement (ICMPv6 Types 146&#x2F;147)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-5-Mobile-IPv6-Fast-Handover-Messages-ICMPv6-Type-154"><span class="toc-number">8.4.5.</span> <span class="toc-text">8.4.5 Mobile IPv6 Fast Handover Messages (ICMPv6 Type 154)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-6-Multicast-Listener-Query-x2F-Report-x2F-Done-ICMPv6-Types-130-x2F-131-x2F-132"><span class="toc-number">8.4.6.</span> <span class="toc-text">8.4.6 Multicast Listener Query&#x2F;Report&#x2F;Done (ICMPv6 Types 130&#x2F;131&#x2F;132)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-7-Version-2-Multicast-Listener-Discovery-MLDv2-ICMPv6-Type-143"><span class="toc-number">8.4.7.</span> <span class="toc-text">8.4.7 Version 2 Multicast Listener Discovery (MLDv2) (ICMPv6 Type 143)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-8-Multicast-Router-Discovery-MRD-IGMP-Types-48-x2F-49-x2F-50-ICMPv6-Types-151-x2F-152-x2F-153"><span class="toc-number">8.4.8.</span> <span class="toc-text">8.4.8 Multicast Router Discovery (MRD) (IGMP Types 48&#x2F;49&#x2F;50, ICMPv6 Types 151&#x2F;152&#x2F;153)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-Neighbor-Discovery-in-IPv6"><span class="toc-number">8.5.</span> <span class="toc-text">8.5 Neighbor Discovery in IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-1-ICMPv6-Router-Solicitation-and-Advertisement-ICMPv6-Types-133-134"><span class="toc-number">8.5.1.</span> <span class="toc-text">8.5.1 ICMPv6 Router Solicitation and Advertisement (ICMPv6 Types 133, 134)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-2-ICMPv6-Neighbor-Solicitation-and-Advertisement-IMCPv6-Types-135-136"><span class="toc-number">8.5.2.</span> <span class="toc-text">8.5.2 ICMPv6 Neighbor Solicitation and Advertisement (IMCPv6 Types 135, 136)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-3-ICMPv6-Inverse-Neighbor-Discovery-Solicitation-x2F-Advertisement-ICMPv6-Types-141-x2F-142"><span class="toc-number">8.5.3.</span> <span class="toc-text">8.5.3 ICMPv6 Inverse Neighbor Discovery Solicitation&#x2F;Advertisement (ICMPv6 Types 141&#x2F;142)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-4-Neighbor-Unreachability-Detection-NUD"><span class="toc-number">8.5.4.</span> <span class="toc-text">8.5.4 Neighbor Unreachability Detection (NUD)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-5-Secure-Neighbor-Discovery-SEND"><span class="toc-number">8.5.5.</span> <span class="toc-text">8.5.5 Secure Neighbor Discovery (SEND)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-6-ICMPv6-Neighbor-Discovery-ND-Options"><span class="toc-number">8.5.6.</span> <span class="toc-text">8.5.6 ICMPv6 Neighbor Discovery (ND) Options</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-Translating-ICMPv4-and-ICMPv6"><span class="toc-number">8.6.</span> <span class="toc-text">8.6 Translating ICMPv4 and ICMPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-6-1-Translating-ICMPv4-to-ICMPv6"><span class="toc-number">8.6.1.</span> <span class="toc-text">8.6.1 Translating ICMPv4 to ICMPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-6-2-Translating-ICMPv6-to-ICMPv4"><span class="toc-number">8.6.2.</span> <span class="toc-text">8.6.2 Translating ICMPv6 to ICMPv4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-7-Attacks-Involving-ICMP"><span class="toc-number">8.7.</span> <span class="toc-text">8.7 Attacks Involving ICMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-8-Summary"><span class="toc-number">8.8.</span> <span class="toc-text">8.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-9-References"><span class="toc-number">8.9.</span> <span class="toc-text">8.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-9-Broadcasting-and-Local-Multicasting-IGMP-and-MLD"><span class="toc-number">9.</span> <span class="toc-text">Chapter 9 Broadcasting and Local Multicasting (IGMP and MLD)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-Introduction"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-Broadcasting"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 Broadcasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-1-Using-Broadcast-Addresses"><span class="toc-number">9.2.1.</span> <span class="toc-text">9.2.1 Using Broadcast Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-2-Sending-Broadcast-Datagrams"><span class="toc-number">9.2.2.</span> <span class="toc-text">9.2.2 Sending Broadcast Datagrams</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-Multicasting"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 Multicasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-1-Converting-IP-Multicast-Addresses-to-802-MAC-x2F-Ethernet-Addresses"><span class="toc-number">9.3.1.</span> <span class="toc-text">9.3.1 Converting IP Multicast Addresses to 802 MAC&#x2F;Ethernet Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-2-Examples"><span class="toc-number">9.3.2.</span> <span class="toc-text">9.3.2 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-3-Sending-Multicast-Datagrams"><span class="toc-number">9.3.3.</span> <span class="toc-text">9.3.3 Sending Multicast Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-4-Receiving-Multicast-Datagrams"><span class="toc-number">9.3.4.</span> <span class="toc-text">9.3.4 Receiving Multicast Datagrams</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-5-Host-Address-Filtering"><span class="toc-number">9.3.5.</span> <span class="toc-text">9.3.5 Host Address Filtering</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-The-Internet-Group-Management-Protocol-IGMP-and-Multicast-Listener-Discovery-Protocol-MLD"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 The Internet Group Management Protocol (IGMP) and Multicast Listener Discovery Protocol (MLD)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-1-IGMP-and-MLD-Processing-by-Group-Members-%E2%80%9CGroup-Member-Part%E2%80%9D"><span class="toc-number">9.4.1.</span> <span class="toc-text">9.4.1 IGMP and MLD Processing by Group Members (“Group Member Part”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-2-IGMP-and-MLD-Processing-by-Multicast-Routers-%E2%80%9CMulticast-Router-Part%E2%80%9D"><span class="toc-number">9.4.2.</span> <span class="toc-text">9.4.2 IGMP and MLD Processing by Multicast Routers (“Multicast Router Part”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-3-Examples"><span class="toc-number">9.4.3.</span> <span class="toc-text">9.4.3 Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-4-Lightweight-IGMPv3-and-MLDv2"><span class="toc-number">9.4.4.</span> <span class="toc-text">9.4.4 Lightweight IGMPv3 and MLDv2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-5-IGMP-and-MLD-Robustness"><span class="toc-number">9.4.5.</span> <span class="toc-text">9.4.5 IGMP and MLD Robustness</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-6-IGMP-and-MLD-Counters-and-Variables"><span class="toc-number">9.4.6.</span> <span class="toc-text">9.4.6 IGMP and MLD Counters and Variables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-7-IGMP-and-MLD-Snooping"><span class="toc-number">9.4.7.</span> <span class="toc-text">9.4.7 IGMP and MLD Snooping</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-Attacks-Involving-IGMP-and-MLD"><span class="toc-number">9.5.</span> <span class="toc-text">9.5 Attacks Involving IGMP and MLD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-Summary"><span class="toc-number">9.6.</span> <span class="toc-text">9.6 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-References"><span class="toc-number">9.7.</span> <span class="toc-text">9.7 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-10-User-Datagram-Protocol-UDP-and-IP-Fragmentation"><span class="toc-number">10.</span> <span class="toc-text">Chapter 10 User Datagram Protocol (UDP) and IP Fragmentation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-Introduction"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-UDP-Header"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 UDP Header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-UDP-Checksum"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 UDP Checksum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4-Examples"><span class="toc-number">10.4.</span> <span class="toc-text">10.4 Examples</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-5-UDP-and-IPv6"><span class="toc-number">10.5.</span> <span class="toc-text">10.5 UDP and IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-1-Teredo-Tunneling-IPv6-through-IPv4-Networks"><span class="toc-number">10.5.1.</span> <span class="toc-text">10.5.1 Teredo: Tunneling IPv6 through IPv4 Networks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-6-UDP-Lite"><span class="toc-number">10.6.</span> <span class="toc-text">10.6 UDP-Lite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-7-IP-Fragmentation"><span class="toc-number">10.7.</span> <span class="toc-text">10.7 IP Fragmentation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-7-1-Example-UDP-x2F-IPv4-Fragmentation"><span class="toc-number">10.7.1.</span> <span class="toc-text">10.7.1 Example: UDP&#x2F;IPv4 Fragmentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-7-2-Reassembly-Timeout"><span class="toc-number">10.7.2.</span> <span class="toc-text">10.7.2 Reassembly Timeout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-8-Path-MTU-Discovery-with-UDP"><span class="toc-number">10.8.</span> <span class="toc-text">10.8 Path MTU Discovery with UDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-8-1-Example"><span class="toc-number">10.8.1.</span> <span class="toc-text">10.8.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-9-Interaction-between-IP-Fragmentation-and-ARP-x2F-ND"><span class="toc-number">10.9.</span> <span class="toc-text">10.9 Interaction between IP Fragmentation and ARP&#x2F;ND</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-10-Maximum-UDP-Datagram-Size"><span class="toc-number">10.10.</span> <span class="toc-text">10.10 Maximum UDP Datagram Size</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-10-1-Implementation-Limitations"><span class="toc-number">10.10.1.</span> <span class="toc-text">10.10.1 Implementation Limitations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-10-2-Datagram-Truncation"><span class="toc-number">10.10.2.</span> <span class="toc-text">10.10.2 Datagram Truncation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-11-UDP-Server-Design"><span class="toc-number">10.11.</span> <span class="toc-text">10.11 UDP Server Design</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-1-IP-Addresses-and-UDP-Port-Numbers"><span class="toc-number">10.11.1.</span> <span class="toc-text">10.11.1 IP Addresses and UDP Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-2-Restricting-Local-IP-Addresses"><span class="toc-number">10.11.2.</span> <span class="toc-text">10.11.2 Restricting Local IP Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-3-Using-Multiple-Addresses"><span class="toc-number">10.11.3.</span> <span class="toc-text">10.11.3 Using Multiple Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-4-Restricting-Foreign-IP-Address"><span class="toc-number">10.11.4.</span> <span class="toc-text">10.11.4 Restricting Foreign IP Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-5-Using-Multiple-Servers-per-Port"><span class="toc-number">10.11.5.</span> <span class="toc-text">10.11.5 Using Multiple Servers per Port</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-6-Spanning-Address-Families-IPv4-and-IPv6"><span class="toc-number">10.11.6.</span> <span class="toc-text">10.11.6 Spanning Address Families: IPv4 and IPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-11-7-Lack-of-Flow-and-Congestion-Control"><span class="toc-number">10.11.7.</span> <span class="toc-text">10.11.7 Lack of Flow and Congestion Control</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-12-Translating-UDP-x2F-IPv4-and-UDP-x2F-IPv6-Datagrams"><span class="toc-number">10.12.</span> <span class="toc-text">10.12 Translating UDP&#x2F;IPv4 and UDP&#x2F;IPv6 Datagrams</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-13-UDP-in-the-Internet"><span class="toc-number">10.13.</span> <span class="toc-text">10.13 UDP in the Internet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-14-Attacks-Involving-UDP-and-IP-Fragmentation"><span class="toc-number">10.14.</span> <span class="toc-text">10.14 Attacks Involving UDP and IP Fragmentation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-15-Summary"><span class="toc-number">10.15.</span> <span class="toc-text">10.15 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-16-References"><span class="toc-number">10.16.</span> <span class="toc-text">10.16 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-11-Name-Resolution-and-the-Domain-Name-System-DNS"><span class="toc-number">11.</span> <span class="toc-text">Chapter 11 Name Resolution and the Domain Name System (DNS)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-Introduction"><span class="toc-number">11.1.</span> <span class="toc-text">11.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-The-DNS-Name-Space"><span class="toc-number">11.2.</span> <span class="toc-text">11.2 The DNS Name Space</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-1-DNS-Naming-Syntax"><span class="toc-number">11.2.1.</span> <span class="toc-text">11.2.1 DNS Naming Syntax</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-Name-Servers-and-Zones"><span class="toc-number">11.3.</span> <span class="toc-text">11.3 Name Servers and Zones</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-4-Caching"><span class="toc-number">11.4.</span> <span class="toc-text">11.4 Caching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-5-The-DNS-Protocol"><span class="toc-number">11.5.</span> <span class="toc-text">11.5 The DNS Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-1-DNS-Message-Format"><span class="toc-number">11.5.1.</span> <span class="toc-text">11.5.1 DNS Message Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-2-The-DNS-Extension-Format-EDNS0"><span class="toc-number">11.5.2.</span> <span class="toc-text">11.5.2 The DNS Extension Format (EDNS0)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-3-UDP-or-TCP"><span class="toc-number">11.5.3.</span> <span class="toc-text">11.5.3 UDP or TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-4-Question-Query-and-Zone-Section-Format"><span class="toc-number">11.5.4.</span> <span class="toc-text">11.5.4 Question (Query) and Zone Section Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-5-Answer-Authority-and-Additional-Information-Section-Formats"><span class="toc-number">11.5.5.</span> <span class="toc-text">11.5.5 Answer, Authority, and Additional Information Section Formats</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-6-Resource-Record-Types"><span class="toc-number">11.5.6.</span> <span class="toc-text">11.5.6 Resource Record Types</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-7-Dynamic-Updates-DNS-UPDATE"><span class="toc-number">11.5.7.</span> <span class="toc-text">11.5.7 Dynamic Updates (DNS UPDATE)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-8-Zone-Transfers-and-DNS-NOTIFY"><span class="toc-number">11.5.8.</span> <span class="toc-text">11.5.8 Zone Transfers and DNS NOTIFY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-6-Sort-Lists-Round-Robin-and-Split-DNS"><span class="toc-number">11.6.</span> <span class="toc-text">11.6 Sort Lists, Round-Robin, and Split DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-7-Open-DNS-Servers-and-DynDNS"><span class="toc-number">11.7.</span> <span class="toc-text">11.7 Open DNS Servers and DynDNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-8-Transparency-and-Extensibility"><span class="toc-number">11.8.</span> <span class="toc-text">11.8 Transparency and Extensibility</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-9-Translating-DNS-from-IPv4-to-IPv6-DNS64"><span class="toc-number">11.9.</span> <span class="toc-text">11.9 Translating DNS from IPv4 to IPv6 (DNS64)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-10-LLMNR-and-mDNS"><span class="toc-number">11.10.</span> <span class="toc-text">11.10 LLMNR and mDNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-11-LDAP"><span class="toc-number">11.11.</span> <span class="toc-text">11.11 LDAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-12-Attacks-on-the-DNS"><span class="toc-number">11.12.</span> <span class="toc-text">11.12 Attacks on the DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-13-Summary"><span class="toc-number">11.13.</span> <span class="toc-text">11.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-14-References"><span class="toc-number">11.14.</span> <span class="toc-text">11.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-12-TCP-The-Transmission-Control-Protocol-Preliminaries"><span class="toc-number">12.</span> <span class="toc-text">Chapter 12 TCP: The Transmission Control Protocol (Preliminaries)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-Introduction"><span class="toc-number">12.1.</span> <span class="toc-text">12.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-1-ARQ-and-Retransmission"><span class="toc-number">12.1.1.</span> <span class="toc-text">12.1.1 ARQ and Retransmission</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-2-Windows-of-Packets-and-Sliding-Windows"><span class="toc-number">12.1.2.</span> <span class="toc-text">12.1.2 Windows of Packets and Sliding Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-3-Variable-Windows-Flow-Control-and-Congestion-Control"><span class="toc-number">12.1.3.</span> <span class="toc-text">12.1.3 Variable Windows: Flow Control and Congestion Control</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-4-Setting-the-Retransmission-Timeout"><span class="toc-number">12.1.4.</span> <span class="toc-text">12.1.4 Setting the Retransmission Timeout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-Introduction-to-TCP"><span class="toc-number">12.2.</span> <span class="toc-text">12.2 Introduction to TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-1-The-TCP-Service-Model"><span class="toc-number">12.2.1.</span> <span class="toc-text">12.2.1 The TCP Service Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-2-Reliability-in-TCP"><span class="toc-number">12.2.2.</span> <span class="toc-text">12.2.2 Reliability in TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-3-TCP-Header-and-Encapsulation"><span class="toc-number">12.3.</span> <span class="toc-text">12.3 TCP Header and Encapsulation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-4-Summary"><span class="toc-number">12.4.</span> <span class="toc-text">12.4 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-5-References"><span class="toc-number">12.5.</span> <span class="toc-text">12.5 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-13-TCP-Connection-Management"><span class="toc-number">13.</span> <span class="toc-text">Chapter 13 TCP Connection Management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-Introduction"><span class="toc-number">13.1.</span> <span class="toc-text">13.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-TCP-Connection-Establishment-and-Termination"><span class="toc-number">13.2.</span> <span class="toc-text">13.2 TCP Connection Establishment and Termination</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-1-TCP-Half-Close"><span class="toc-number">13.2.1.</span> <span class="toc-text">13.2.1 TCP Half-Close</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-2-Simultaneous-Open-and-Close"><span class="toc-number">13.2.2.</span> <span class="toc-text">13.2.2 Simultaneous Open and Close</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-3-Initial-Sequence-Number-ISN"><span class="toc-number">13.2.3.</span> <span class="toc-text">13.2.3 Initial Sequence Number (ISN)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-4-Example"><span class="toc-number">13.2.4.</span> <span class="toc-text">13.2.4 Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-5-Timeout-of-Connection-Establishment"><span class="toc-number">13.2.5.</span> <span class="toc-text">13.2.5 Timeout of Connection Establishment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-6-Connections-and-Translators"><span class="toc-number">13.2.6.</span> <span class="toc-text">13.2.6 Connections and Translators</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-3-TCP-Options"><span class="toc-number">13.3.</span> <span class="toc-text">13.3 TCP Options</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-1-Maximum-Segment-Size-MSS-Option"><span class="toc-number">13.3.1.</span> <span class="toc-text">13.3.1 Maximum Segment Size (MSS) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-2-Selective-Acknowledgment-SACK-Options"><span class="toc-number">13.3.2.</span> <span class="toc-text">13.3.2 Selective Acknowledgment (SACK) Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-3-Window-Scale-WSCALE-or-WSOPT-Option"><span class="toc-number">13.3.3.</span> <span class="toc-text">13.3.3 Window Scale (WSCALE or WSOPT) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-4-Timestamps-Option-and-Protection-against-Wrapped-Sequence-Numbers-PAWS"><span class="toc-number">13.3.4.</span> <span class="toc-text">13.3.4 Timestamps Option and Protection against Wrapped Sequence Numbers (PAWS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-5-User-Timeout-UTO-Option"><span class="toc-number">13.3.5.</span> <span class="toc-text">13.3.5 User Timeout (UTO) Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-6-Authentication-Option-TCP-AO"><span class="toc-number">13.3.6.</span> <span class="toc-text">13.3.6 Authentication Option (TCP-AO)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-4-Path-MTU-Discovery-with-TCP"><span class="toc-number">13.4.</span> <span class="toc-text">13.4 Path MTU Discovery with TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-1-Example"><span class="toc-number">13.4.1.</span> <span class="toc-text">13.4.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-5-TCP-State-Transitions"><span class="toc-number">13.5.</span> <span class="toc-text">13.5 TCP State Transitions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-1-TCP-State-Transition-Diagram"><span class="toc-number">13.5.1.</span> <span class="toc-text">13.5.1 TCP State Transition Diagram</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-2-TIME-WAIT-2MSL-Wait-State"><span class="toc-number">13.5.2.</span> <span class="toc-text">13.5.2 TIME_WAIT (2MSL Wait) State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-3-Quiet-Time-Concept"><span class="toc-number">13.5.3.</span> <span class="toc-text">13.5.3 Quiet Time Concept</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-4-FIN-WAIT-2-State"><span class="toc-number">13.5.4.</span> <span class="toc-text">13.5.4 FIN_WAIT_2 State</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-5-Simultaneous-Open-and-Close-Transitions"><span class="toc-number">13.5.5.</span> <span class="toc-text">13.5.5 Simultaneous Open and Close Transitions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-6-Reset-Segments"><span class="toc-number">13.6.</span> <span class="toc-text">13.6 Reset Segments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-1-Connection-Request-to-Nonexistent-Port"><span class="toc-number">13.6.1.</span> <span class="toc-text">13.6.1 Connection Request to Nonexistent Port</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-2-Aborting-a-Connection"><span class="toc-number">13.6.2.</span> <span class="toc-text">13.6.2 Aborting a Connection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-3-Half-Open-Connections"><span class="toc-number">13.6.3.</span> <span class="toc-text">13.6.3 Half-Open Connections</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-4-TIME-WAIT-Assassination-TWA"><span class="toc-number">13.6.4.</span> <span class="toc-text">13.6.4 TIME-WAIT Assassination (TWA)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-7-TCP-Server-Operation"><span class="toc-number">13.7.</span> <span class="toc-text">13.7 TCP Server Operation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-1-TCP-Port-Numbers"><span class="toc-number">13.7.1.</span> <span class="toc-text">13.7.1 TCP Port Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-2-Restricting-Local-IP-Addresses"><span class="toc-number">13.7.2.</span> <span class="toc-text">13.7.2 Restricting Local IP Addresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-3-Restricting-Foreign-Endpoints"><span class="toc-number">13.7.3.</span> <span class="toc-text">13.7.3 Restricting Foreign Endpoints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-4-Incoming-Connection-Queue"><span class="toc-number">13.7.4.</span> <span class="toc-text">13.7.4 Incoming Connection Queue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-8-Attacks-Involving-TCP-Connection-Management"><span class="toc-number">13.8.</span> <span class="toc-text">13.8 Attacks Involving TCP Connection Management</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-9-Summary"><span class="toc-number">13.9.</span> <span class="toc-text">13.9 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-10-References"><span class="toc-number">13.10.</span> <span class="toc-text">13.10 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-14-TCP-Timeout-and-Retransmission"><span class="toc-number">14.</span> <span class="toc-text">Chapter 14 TCP Timeout and Retransmission</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#14-1-Introduction"><span class="toc-number">14.1.</span> <span class="toc-text">14.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-2-Simple-Timeout-and-Retransmission-Example"><span class="toc-number">14.2.</span> <span class="toc-text">14.2 Simple Timeout and Retransmission Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-3-Setting-the-Retransmission-Timeout-RTO"><span class="toc-number">14.3.</span> <span class="toc-text">14.3 Setting the Retransmission Timeout (RTO)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-1-The-Classic-Method"><span class="toc-number">14.3.1.</span> <span class="toc-text">14.3.1 The Classic Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-2-The-Standard-Method"><span class="toc-number">14.3.2.</span> <span class="toc-text">14.3.2 The Standard Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-3-The-Linux-Method"><span class="toc-number">14.3.3.</span> <span class="toc-text">14.3.3 The Linux Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-4-RTT-Estimator-Behaviors"><span class="toc-number">14.3.4.</span> <span class="toc-text">14.3.4 RTT Estimator Behaviors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-5-RTTM-Robustness-to-Loss-and-Reordering"><span class="toc-number">14.3.5.</span> <span class="toc-text">14.3.5 RTTM Robustness to Loss and Reordering</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-4-Timer-Based-Retransmission"><span class="toc-number">14.4.</span> <span class="toc-text">14.4 Timer-Based Retransmission</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-4-1-Example"><span class="toc-number">14.4.1.</span> <span class="toc-text">14.4.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-5-Fast-Retransmit"><span class="toc-number">14.5.</span> <span class="toc-text">14.5 Fast Retransmit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-5-1-Example"><span class="toc-number">14.5.1.</span> <span class="toc-text">14.5.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-6-Retransmission-with-Selective-Acknowledgments"><span class="toc-number">14.6.</span> <span class="toc-text">14.6 Retransmission with Selective Acknowledgments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-6-1-SACK-Receiver-Behavior"><span class="toc-number">14.6.1.</span> <span class="toc-text">14.6.1 SACK Receiver Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-6-2-SACK-Sender-Behavior"><span class="toc-number">14.6.2.</span> <span class="toc-text">14.6.2 SACK Sender Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-6-3-Example"><span class="toc-number">14.6.3.</span> <span class="toc-text">14.6.3 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-7-Spurious-Timeouts-and-Retransmissions"><span class="toc-number">14.7.</span> <span class="toc-text">14.7 Spurious Timeouts and Retransmissions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-7-1-Duplicate-SACK-DSACK-Extension"><span class="toc-number">14.7.1.</span> <span class="toc-text">14.7.1 Duplicate SACK (DSACK) Extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-7-2-The-Eifel-Detection-Algorithm"><span class="toc-number">14.7.2.</span> <span class="toc-text">14.7.2 The Eifel Detection Algorithm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-7-3-Forward-RTO-Recovery-F-RTO"><span class="toc-number">14.7.3.</span> <span class="toc-text">14.7.3 Forward-RTO Recovery (F-RTO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-7-4-The-Eifel-Response-Algorithm"><span class="toc-number">14.7.4.</span> <span class="toc-text">14.7.4 The Eifel Response Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-8-Packet-Reordering-and-Duplication"><span class="toc-number">14.8.</span> <span class="toc-text">14.8 Packet Reordering and Duplication</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-8-1-Reordering"><span class="toc-number">14.8.1.</span> <span class="toc-text">14.8.1 Reordering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-8-2-Duplication"><span class="toc-number">14.8.2.</span> <span class="toc-text">14.8.2 Duplication</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-9-Destination-Metrics"><span class="toc-number">14.9.</span> <span class="toc-text">14.9 Destination Metrics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-10-Repacketization"><span class="toc-number">14.10.</span> <span class="toc-text">14.10 Repacketization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-11-Attacks-Involving-TCP-Retransmission"><span class="toc-number">14.11.</span> <span class="toc-text">14.11 Attacks Involving TCP Retransmission</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-12-Summary"><span class="toc-number">14.12.</span> <span class="toc-text">14.12 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-13-References"><span class="toc-number">14.13.</span> <span class="toc-text">14.13 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-15-TCP-Data-Flow-and-Window-Management"><span class="toc-number">15.</span> <span class="toc-text">Chapter 15 TCP Data Flow and Window Management</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#15-1-Introduction"><span class="toc-number">15.1.</span> <span class="toc-text">15.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-2-Interactive-Communication"><span class="toc-number">15.2.</span> <span class="toc-text">15.2 Interactive Communication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-3-Delayed-Acknowledgments"><span class="toc-number">15.3.</span> <span class="toc-text">15.3 Delayed Acknowledgments</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-4-Nagle-Algorithm"><span class="toc-number">15.4.</span> <span class="toc-text">15.4 Nagle Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-4-1-Delayed-ACK-and-Nagle-Algorithm-Interaction"><span class="toc-number">15.4.1.</span> <span class="toc-text">15.4.1 Delayed ACK and Nagle Algorithm Interaction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-4-2-Disabling-the-Nagle-Algorithm"><span class="toc-number">15.4.2.</span> <span class="toc-text">15.4.2 Disabling the Nagle Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-5-Flow-Control-and-Window-Management"><span class="toc-number">15.5.</span> <span class="toc-text">15.5 Flow Control and Window Management</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-5-1-Sliding-Windows"><span class="toc-number">15.5.1.</span> <span class="toc-text">15.5.1 Sliding Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-5-2-Zero-Windows-and-the-TCP-Persist-Timer"><span class="toc-number">15.5.2.</span> <span class="toc-text">15.5.2 Zero Windows and the TCP Persist Timer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-5-3-Silly-Window-Syndrome-SWS"><span class="toc-number">15.5.3.</span> <span class="toc-text">15.5.3 Silly Window Syndrome (SWS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-5-4-Large-Buffers-and-Auto-Tuning"><span class="toc-number">15.5.4.</span> <span class="toc-text">15.5.4 Large Buffers and Auto-Tuning</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-6-Urgent-Mechanism"><span class="toc-number">15.6.</span> <span class="toc-text">15.6 Urgent Mechanism</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-6-1-Example"><span class="toc-number">15.6.1.</span> <span class="toc-text">15.6.1 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-7-Attacks-Involving-Window-Management"><span class="toc-number">15.7.</span> <span class="toc-text">15.7 Attacks Involving Window Management</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-8-Summary"><span class="toc-number">15.8.</span> <span class="toc-text">15.8 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-9-References"><span class="toc-number">15.9.</span> <span class="toc-text">15.9 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-16-TCP-Congestion-Control"><span class="toc-number">16.</span> <span class="toc-text">Chapter 16 TCP Congestion Control</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#16-1-Introduction"><span class="toc-number">16.1.</span> <span class="toc-text">16.1 Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-1-1-Detection-of-Congestion-in-TCP"><span class="toc-number">16.1.1.</span> <span class="toc-text">16.1.1 Detection of Congestion in TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-1-2-Slowing-Down-a-TCP-Sender"><span class="toc-number">16.1.2.</span> <span class="toc-text">16.1.2 Slowing Down a TCP Sender</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-2-The-Classic-Algorithms"><span class="toc-number">16.2.</span> <span class="toc-text">16.2 The Classic Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-1-Slow-Start"><span class="toc-number">16.2.1.</span> <span class="toc-text">16.2.1 Slow Start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-2-Congestion-Avoidance"><span class="toc-number">16.2.2.</span> <span class="toc-text">16.2.2 Congestion Avoidance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-3-Selecting-between-Slow-Start-and-Congestion-Avoidance"><span class="toc-number">16.2.3.</span> <span class="toc-text">16.2.3 Selecting between Slow Start and Congestion Avoidance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-4-Tahoe-Reno-and-Fast-Recovery"><span class="toc-number">16.2.4.</span> <span class="toc-text">16.2.4 Tahoe, Reno, and Fast Recovery</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-5-Standard-TCP"><span class="toc-number">16.2.5.</span> <span class="toc-text">16.2.5 Standard TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-3-Evolution-of-the-Standard-Algorithms"><span class="toc-number">16.3.</span> <span class="toc-text">16.3 Evolution of the Standard Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-1-NewReno"><span class="toc-number">16.3.1.</span> <span class="toc-text">16.3.1 NewReno</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-2-TCP-Congestion-Control-with-SACK"><span class="toc-number">16.3.2.</span> <span class="toc-text">16.3.2 TCP Congestion Control with SACK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-3-Forward-Acknowledgment-FACK-and-Rate-Halving"><span class="toc-number">16.3.3.</span> <span class="toc-text">16.3.3 Forward Acknowledgment (FACK) and Rate Halving</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-4-Limited-Transmit"><span class="toc-number">16.3.4.</span> <span class="toc-text">16.3.4 Limited Transmit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-5-Congestion-Window-Validation-CWV"><span class="toc-number">16.3.5.</span> <span class="toc-text">16.3.5 Congestion Window Validation (CWV)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-4-Handling-Spurious-RTOs%E2%80%94the-Eifel-Response-Algorithm"><span class="toc-number">16.4.</span> <span class="toc-text">16.4 Handling Spurious RTOs—the Eifel Response Algorithm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-5-An-Extended-Example"><span class="toc-number">16.5.</span> <span class="toc-text">16.5 An Extended Example</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-1-Slow-Start-Behavior"><span class="toc-number">16.5.1.</span> <span class="toc-text">16.5.1 Slow Start Behavior</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-2-Sender-Pause-and-Local-Congestion-Event-1"><span class="toc-number">16.5.2.</span> <span class="toc-text">16.5.2 Sender Pause and Local Congestion (Event 1)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-3-Stretch-ACKs-and-Recovery-from-Local-Congestion"><span class="toc-number">16.5.3.</span> <span class="toc-text">16.5.3 Stretch ACKs and Recovery from Local Congestion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-4-Fast-Retransmission-and-SACK-Recovery-Event-2"><span class="toc-number">16.5.4.</span> <span class="toc-text">16.5.4 Fast Retransmission and SACK Recovery (Event 2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-5-Additional-Local-Congestion-and-Fast-Retransmit-Events"><span class="toc-number">16.5.5.</span> <span class="toc-text">16.5.5 Additional Local Congestion and Fast Retransmit Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-6-Timeouts-Retransmissions-and-Undoing-cwnd-Changes"><span class="toc-number">16.5.6.</span> <span class="toc-text">16.5.6 Timeouts, Retransmissions, and Undoing cwnd Changes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-5-7-Connection-Completion"><span class="toc-number">16.5.7.</span> <span class="toc-text">16.5.7 Connection Completion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-6-Sharing-Congestion-State"><span class="toc-number">16.6.</span> <span class="toc-text">16.6 Sharing Congestion State</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-7-TCP-Friendliness"><span class="toc-number">16.7.</span> <span class="toc-text">16.7 TCP Friendliness</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-8-TCP-in-High-Speed-Environments"><span class="toc-number">16.8.</span> <span class="toc-text">16.8 TCP in High-Speed Environments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-8-1-HighSpeed-TCP-HSTCP-and-Limited-Slow-Start"><span class="toc-number">16.8.1.</span> <span class="toc-text">16.8.1 HighSpeed TCP (HSTCP) and Limited Slow Start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-8-2-Binary-Increase-Congestion-Control-BIC-and-CUBIC"><span class="toc-number">16.8.2.</span> <span class="toc-text">16.8.2 Binary Increase Congestion Control (BIC and CUBIC)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-9-Delay-Based-Congestion-Control"><span class="toc-number">16.9.</span> <span class="toc-text">16.9 Delay-Based Congestion Control</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-9-1-Vegas"><span class="toc-number">16.9.1.</span> <span class="toc-text">16.9.1 Vegas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-9-2-FAST"><span class="toc-number">16.9.2.</span> <span class="toc-text">16.9.2 FAST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-9-3-TCP-Westwood-and-Westwood"><span class="toc-number">16.9.3.</span> <span class="toc-text">16.9.3 TCP Westwood and Westwood+</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-9-4-Compound-TCP"><span class="toc-number">16.9.4.</span> <span class="toc-text">16.9.4 Compound TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-10-Buffer-Bloat"><span class="toc-number">16.10.</span> <span class="toc-text">16.10 Buffer Bloat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-11-Active-Queue-Management-and-ECN"><span class="toc-number">16.11.</span> <span class="toc-text">16.11 Active Queue Management and ECN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-12-Attacks-Involving-TCP-Congestion-Control"><span class="toc-number">16.12.</span> <span class="toc-text">16.12 Attacks Involving TCP Congestion Control</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-13-Summary"><span class="toc-number">16.13.</span> <span class="toc-text">16.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-14-References"><span class="toc-number">16.14.</span> <span class="toc-text">16.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-17-TCP-Keepalive"><span class="toc-number">17.</span> <span class="toc-text">Chapter 17 TCP Keepalive</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#17-1-Introduction"><span class="toc-number">17.1.</span> <span class="toc-text">17.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-2-Description"><span class="toc-number">17.2.</span> <span class="toc-text">17.2 Description</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-1-Keepalive-Examples"><span class="toc-number">17.2.1.</span> <span class="toc-text">17.2.1 Keepalive Examples</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-3-Attacks-Involving-TCP-Keepalives"><span class="toc-number">17.3.</span> <span class="toc-text">17.3 Attacks Involving TCP Keepalives</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-4-Summary"><span class="toc-number">17.4.</span> <span class="toc-text">17.4 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-5-References"><span class="toc-number">17.5.</span> <span class="toc-text">17.5 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-18-Security-EAP-IPsec-TLS-DNSSEC-and-DKIM"><span class="toc-number">18.</span> <span class="toc-text">Chapter 18 Security: EAP, IPsec, TLS, DNSSEC, and DKIM</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#18-1-Introduction"><span class="toc-number">18.1.</span> <span class="toc-text">18.1 Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-2-Basic-Principles-of-Information-Security"><span class="toc-number">18.2.</span> <span class="toc-text">18.2 Basic Principles of Information Security</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-3-Threats-to-Network-Communication"><span class="toc-number">18.3.</span> <span class="toc-text">18.3 Threats to Network Communication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-4-Basic-Cryptography-and-Security-Mechanisms"><span class="toc-number">18.4.</span> <span class="toc-text">18.4 Basic Cryptography and Security Mechanisms</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-1-Cryptosystems"><span class="toc-number">18.4.1.</span> <span class="toc-text">18.4.1 Cryptosystems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-2-Rivest-Shamir-and-Adleman-RSA-Public-Key-Cryptography"><span class="toc-number">18.4.2.</span> <span class="toc-text">18.4.2 Rivest, Shamir, and Adleman (RSA) Public Key Cryptography</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-3-Diffie-Hellman-Merkle-Key-Agreement-aka-Diffie-Hellman-or-DH"><span class="toc-number">18.4.3.</span> <span class="toc-text">18.4.3 Diffie-Hellman-Merkle Key Agreement (aka Diffie-Hellman or DH)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-4-Signcryption-and-Elliptic-Curve-Cryptography-ECC"><span class="toc-number">18.4.4.</span> <span class="toc-text">18.4.4 Signcryption and Elliptic Curve Cryptography (ECC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-5-Key-Derivation-and-Perfect-Forward-Secrecy-PFS"><span class="toc-number">18.4.5.</span> <span class="toc-text">18.4.5 Key Derivation and Perfect Forward Secrecy (PFS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-6-Pseudorandom-Numbers-Generators-and-Function-Families"><span class="toc-number">18.4.6.</span> <span class="toc-text">18.4.6 Pseudorandom Numbers, Generators, and Function Families</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-7-Nonces-and-Salt"><span class="toc-number">18.4.7.</span> <span class="toc-text">18.4.7 Nonces and Salt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-8-Cryptographic-Hash-Functions-and-Message-Digests"><span class="toc-number">18.4.8.</span> <span class="toc-text">18.4.8 Cryptographic Hash Functions and Message Digests</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-9-Message-Authentication-Codes-MACs-HMAC-CMAC-and-GMAC"><span class="toc-number">18.4.9.</span> <span class="toc-text">18.4.9 Message Authentication Codes (MACs, HMAC, CMAC, and GMAC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-10-Cryptographic-Suites-and-Cipher-Suites"><span class="toc-number">18.4.10.</span> <span class="toc-text">18.4.10 Cryptographic Suites and Cipher Suites</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-5-Certificates-Certificate-Authorities-CAs-and-PKIs"><span class="toc-number">18.5.</span> <span class="toc-text">18.5 Certificates, Certificate Authorities (CAs), and PKIs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#18-5-1-Public-Key-Certificates-Certificate-Authorities-and-X-509"><span class="toc-number">18.5.0.1.</span> <span class="toc-text">18.5.1 Public Key Certificates, Certificate Authorities, and X.509</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-5-2-Validating-and-Revoking-Certificates"><span class="toc-number">18.5.1.</span> <span class="toc-text">18.5.2 Validating and Revoking Certificates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-5-3-Attribute-Certificates"><span class="toc-number">18.5.2.</span> <span class="toc-text">18.5.3 Attribute Certificates</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-6-TCP-x2F-IP-Security-Protocols-and-Layering"><span class="toc-number">18.6.</span> <span class="toc-text">18.6 TCP&#x2F;IP Security Protocols and Layering</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#18-7-Network-Access-Control-802-1X-802-1AE-EAP-and-PANA"><span class="toc-number">18.6.0.1.</span> <span class="toc-text">18.7 Network Access Control: 802.1X, 802.1AE, EAP, and PANA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-7-1-EAP-Methods-and-Key-Derivation"><span class="toc-number">18.6.1.</span> <span class="toc-text">18.7.1 EAP Methods and Key Derivation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-7-2-The-EAP-Re-authentication-Protocol-ERP"><span class="toc-number">18.6.2.</span> <span class="toc-text">18.7.2 The EAP Re-authentication Protocol (ERP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-7-3-Protocol-for-Carrying-Authentication-for-Network-Access-PANA"><span class="toc-number">18.6.3.</span> <span class="toc-text">18.7.3 Protocol for Carrying Authentication for Network Access (PANA)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-8-Layer-3-IP-Security-IPsec"><span class="toc-number">18.7.</span> <span class="toc-text">18.8 Layer 3 IP Security (IPsec)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-1-Internet-Key-Exchange-IKEv2-Protocol"><span class="toc-number">18.7.1.</span> <span class="toc-text">18.8.1 Internet Key Exchange (IKEv2) Protocol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-2-Authentication-Header-AH"><span class="toc-number">18.7.2.</span> <span class="toc-text">18.8.2 Authentication Header (AH)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-3-Encapsulating-Security-Payload-ESP"><span class="toc-number">18.7.3.</span> <span class="toc-text">18.8.3 Encapsulating Security Payload (ESP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-4-Multicast"><span class="toc-number">18.7.4.</span> <span class="toc-text">18.8.4 Multicast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-5-L2TP-x2F-IPsec"><span class="toc-number">18.7.5.</span> <span class="toc-text">18.8.5 L2TP&#x2F;IPsec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-6-IPsec-NAT-Traversal"><span class="toc-number">18.7.6.</span> <span class="toc-text">18.8.6 IPsec NAT Traversal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-8-7-Example"><span class="toc-number">18.7.7.</span> <span class="toc-text">18.8.7 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-9-Transport-Layer-Security-TLS-and-DTLS"><span class="toc-number">18.8.</span> <span class="toc-text">18.9 Transport Layer Security (TLS and DTLS)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#18-9-1-TLS-1-2"><span class="toc-number">18.8.0.1.</span> <span class="toc-text">18.9.1 TLS 1.2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-9-2-TLS-with-Datagrams-DTLS"><span class="toc-number">18.8.1.</span> <span class="toc-text">18.9.2 TLS with Datagrams (DTLS)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-10-DNS-Security-DNSSEC"><span class="toc-number">18.9.</span> <span class="toc-text">18.10 DNS Security (DNSSEC)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-10-1-DNSSEC-Resource-Records"><span class="toc-number">18.9.1.</span> <span class="toc-text">18.10.1 DNSSEC Resource Records</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-10-2-DNSSEC-Operation"><span class="toc-number">18.9.2.</span> <span class="toc-text">18.10.2 DNSSEC Operation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-10-3-Transaction-Authentication-TSIG-TKEY-and-SIG-0"><span class="toc-number">18.9.3.</span> <span class="toc-text">18.10.3 Transaction Authentication (TSIG, TKEY, and SIG(0))</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-10-4-DNSSEC-with-DNS64"><span class="toc-number">18.9.4.</span> <span class="toc-text">18.10.4 DNSSEC with DNS64</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-11-DomainKeys-Identified-Mail-DKIM"><span class="toc-number">18.10.</span> <span class="toc-text">18.11 DomainKeys Identified Mail (DKIM)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-11-1-DKIM-Signatures"><span class="toc-number">18.10.1.</span> <span class="toc-text">18.11.1 DKIM Signatures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-11-2-Example"><span class="toc-number">18.10.2.</span> <span class="toc-text">18.11.2 Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-12-Attacks-on-Security-Protocols"><span class="toc-number">18.11.</span> <span class="toc-text">18.12 Attacks on Security Protocols</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-13-Summary"><span class="toc-number">18.12.</span> <span class="toc-text">18.13 Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-14-References"><span class="toc-number">18.13.</span> <span class="toc-text">18.14 References</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">19.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#internet-www-difference"><span class="toc-number">20.</span> <span class="toc-text">internet www difference</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/31/ai/" title="ai"><img src="/img/cover/a7deff245s64fb79915fc4cb96184f99.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ai"/></a><div class="content"><a class="title" href="/2022/12/31/ai/" title="ai">ai</a><time datetime="2022-12-31T12:08:18.044Z" title="Updated 2022-12-31 20:08:18">2022-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="tcpip详解读书笔记"><img src="/img/cover/IMG_3302.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="tcpip详解读书笔记"/></a><div class="content"><a class="title" href="/2022/12/17/tcpip%E8%AF%A6%E8%A7%A3%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="tcpip详解读书笔记">tcpip详解读书笔记</a><time datetime="2022-12-30T03:02:34.287Z" title="Updated 2022-12-30 11:02:34">2022-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/24/effective-cpp%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="effective_cpp读书笔记"><img src="/img/cover/IMG_3357.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="effective_cpp读书笔记"/></a><div class="content"><a class="title" href="/2022/09/24/effective-cpp%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="effective_cpp读书笔记">effective_cpp读书笔记</a><time datetime="2022-12-21T08:23:48.511Z" title="Updated 2022-12-21 16:23:48">2022-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/08/insidecpp/" title="insidecpp"><img src="/img/cover/IMG_3032.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="insidecpp"/></a><div class="content"><a class="title" href="/2022/11/08/insidecpp/" title="insidecpp">insidecpp</a><time datetime="2022-12-21T08:13:03.570Z" title="Updated 2022-12-21 16:13:03">2022-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/12/http%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="http权威指南读书笔记"><img src="/img/cover/IMG_2617.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="http权威指南读书笔记"/></a><div class="content"><a class="title" href="/2022/12/12/http%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="http权威指南读书笔记">http权威指南读书笔记</a><time datetime="2022-12-21T08:13:03.565Z" title="Updated 2022-12-21 16:13:03">2022-12-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Sinos</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>